/*
 * Mapbar Maplet Engine (C)2005 Mapbar Inc
 * Date: 2014-02-20
 * Time: 14:06:57
 * Type: mapbarapi
 * Version: 31.2
 */
if(typeof strImgsvrUrl=="undefined")strImgsvrUrl="http://img.mapbar.com/maplite/";if(typeof strMapsvrUrl=="undefined")strMapsvrUrl="http://api.mapbar.com/api/";CTLIMG_RESOURCE=[{url:strImgsvrUrl+"images/mapbar31.2.1.png",w:210,h:235}];var transparencyLevel=60;var DirectionInfo='';var strLicenseKey="8890";var strRemoteIP="www.mapbar.com";if(typeof iToolTipStyle=="undefined"){var iToolTipStyle=1}var mapwidth=600;var mapheight=400;var MapBackgroundColor="#EBEAE8";var B6cjm=new Array();B6cjm["\u5168\u56FD"]="GGFVJRWUUEARAF";B6cjm["\u5317\u4EAC\u5E02"]="HEUIDVWVVHUEEU";B6cjm["\u5929\u6D25\u5E02"]="HHDVGAWVVJDBGD";B6cjm["\u5858\u6CBD"]="HICCRIXVWBRBGC";B6cjm["\u5927\u6E2F\u533A"]="HIAVWDXVVHCUFA";B6cjm["\u4E0A\u6D77\u5E02"]="IJUAFCXVIWCHCU";B6cjm["\u91CD\u5E86\u5E02"]="HFRASSXTWJRFBR";B6cjm["\u5E7F\u4E1C\u7701"]="IJRCEHVUABJGJR";B6cjm["\u5E7F\u5DDE\u5E02"]="IJRCEHVUABJGJR";B6cjm["\u6E05\u8FDC\u5E02"]="IIGFGJVUARHGUG";B6cjm["\u4F5B\u5C71\u5E02"]="IJJCRUXTWSGVBJ";B6cjm["\u6DF1\u5733\u5E02"]="ISUGRJVUAIIDFU";B6cjm["\u6E5B\u6C5F\u5E02"]="IIEBEDVTITUFUE";B6cjm["\u8087\u5E86\u5E02"]="IIIIHHWTVUETJI";B6cjm["\u4E2D\u5C71\u5E02"]="IRTCBCXTWFUSGT";B6cjm["\u4E1C\u839E\u5E02"]="IRIJBUVUASTDUI";B6cjm["\u97F6\u5173\u5E02"]="IHJVJIWUDDDSTJ";B6cjm["\u6C55\u5934\u5E02"]="IVIHBWXUFSBTWI";B6cjm["\u987A\u5FB7\u5E02"]="IRCGSHXTWRHISC";B6cjm["\u73E0\u6D77\u5E02"]="ISHEIFXTWDEUFH";B6cjm["\u63ED\u9633\u5E02"]="IUSVUWXUFHRSUS";B6cjm["\u4ECE\u5316\u5E02"]="IJIIIDVUBEBAJI";B6cjm["\u6F6E\u5DDE\u5E02"]="IUWTBHXUGBCDUW";B6cjm["\u60E0\u5DDE\u5E02"]="ISHTBAVUBTSBEH";B6cjm["\u6C5F\u95E8\u5E02"]="IREBCSXTWBEAWE";B6cjm["\u8302\u540D\u5E02"]="IIEEBSXTRDWRDE";B6cjm["\u6885\u5DDE\u5E02"]="ITDHSFVUGDGISD";B6cjm["\u6CB3\u6E90\u5E02"]="IRVJACXUDDIWRV";B6cjm["\u6C55\u5C3E\u5E02"]="IUGGGAXUCTDWCG";B6cjm["\u9633\u6C5F\u5E02"]="IJJVUVWTTDFTVJ";B6cjm["\u4E91\u6D6E\u5E02"]="IIBSIBWTUVVGBB";B6cjm["\u6C88\u9633\u5E02"]="HTSCARXWTBGETS";B6cjm["\u961C\u65B0\u5E02"]="HJRHTCXWJSHWVR";B6cjm["\u76D8\u9526\u5E02"]="HSFTUDXWJBBHUF";B6cjm["\u629A\u987A\u5E02"]="HUCSRCXWTSTTTC";B6cjm["\u8425\u53E3\u5E02"]="HTJFIWXWIIVJHJ";B6cjm["\u5927\u8FDE\u5E02"]="HVESCTXWEVHRRE";B6cjm["\u846B\u82A6\u5C9B\u5E02"]="HRFWSJXWGITHJF";B6cjm["\u978D\u5C71\u5E02"]="HUASWDXWRHBRUA";B6cjm["\u4E39\u4E1C\u5E02"]="IARWBGXWRWGTRR";B6cjm["\u5357\u4EAC\u5E02"]="IEHIJFWVGDBVSH";B6cjm["\u5F90\u5DDE\u5E02"]="HVRIUEWVHBRHCR";B6cjm["\u8FDE\u4E91\u6E2F\u5E02"]="IBCJDAWVRJVHEC";B6cjm["\u6DEE\u9634\u5E02"]="ICHUDGWVIURHGH";B6cjm["\u76D0\u57CE\u5E02"]="IEIBCFXVRDWJBI";B6cjm["\u626C\u5DDE\u5E02"]="IEWESGXVHRSJGW";B6cjm["\u6CF0\u5DDE\u5E02"]="IFIFEVWVIIUDVI";B6cjm["\u9547\u6C5F\u5E02"]="IFDWSVXVHGGAID";B6cjm["\u5357\u901A\u5E02"]="IHSDGJWVJEAFHS";B6cjm["\u5E38\u5DDE\u5E02"]="IGRSWHXVHIHHBR";B6cjm["\u65E0\u9521\u5E02"]="IHIEEWXVHSTJBI";B6cjm["\u82CF\u5DDE\u5E02"]="IIFVFGWVHTJBEF";B6cjm["\u6DEE\u5B89\u5E02"]="ICHVTTWVIVFJAH";B6cjm["\u5BBF\u8FC1\u5E02"]="IAUEAGWVIFASVU";B6cjm["\u6C5F\u9634\u5E02"]="IGWERFXVIDIHWW";B6cjm["\u5B9C\u5174\u5E02"]="Data Out Of Range";B6cjm["\u6B66\u6C49\u5E02"]="HWUGBAXUUAIWIU";B6cjm["\u8346\u95E8\u5E02"]="HSWWASXURJETSW";B6cjm["\u8346\u5DDE\u5E02"]="HUBWHHXUJIHSUB";B6cjm["\u5341\u5830\u5E02"]="HHFTBSXURTGGWF";B6cjm["\u968F\u5DDE\u5E02"]="HTSFJSXUUGCVWS";B6cjm["\u8944\u6A0A\u5E02"]="HRFEDWXUTBDJSF";B6cjm["\u5B9C\u660C\u5E02"]="HSCBIAVUISGJIC";B6cjm["\u5B5D\u611F\u5E02"]="HVSVTSWUUAHRHS";B6cjm["\u6210\u90FD\u5E02"]="HACUWTXTUJEGAC";B6cjm["\u6CF8\u5DDE\u5E02"]="HEWASJXTTWJSSW";B6cjm["\u8FBE\u5DDE\u5E02"]="HEICTRXUDJWFEI";B6cjm["\u5E7F\u5B89\u5E02"]="HEFTDCVUBDGJRF";B6cjm["\u5E7F\u5143\u5E02"]="HABUIBXUCWGSSB";B6cjm["\u4E50\u5C71\u5E02"]="HBFGTIXTSGWFCF";B6cjm["\u5185\u6C5F\u5E02"]="HDEJBBXTUGWRSE";B6cjm["\u6500\u679D\u82B1\u5E02"]="HCRHCWXTDSASTR";B6cjm["\u9042\u5B81\u5E02"]="HCJJUFXTWRIGCJ";B6cjm["\u5B9C\u5BBE\u5E02"]="HDTRTSXTSIWBVT";B6cjm["\u81EA\u8D21\u5E02"]="HDCDSUVTTRIJAC";B6cjm["\u897F\u5B89\u5E02"]="HBWSJFXURIEREW";B6cjm["\u54B8\u9633\u5E02"]="HBIIBFWUREFVCI";B6cjm["\u77F3\u5BB6\u5E84\u5E02"]="HESUBVWVITTHSS";B6cjm["\u5510\u5C71\u5E02"]="HHWAWWXWATUCTW";B6cjm["\u79E6\u7687\u5C9B\u5E02"]="HJJVGFXWDGIEGJ";B6cjm["\u627F\u5FB7\u5E02"]="HFHJHWXWCHACRH";B6cjm["\u5ECA\u574A\u5E02"]="HFTVWAXVVFSCHT";B6cjm["\u5F20\u5BB6\u53E3\u5E02"]="HBBTDBWVUISAGB";B6cjm["\u4FDD\u5B9A\u5E02"]="HEWGEJXVSICHVW";B6cjm["\u90A2\u53F0\u5E02"]="HGDDSHWVHDJBVD";B6cjm["\u90AF\u90F8\u5E02"]="HGVCGVWVGIBRDV";B6cjm["\u6CA7\u5DDE\u5E02"]="HHVAAFWVTTRDTV";B6cjm["\u592A\u539F\u5E02"]="HCAFICWVFITUBA";B6cjm["\u957F\u6CBB\u5E02"]="HFGISAWVDTTJHG";B6cjm["\u5927\u540C\u5E02"]="GWSVEUXVRAJVRS";B6cjm["\u664B\u57CE\u5E02"]="HGBDAUWVCFJIAB";B6cjm["\u664B\u4E2D\u5E02"]="HCIWDTXVFIGDHI";B6cjm["\u4E34\u6C7E\u5E02"]="HDCJHGWVBDIBBC";B6cjm["\u5415\u6881\u5730\u533A"]="HAGDSSXVCUGWAG";B6cjm["\u6714\u5DDE\u5E02"]="GWJHIEXVHJBJFJ";B6cjm["\u5FFB\u5DDE\u5E02"]="HBHFJSWVGJVDTH";B6cjm["\u9633\u6CC9\u5E02"]="HDIVBIXVHAUWWI";B6cjm["\u8FD0\u57CE\u5E02"]="HDWEIIXUVUARJW";B6cjm["\u90D1\u5DDE\u5E02"]="HIGSCCWVCHAHFG";B6cjm["\u6D1B\u9633\u5E02"]="HGRDWVXVAFWVUR";B6cjm["\u5E73\u9876\u5C71\u5E02"]="HJHARHWVAFTSRH";B6cjm["\u8BB8\u660C\u5E02"]="HJTUEIWVBJITUT";B6cjm["\u5357\u9633\u5E02"]="HJGEVGXUVAWHWG";B6cjm["\u9A7B\u9A6C\u5E97\u5E02"]="HSSISAWVAEVVBS";B6cjm["\u5468\u53E3\u5E02"]="HSRTHWXVCDTSRR";B6cjm["\u5546\u4E18\u5E02"]="HSWBAEXVEWSCSW";B6cjm["\u5F00\u5C01\u5E02"]="HJGVEGXVDIWGWG";B6cjm["\u65B0\u4E61\u5E02"]="HHWEWDXVDJSICW";B6cjm["\u4E09\u95E8\u5CE1\u5E02"]="HERHERWUVSTUFR";B6cjm["\u6FEE\u9633\u5E02"]="HJADAVWVGATIHA";B6cjm["\u4FE1\u9633\u5E02"]="HUBFDBXUWBFVVB";B6cjm["\u9E64\u58C1\u5E02"]="HHGUUJWVFADAEG";B6cjm["\u5B89\u9633\u5E02"]="HHHDVVXVFIVEWH";B6cjm["\u7126\u4F5C\u5E02"]="HHBCJJXVCIHWIB";B6cjm["\u6F2F\u6CB3\u5E02"]="HRUCUFWVBDVRAU";B6cjm["\u957F\u6625\u5E02"]="HTESJCVBACCRUUE";B6cjm["\u5409\u6797\u5E02"]="HVCVBJWBAEBVVRC";B6cjm["\u54C8\u5C14\u6EE8\u5E02"]="HSHWUDXBAHARIGH";B6cjm["\u9F50\u9F50\u54C8\u5C14\u5E02"]="HEWGJRXBAFGFFHW";B6cjm["\u5927\u5E86\u5E02"]="HHSSFDVBAFUUUGS";B6cjm["\u4E94\u5927\u8FDE\u6C60\u5E02"]="HGERCVWBARSCISE";B6cjm["\u7261\u4E39\u6C5F\u5E02"]="IBTVJCXBAJTWCBT";B6cjm["\u547C\u548C\u6D69\u7279\u5E02"]="GTCIEDWVIRJSIC";B6cjm["\u9521\u6797\u90ED\u52D2"]="GVBWHFXWECWVCB";B6cjm["\u6D4E\u5357\u5E02"]="HRRRBTWVRIHDUR";B6cjm["\u804A\u57CE\u5E02"]="HJFDFSWVIJVDIF";B6cjm["\u70DF\u53F0\u5E02"]="HWWUHDXWCHRJCW";B6cjm["\u5A01\u6D77\u5E02"]="IBCGUJXWDIRTIC";B6cjm["\u9752\u5C9B\u5E02"]="IARACCWVVUDCUR";B6cjm["\u6CF0\u5B89\u5E02"]="HSIVBAXVJWASDI";B6cjm["\u83B1\u829C\u5E02"]="HTFICSXVRTHWCF";B6cjm["\u6D4E\u5B81\u5E02"]="HSVHFHWVHVRAGV";B6cjm["\u83CF\u6CFD\u5E02"]="HRHRJJXVFWWUGH";B6cjm["\u4E34\u6C82\u5E02"]="HWCAADXVRBECVC";B6cjm["\u5FB7\u5DDE\u5E02"]="HIEVBTWVRSSVFE";B6cjm["\u6DC4\u535A\u5E02"]="HTAVDJWVTEHVCA";B6cjm["\u6F4D\u574A\u5E02"]="HUTJUUWVUSVICT";B6cjm["\u65E5\u7167\u5E02"]="IAFTHRWVTFJJSF";B6cjm["\u4E1C\u8425\u5E02"]="HSUERIWVVBGCUU";B6cjm["\u6EE8\u5DDE\u5E02"]="HSAWCDXVUBRBVA";B6cjm["\u67A3\u5E84\u5E02"]="HVDUUEWVIIUTHD";B6cjm["\u5408\u80A5\u5E02"]="ICGAACWVDIGSDG";B6cjm["\u829C\u6E56\u5E02"]="IEUISRWVEGSBFU";B6cjm["\u9EC4\u5C71\u5E02"]="IHDTICWVBUURUD";B6cjm["\u5B89\u5E86\u5E02"]="IEBDSUWVBDBHEB";B6cjm["\u868C\u57E0\u5E02"]="IAUUAAWVFFCHBU";B6cjm["\u4EB3\u5DDE\u5E02"]="HUAIWVXVEFIFUA";B6cjm["\u5DE2\u6E56\u5E02"]="IDRTRDWVEBHRVR";B6cjm["\u6C60\u5DDE\u5E02"]="IEIGTWXVCAUICI";B6cjm["\u6EC1\u5DDE\u5E02"]="IDEJCAWVFUDAJE";B6cjm["\u961C\u9633\u5E02"]="HVJGCUXVCWCGGJ";B6cjm["\u6DEE\u5317\u5E02"]="HVHEGJXVFWWCIH";B6cjm["\u516D\u5B89\u5E02"]="IBFVUSXVCDSWTF";B6cjm["\u9A6C\u978D\u5C71\u5E02"]="IEHRWSXVFDABTH";B6cjm["\u5BBF\u5DDE\u5E02"]="HWDSDFXVFUGHAD";B6cjm["\u94DC\u9675\u5E02"]="IEJTFVWVCVFJFJ";B6cjm["\u5BA3\u57CE\u5E02"]="IGAAECWVEHBGDA";B6cjm["\u6DEE\u5357\u5E02"]="IASFHWXVEDVTES";B6cjm["\u676D\u5DDE\u5E02"]="IJDAJAWVFJGCBD";B6cjm["\u7ECD\u5174\u5E02"]="IREBUTXVFTERWE";B6cjm["\u5B81\u6CE2\u5E02"]="ISWIFCXVHBBASW";B6cjm["\u6E56\u5DDE\u5E02"]="IIDGEDWVGFJRID";B6cjm["\u5609\u5174\u5E02"]="IJFTGAWVHDDBJF";B6cjm["\u91D1\u534E\u5E02"]="IRDGFTXVCWSAHD";B6cjm["\u4E3D\u6C34\u5E02"]="ISRHIDWVCGJFIR";B6cjm["\u6E29\u5DDE\u5E02"]="IUGWBGXVCUHFDG";B6cjm["\u4E50\u6E05\u5E02"]="IUSDHJWVDHSSVS";B6cjm["\u53F0\u5DDE\u5E02"]="IUJGDSWVFAFUEJ";B6cjm["\u8862\u5DDE\u5E02"]="IJEDARWVBJCGDE";B6cjm["\u798F\u5DDE\u5E02"]="IVGDHIXUUTREWG";B6cjm["\u8386\u7530\u5E02"]="IVUGHUWUTGHGGU";B6cjm["\u5357\u5E73\u5E02"]="ISRAGEWUTVCRBR";B6cjm["\u53A6\u95E8\u5E02"]="IVVSDUWUJJTJRV";B6cjm["\u6CC9\u5DDE\u5E02"]="IVWVHJXURWGTTW";B6cjm["\u6F33\u5DDE\u5E02"]="IVCTCHWUIVUGCC";B6cjm["\u4E09\u660E\u5E02"]="ISHCWSXUSIFFTH";B6cjm["\u9F99\u5CA9\u5E02"]="ITFFFUWUIUVGCF";B6cjm["\u957F\u6C99\u5E02"]="IBGRTCVUHGRSFG";B6cjm["\u5F20\u5BB6\u754C\u5E02"]="HTDSDJVUFATFGT";B6cjm["\u5CB3\u9633\u5E02"]="HWURCEXUJHAEHU";B6cjm["\u682A\u6D32\u5E02"]="ICDADVXUHCBWHD";B6cjm["\u90F4\u5DDE\u5E02"]="IFCBUEVUDUGGUC";B6cjm["\u5E38\u5FB7\u5E02"]="HVDAVWXUGSCRID";B6cjm["\u8861\u9633\u5E02"]="ICUVVBXUEUWGEU";B6cjm["\u90B5\u9633\u5E02"]="IAJDWAXUDRJDWJ";B6cjm["\u6E58\u6F6D\u5E02"]="IBUTBWXUGTIBIU";B6cjm["\u76CA\u9633\u5E02"]="HWVBGTXUHAUABV";B6cjm["\u6E58\u897F"]="HTESRDVUCRFHCE";B6cjm["\u5357\u5B81\u5E02"]="ICIFVTWTIBCAUI";B6cjm["\u6842\u6797\u5E02"]="IBTCGEWTVUSVHT";B6cjm["\u767e\u8272\u5e02"]="HVEHATXTHCIWJE";B6cjm["\u5357\u660C\u5E02"]="IFCEUTVUTJJDUC";B6cjm["\u8D35\u9633\u5E02"]="HRFBHUVTSGBFIF";B6cjm["\u6606\u660E\u5E02"]="HGIVRBXTCWBDGI";B6cjm["\u7389\u6EAA\u5E02"]="HHFUSFXTBJWHGF";B6cjm["\u695A\u96C4\u5E02"]="HEGDTDUTBSTCCG";B6cjm["\u5FB7\u5B8F"]="HAECBGXSSEAWDE";B6cjm["\u8FEA\u5E86"]="GTWSURXTCJAJSW";B6cjm["\u4E2A\u65E7\u5E02"]="HJECWRXTBDUCFE";B6cjm["\u4E34\u6CA7\u5E02"]="HDFFEHUSTSDDIF";B6cjm["\u6012\u6C5F\u5E02"]="GUTHDTWTAATVUT";B6cjm["\u66F2\u9756\u5E02"]="HHGUGEVTFUBJHG";B6cjm["\u601D\u8305\u5E02"]="HGAEUCVSUHFHUA";B6cjm["\u62C9\u8428\u5E02"]="FUUVCJWSIEVARU";B6cjm["\u6D77\u53E3\u5E02"]="IJTRTWXTGUUSRT";B6cjm["\u4E09\u4E9A\u5E02"]="ISECARWTCVVADE";B6cjm["\u743C\u6D77\u5E02"]="ISDJDGWTFVIASD";B6cjm["\u5170\u5DDE\u5E02"]="GHFHGUWUFFUUVF";B6cjm["\u94F6\u5DDD\u5E02"]="GHIEETXUTURWFI";B6cjm["\u897F\u5B81\u5E02"]="GDIATWXUDCTBAI";B6cjm["\u4E4C\u9C81\u6728\u9F50\u5E02"]="ECTRRTUTIIAJHT";B6cjm["\u9999\u6E2F"]="ITDUDHWUADIVID";B6cjm["\u6FB3\u95E8"]="ISGWHUXTWBWWTG";B6cjm["\u53F0\u6E7E"]="JESFTTXUTRWJWS";B6cjm["\u9E64\u5C97\u5E02"]="HVREATXBAVVGWHR";B6cjm["\u5305\u5934\u5E02"]="GJJSCSZVFRAIAJ";B6cjm["\u8861\u6C34\u5E02"]="HGWVHSZVRBHDVW";B6cjm["\u6986\u6797\u5E02"]="GUBBADZVBUWWAB";B6cjm["\u901A\u8FBD\u5E02"]="HIAJGGXWUBWRCA";B6cjm["\u8D64\u5CF0\u5E02"]="HFAGBIXWGAFHIA";B6cjm["\u547C\u4F26\u8D1D\u5C14"]="GSRDHWXBABUCHHR";B6cjm["\u5174\u5B89\u76DF"]="HDWGITXBAAIVARW";B6cjm["\u5B81\u5FB7\u5E02"]="IUSTGRXUWBCGAS";B6cjm["\u67f3\u5dde\u5e02"]="IBWGCUXTTBBTSW";function getPid(a){if(typeof B6cjm[a]=="undefined")return a;return B6cjm[a]};var topColor="#FFFFFF";var subColor="#FFFFFF";var xoffset=0;var yoffset=0;
var _0n='?20123441340';var sN=function(){this.clear=function(){};this.paint=function(){};this.lB=function(){};this.lE=function(){};this.setColor=function(){}};var jsGraphics=function(name){};var gq=function(name,left,top,width,height,visible,zindex,content){var h=document.createElement("div");h.unselectable="on";h.id=name;h.style.position="absolute";h.style.top=parseInt(top)+"px";h.style.left=parseInt(left)+"px";h.style.zIndex=zindex;h.style.width=width+(width=="auto"?"":"px");h.style.height=height+(height=="auto"?"":"px");h.style.visibility=(visible)?'visible':'hidden';h.innerHTML=content;return h};var PerformControl=function(e,uy,qu){var maplet=uy.parentNode.q9;switch(qu){case 1:maplet.panTo(parseInt(maplet.width)/2,0);break;case 2:maplet.panTo(0,parseInt(maplet.height)/2);break;case 3:maplet.panTo(-parseInt(maplet.width)/2,0);break;case 4:maplet.panTo(0,-parseInt(maplet.height)/2);break;case 5:maplet.zoomIn();break;case 6:maplet.zoomOut();break;case 7:maplet.setMode(ts.tb);break;case 8:var yoffset=parseInt(uy.style.top)-96+parseInt(maplet.controlCanvas.top);var y=parseInt((px)?event.clientY:e.clientY)-parseInt(maplet.offsetY)-parseInt(maplet.top);y-=yoffset;if(!px&&maplet.panel.style.position!="absolute"){}AB=MAX_ZOOM_LEVEL-Math.max(0,Math.min(MAX_ZOOM_LEVEL,parseInt((parseInt(y)-100)/gb.w3824)));uy.parentNode.update(AB);maplet.r3KEY();maplet.setZoomLevel(AB,true,false);break;default:break}};var y4=null;var showMouseTipBox=function(x,y,x8,container){try{if(y4==null||y4=="undefined"){if(maplet.sS!=ts.tw){y4=gq("mousetipbox",parseInt(x)+10,parseInt(y)+18,"auto","auto",1,100,x8);y4.className="ptlabel";y4.style.backgroundColor="#FFFFFF";y4.style.padding="2px";y4.style.border="1px solid #0E347F";y4.style.color="#D50F1E"}else{y4=gq("mousetipbox",parseInt(x)+10,parseInt(y)+18,"auto","auto",1,100,x8)}y4.unselectable="on";y4.style.MozUserSelect="none"}else{y4.style.left=(parseInt(x)+10)+"px";y4.style.top=(parseInt(y)+18)+"px";y4.visibility="visible"}if(y4!=null&&(y4.parentNode==null||y4.parentNode!=container)){container.appendChild(y4)}}catch(e){}};var nX=function(){if(y4!=null){if(y4.parentNode!=null){_removeNode(y4)}y4=null}};var imageTileError=function(yF){if(yF.width==300&&yF.ntry=="0"){yF.ntry="1";yF.src=yF.src+"?"}else if(yF.width==300&&yF.ntry=="1"){yF.ntry="2";yF.src=yF.src+"?"}else{yF.ntry="3";yF.onerror=null;yF.src=strImgsvrUrl+"images/mask.gif";yF.style.width="300px";yF.style.height="300px"}};var imageTileOk=function(yF){yF.onerror=null;yF.onload=null;yF.style.width="300px";yF.style.height="300px"};var fJ=function(uy,yH){var cU=false;while(uy!=null){if((typeof yH=="string"&&uy.id==yH)||(uy==yH)){cU=true;break}uy=uy.parentNode}return cU};var y5=null;var waitHideTip=function(){if(y5)clearTimeout(y5);y5=null;y5=setTimeout("hideToolTipMenu()",2000)};var lbp=function(id,x,y,w,wO,y6,yU,HwQ8){Qn170[id]={x:x,y:y,w:w,wO:wO,y6:y6,yU:yU,HwQ8:HwQ8};E8o80(id,x,y,w,wO,y6,yU,HwQ8)};var E8o80=function(id,x,y,w,wO,y6,yU,HwQ8){if(typeof id=="string"&&id!=null&&document.getElementById(id)!=null&&typeof wO=="string"&&wO!=null){if(!HwQ8){document.getElementById(id).innerHTML+="<div unselectable=\"on\" class=\"hotspotlabel\" onmouseout=\"javascript:waitHideTip();\" onmouseover=\"javascript:{var e = arguments[0];setToolTipMenu(e,e,'"+y6+"','"+(yU)+"',e)};\" style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:0px\">"+wO+"</div>"}else{document.getElementById(id).innerHTML+="<div unselectable=\"on\"  style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:0px\">"+wO+"</div>"}}};var Qn170={};function CreateToolTip(qR,ya,xu){var ContentInfo='<table id="mytooltip_container" border="0" width="150" cellspacing="0" cellpadding="0"><tr><td width="100%" bgcolor="#FF0000"><table border="0" width="150" cellspacing="1" cellpadding="0">'+'<tr><td width="100%" bgcolor="#FF0000">'+'<table border="0" width="100%" cellspacing="0" cellpadding="0">'+'<tr><td width="100%" bgcolor='+topColor+'>'+'<table border="0" width="100%" cellspacing="0" cellpadding="0" align="center">'+'<tr><td id="mytooltiptitle"width="100%" class="tooltiptitle">'+ya+'</td>'+'<td style="cursor:pointer;" valign="top" align="right">'+'<img src="'+strImgsvrUrl+'images/xclose.gif" onclick="javascript:hideToolTipMenu();">'+'</td>'+'</tr>'+'</table>'+'</td></tr>'+'<tr><td width="100%" bgcolor='+subColor+'>'+'<table border="0" width="100%" cellpadding="0" cellspacing="0" align="center">'+'<tr><td id="mytooltipcontent" width="100%" class="tooltipcontent">'+xu+'</td></tr>'+'</table>'+'</td></tr>'+'</table>'+'</td></tr>'+'</table></td></tr></table>';document.getElementById(qR).innerHTML=ContentInfo;var yw=document.getElementById(qR).childNodes[0];document.getElementById(qR).style.width=yw.clientWidth;document.getElementById(qR).style.height=yw.clientHeight};var setToolTipMenu=function(x,y,ya,xu,e){var maplet=document["mapbar-maplet"];if(maplet!=null&&maplet.width&&maplet.height){mapwidth=maplet.width;mapheight=maplet.height;if(typeof x=="undefined"||typeof e=="object"){x=((px)?event.clientX:e.clientX)-maplet.offsetX-maplet.left;y=((px)?event.clientY:e.clientY)-maplet.offsetY-maplet.top}}UpdateContent("ToolTip",ya,xu);var y8=document.getElementById("ToolTip").clientWidth;var y1=document.getElementById("ToolTip").clientHeight;if(x>mapwidth-y8){x=x-y8};if(y>mapheight-y1){y=y-y1};MoveToolTip("ToolTip",y+yoffset,x+xoffset);document.getElementById("ToolTip").style.visibility='visible'};var hideToolTipMenu=function(){document.getElementById("ToolTip").style.visibility="hidden";var maplet=document["mapbar-maplet"];if(maplet.getContextMenu()!=null){maplet.getContextMenu().hide()}MoveToolTip("ToolTip",0,0)};var MoveToolTip=function(qR,nr,nq){if(px){document.getElementById(qR).style.top=parseInt(eval(nr))+"px"}else{document.getElementById(qR).style.top=parseInt(eval(nr))+"px"}document.getElementById(qR).style.left=parseInt(eval(nq))+"px"};var UpdateContent=function(qR,ya,xu){if(initialize==0){CreateToolTip(qR,ya,xu);initialize=1}if(document.getElementById("mytooltiptitle"))document.getElementById("mytooltiptitle").innerHTML=ya;if(document.getElementById("mytooltipcontent"))document.getElementById("mytooltipcontent").innerHTML=xu;var J5029=document.getElementById("ToolTip");var o3c55=document.getElementById("mytooltip_container");if(o3c55){J5029.style.width=o3c55.clientWidth+"px";J5029.style.height=o3c55.clientHeight+"px"}};var ts={tz:1,tA:2,ty:3,tv:5,tw:6,tx:7,tt:8,lz:9,ly:10,tb:11,np:12,l3:13,tM:14,tu:23,ta:15,D57MH:24,sy9:25};function I41(uy){if(typeof uy=="undefined"||!uy)return false;return uy instanceof Array};function Hn0$e(lT){var r9J4=0,e3s=0;if(typeof lT=="string"&&lT)lT=document.getElementById(lT);if(typeof lT=="object"&&lT){do{r9J4+=lT.offsetTop||0;e3s+=lT.offsetLeft||0;if(lT.offsetParent==document.body)if(lT.style.position=='absolute')break;lT=lT.offsetParent}while(lT)}return [e3s,r9J4]};function Kjdp(D02,S8e1F){var r=null;if(typeof D02=="string"&&D02)D02=aa(D02);if(typeof D02=="object"&&D02){do{if(typeof D02.getAttribute!=='undefined'){r=D02.getAttribute(S8e1F)}if(r||D02.parentNode==maplet.map)break;D02=D02.parentNode}while(D02)}return r};var pps=function(dom,S8e1F,value,D3$L){var u$079=function(d,a,v){if(typeof d.setAttribute!="undefined")d.setAttribute(a,v)};var BB22=function(d,a,v,nc){if(typeof d=="object"&&d&&typeof d.childNodes!="undefined"){var adIk3=d.childNodes;for(var i=0;i<adIk3.length;i++){var c=adIk3[i];if(c.childNodes.length>0){BB22(c,a,v,nc)}else if(typeof c.tagName=="string"&&!nc[c.tagName.toLowerCase()]){u$079(c,a,v)}}u$079(d,a,v)}};if(I41(D3$L)){for(var i=0;i<D3$L.length;i++)D3$L[D3$L[i].toLowerCase()]=1}else{D3$L=[]}BB22(dom,S8e1F,value,D3$L)};var o110=function(dom,S8e1F){var u$079=function(d,a){if(typeof d.removeAttribute!="undefined")d.removeAttribute(a)};var BB22=function(d,a){if(typeof d=="object"&&d&&typeof d.childNodes!="undefined"){var adIk3=d.childNodes;for(var i=0;i<adIk3.length;i++){var c=adIk3[i];if(c.childNodes.length>0){BB22(c,a)}else if(typeof c.tagName=="string"){u$079(c,a)}}u$079(d,a)}};BB22(dom,S8e1F)};function _getStyle(D02,X6K,_81_){var x=null;if(typeof D02=="string"&&D02)x=document.getElementById(D02);else x=D02;if(typeof x!="object"||!x)return "";if(!X6K&&!_81_)return "";if(X6K&&!_81_)_81_=X6K;if(!X6K&&_81_)X6K=_81_;var y="";if(x.currentStyle){y=x.currentStyle[X6K]}else if(document.defaultView&&document.defaultView.getComputedStyle){var _Vbk=document.defaultView.getComputedStyle(x,null);if(Hg6||RoY5){y=_Vbk?_Vbk.getPropertyValue(X6K):""}else{y=_Vbk?_Vbk.getPropertyValue(_81_):""}}return y};function U5402(s,d){if(isNaN(parseInt(s)))return(typeof d!="number"?0:d);else return parseInt(s)};function _isInsidePolygon(pt,pGQ){for(var c=false,i=-1,l=pGQ.length,qC=l-1; ++i<l;qC=i){if(((pGQ[i].y<=pt.y&&pt.y<pGQ[qC].y)||(pGQ[qC].y<=pt.y&&pt.y<pGQ[i].y))&&(pt.x<(pGQ[qC].x-pGQ[i].x)*(pt.y-pGQ[i].y)/(pGQ[qC].y-pGQ[i].y)+pGQ[i].x))c=!c}return c};function _isInsideRect(pt,rect){if(rect.max.x>pt.x&&rect.min.x<=pt.x&&rect.max.y>pt.y&&rect.min.y<=pt.y)return true;return false};function _isRectint(E3Wm7,t273G){return Math.abs((E3Wm7.min.x+E3Wm7.max.x)/2-(t273G.min.x+t273G.max.x)/2)<((E3Wm7.max.x+t273G.max.x-E3Wm7.min.x-t273G.min.x)/2)&&Math.abs((E3Wm7.min.y+E3Wm7.max.y)/2-(t273G.min.y+t273G.max.y)/2)<((E3Wm7.max.y+t273G.max.y-E3Wm7.min.y-t273G.min.y)/2)};function _IsIntersect(WCd,a8l12){var d=(WCd.end.y-WCd.start.y)*(a8l12.end.x-a8l12.start.x)-(a8l12.end.y-a8l12.start.y)*(WCd.end.x-WCd.start.x);if(d==0){return false}else{var x0=((WCd.end.x-WCd.start.x)*(a8l12.end.x-a8l12.start.x)*(a8l12.start.y-WCd.start.y)+(WCd.end.y-WCd.start.y)*(a8l12.end.x-a8l12.start.x)*WCd.start.x-(a8l12.end.y-a8l12.start.y)*(WCd.end.x-WCd.start.x)*a8l12.start.x)/d;var As=((WCd.end.y-WCd.start.y)*(a8l12.end.y-a8l12.start.y)*(a8l12.start.x-WCd.start.x)+(WCd.end.x-WCd.start.x)*(a8l12.end.y-a8l12.start.y)*WCd.start.y-(a8l12.end.x-a8l12.start.x)*(WCd.end.y-WCd.start.y)*a8l12.start.y)/(-d);if((x0-WCd.start.x)*(x0-WCd.end.x)<=0&&(x0-a8l12.start.x)*(x0-a8l12.end.x)<=0&&(As-WCd.start.y)*(As-WCd.end.y)<=0&&(As-a8l12.start.y)*(As-a8l12.end.y)<=0){return true}}return false};var C160=function(oQ13){if(window.event){return window.event}else{while(oQ13.caller)oQ13=oQ13.caller;if(typeof oQ13.arguments!="undefined"&&oQ13.arguments&&oQ13.arguments.length>0){if(oQ13.arguments[0].constructor.toString().indexOf("Event"))return oQ13.arguments[0]}}return null};var QD199=function(e,preventDefault){if(typeof e=="undefined")return;if(window.event){window.event.returnValue=false;window.event.cancelBubble=true}else{if(typeof preventDefault!="boolean")preventDefault=true;if(preventDefault)e.preventDefault();e.stopPropagation()}};function aa(lT){if(typeof lT=='string'){return document.getElementById(lT)}else{return null}};_removeNode=document.all?function(){var d;return function(n){if(n&&n.tagName!='BODY'){d=d||document.createElement('div');d.appendChild(n);d.innerHTML=''}}}():function(n){if(n&&n.parentNode&&n.tagName!='BODY'){n.parentNode.removeChild(n)}};qGb=function(s){var r=new RegExp("<.*?>|\r|\n","gi");return function(s){return s.replace(r,"")}}();var SwF6=function(URL,E_Hr9,o31,v76W4,F44,r12,aB){this.URL=URL;this.E_Hr9=E_Hr9;this.qyt=F44;this._b3M=r12;this.aB=aB;this.o31=o31;this.v76W4=v76W4};SwF6.prototype.e0b=function(){var W111X=document.getElementById("scriptTemp");if(W111X){_removeNode(W111X)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.id=(this.v76W4&&this.v76W4==true)?"Temp"+Math.random():"scriptTemp";s.src=(this.o31&&this.o31==true)?this.URL+"?"+Math.random():this.URL;var ni8J4=this.E_Hr9?(this.E_Hr9):parseInt;var id=s.id,EA4=this;var W61=this.qyt;var fX_1=this._b3M;var aB=typeof this.aB=="undefined"||!this.aB?[]:this.aB;s.onload=s.onreadystatechange=function(){if(typeof ActiveXObject!="undefined"){if(s.readyState=="loaded"||s.readyState=="complete"){if(typeof ni8J4=="function"){aB.push(s.id);ni8J4.apply(W61,aB)}EA4.p82Q3(id);s.onerror=null;s.onload=null;s.onreadystatechange=null}}else{if(typeof ni8J4=="function"){aB.push(s.id);ni8J4.apply(W61,aB)}EA4.p82Q3(id);s.onerror=null;s.onload=null;s.onreadystatechange=null}};s.onerror=function(){if(s&&s.parentNode)s.parentNode.removeChild(s);if(typeof fX_1=="function"){aB.push(s.id);fX_1.apply(W61,aB)}EA4.p82Q3(id);s.onerror=null;s.onload=null;s.onreadystatechange=null};document.body.insertBefore(s,document.body.firstChild)};SwF6.prototype.p82Q3=function(id){var gw7I$=document.getElementById(id);gw7I$&&document.body.removeChild(gw7I$)};var yOu8=function(){if(x00Vr)return document.documentElement.scrollTop;else return document.body.scrollTop};var J0j=function(){if(x00Vr)return document.documentElement.scrollLeft;else return document.body.scrollLeft};var sC=function(x,y,xu){document.getElementById("myalert").style.top=(parseInt(y)-60+yOu8())+"px";document.getElementById("myalert").style.left=(parseInt(x)-100+J0j())+"px";var xs=(en==1)?"Close":tX("%u5175%uE760");document.getElementById("myalert").innerHTML='<table width="196px" border="0" cellpadding="0" cellspacing="0" style="border:2px solid #0E347F;"><tr><td height="100px" align="center" valign="middle" bgcolor="#FFFFFF"><table width="167px" height="79px" border="0" cellpadding="0" cellspacing="0"><tr><td height="55px" align="center" valign="middle" style="font-size: 12px;color: #0065AD;">'+xu+'</td></tr><tr><td height="24px" align="center" valign="middle"><input type="button" value="'+xs+'" onClick="document.getElementById(\'myalert\').style.display = \'none\'"onMouseOver="style.background=\'#DEE7EF\';style.cursor=\'hand\';style.cursor=\'pointer\'"onMouseOut="this.style.background=\'FDFAF3\'" style="font-size: 9pt; border: 1px solid #4A799C;background-color: #FDFAF3"></td></tr></table></td></tr></table>';document.getElementById("myalert").style.display=""};var gP=function(xu){if(gQ)sC(300,100,xu)};var Q3T3x=new RegExp("<(?:!(?:--[\\s\\S]*?--\\s*)?(>)\\s*|(?:script|style|SCRIPT|STYLE)[\\s\\S]*?<\\/(?:script|style|SCRIPT|STYLE)>)","gi");var D9lc2=new RegExp("[\\r\\n]","gi");var aP3=function(html,J56Tg){if(typeof J56Tg!="boolean")J56Tg=false;if(typeof html=="string"&&html){var s=html.replace(Q3T3x,"");if(J56Tg)s=s.replace(D9lc2,"");return s}else{return html}};var yl0=null;var Un4V7=function(s){var size={eJYUI:0,tO0M:0,Ek84:0,ch:0};if(typeof s=="string"&&s&&maplet&&maplet.panel){if(!yl0){yl0=document.createElement("DIV");with(yl0.style){position="absolute";left=-Number.MAX_VALUE+"px";top=-Number.MAX_VALUE+"px"}maplet.sF.div.appendChild(yl0)}yl0.innerHTML=s;size.eJYUI=yl0.offsetWidth;size.tO0M=yl0.offsetHeight;size.Ek84=yl0.clientWidth;size.ch=yl0.clientHeight;yl0.innerHTML=""}return size};var Vb12a=function(TErp,rect){function M08(x,y,v9P$,aC3,h800c,JT3e0){var c=0;if(y>JT3e0)c|=WLdX;else if(y<aC3)c|=j_0;if(x>h800c)c|=tGLu;else if(x<v9P$)c|=s391;return c};var x1=TErp.c18.x,H2h=TErp.c18.y,x2=TErp.Fj0.x,_tsH=TErp.Fj0.y;var v9P$=rect.min.x,aC3=rect.min.y,h800c=rect.max.x,JT3e0=rect.max.y;var e7Dp,u80,bX0,Ar8=0;var accept=false,ln=false;e7Dp=M08(x1,H2h,v9P$,aC3,h800c,JT3e0);u80=M08(x2,_tsH,v9P$,aC3,h800c,JT3e0);do{if((e7Dp|u80)==0){accept=true;ln=true}else if((e7Dp&u80)>0){ln=true}else{var x=0,y=0;bX0=e7Dp!=0?e7Dp:u80;if((bX0&WLdX)>0){x=x1+(x2-x1)*(JT3e0-H2h)/(_tsH-H2h);y=JT3e0}else if((bX0&j_0)>0){x=x1+(x2-x1)*(aC3-H2h)/(_tsH-H2h);y=aC3}else if((bX0&tGLu)>0){y=H2h+(_tsH-H2h)*(h800c-x1)/(x2-x1);x=h800c}else if((bX0&s391)>0){y=H2h+(_tsH-H2h)*(v9P$-x1)/(x2-x1);x=v9P$}if(bX0==e7Dp){x1=x;H2h=y;e7Dp=M08(x1,H2h,v9P$,aC3,h800c,JT3e0)}else{x2=x;_tsH=y;u80=M08(x2,_tsH,v9P$,aC3,h800c,JT3e0)}}Ar8++}while(ln!=true&&Ar8<5000);if(accept){TErp.c18.x=Math.floor(x1);TErp.c18.y=Math.floor(H2h);TErp.Fj0.x=Math.floor(x2);TErp.Fj0.y=Math.floor(_tsH)}return accept};var tGLu=2;var WLdX=8;var j_0=4;var s391=1;var P3IU=6;function x149(TErp){var i=0;var JE08=[];var J10=TErp.length;if(J10<=0)return JE08;while(i<J10){var b=0;var shift=0;var N7k=0;var _40f=P3IU;do{b=(TErp.charCodeAt(i++))-63;var $881o=(((b>>1)^(_40f++))&0x1f);N7k|=$881o<<shift;shift+=5}while((b&0x1)==0);N7k=((N7k&0x01)==0x01)?~(N7k>>1):(N7k>>1);JE08.push(N7k)}return JE08};function G6aY7(x1,H2h,x2,_tsH){var tan=Math.atan((_tsH-H2h)/(x2-x1));var cc05=180/Math.PI*tan;if(x1<=x2&&H2h>=_tsH)cc05=cc05+90;else if(x1<=x2&&H2h<_tsH)cc05=cc05+90;else if(x1>x2&&H2h<=_tsH)cc05=90+cc05+180;else if(x1>x2&&H2h>_tsH)cc05=cc05+270;return cc05};function _removeArrayItem(O8$,jr7,tGP){if(!I41(O8$))return;var dwuX,p3ot=O8$.length;jr7=jr7<0?jr7-0+p3ot:jr7;tGP=tGP<0?tGP-0+p3ot:tGP;if(tGP<jr7||jr7>=p3ot||tGP>=p3ot)return;dwuX=O8$.slice((tGP||jr7)+1||O8$.length);O8$.length=jr7<0?O8$.length+jr7:jr7;return O8$.push.apply(O8$,dwuX)};function M7e5S(uy){if(typeof uy=="object"){for(var i in uy){uy[i]=null;delete uy[i]}}uy=null};var pD6=function(n682){if(typeof n682==='number'){return Math.round(n682)}return n682};var cq={pu:{},vp:function(li){return this.pu[li]||function(pu,xT){var v6;if(xT.indexOf(",")==-1){var pk=-1;var fE=0;var ub='';var fH='';if(xT!=null&&parseInt(xT.charAt(0),36)>=33){fH=xT.charAt(0);xT=xT.substring(1)}for(var i=0;i<(xT.length-(c75?1:0));i++){var n8=parseInt(xT.charAt(i),36)-10;if(n8>=17)n8=n8-7;ub+=(n8).toString(36);if(n8>fE){pk=i;fE=n8}}var n9=parseInt(ub.substring(0,pk),16);var n0=parseInt(ub.substring(pk+1),16);if("X"==fH){n9=-n9}if("Y"==fH){n0=-n0}v6=new Array();v6[0]=(n9+n0-parseInt(strLicenseKey))/2;v6[1]=(n0-v6[0])/100000.0;v6[0]/=100000.0;if(v6[0]>180)v6[0]-=360;pu[xT]=v6;return v6}else{v6=v6jH(xT);pu[xT]=v6;return v6}}(this.pu,li)},zn:function(li,lf,wtr8_){if(typeof wtr8_!="boolean")wtr8_=false;if(typeof li!="undefined"&&typeof lf!="undefined"){this.lf=parseFloat(lf);this.li=parseFloat(li)}if(apiType==1&&!wtr8_){return D307H(this.li+","+this.lf).join(",")}else{var v6='';var uh=parseInt(parseFloat(Math.max(-90,Math.min(90,this.lf)))*100000);var uj=parseInt(parseFloat((this.li<0)?(this.li+360):this.li)*100000);var pl=uj-uh+parseInt(strLicenseKey);var pm=uj+uh;if(pl<0){v6='X';pl=-pl}if(pm<0){v6='Y';pm=-pm}var ph=(pl).toString(16);var pi=(pm).toString(16);for(var i=0;i<ph.length;i++){var qv=parseInt(ph.charAt(i),16);v6+=(((qv>=10)?(qv+7):qv)+10).toString(36)}v6+='z';for(var qC=0;qC<pi.length;qC++){var s3e=parseInt(pi.charAt(qC),16);v6+=(((s3e>=10)?(s3e+7):s3e)+10).toString(36)}if(c75){v6+=v6.charAt(c75)}return v6.toUpperCase()}}};var xE=function(xj){var c='';for(var i=0;i<xj.length;i++){var zh=xj.charCodeAt(i).toString(36).toUpperCase();if(zh.length<=1){zh="0"+zh}c+=zh}return c};var sdc=function(xj){var c='';for(var i=0;i<xj.length;i+=2){var zh=xj.substring(i,i+2);c+=String.fromCharCode(parseInt(zh,36))}return c};var tX=function(xj){xj=unescape(xj);var c=String.fromCharCode(xj.charCodeAt(0)-xj.length);for(var i=1;i<xj.length;i++){c+=String.fromCharCode(xj.charCodeAt(i)-c.charCodeAt(i-1))}return c};function D307H(S6A){var n2q=S6A.split(",");var x=parseFloat(n2q[0])*100000%36000000;var y=parseFloat(n2q[1])*100000%36000000;var R18y=parseInt(e142(x,y)+x);var S_M8$=parseInt(Fg63L(x,y)+y);return [R18y/100000.0,S_M8$/100000.0]};function v6jH(S6A){var n2q=S6A.split(",");var x=parseFloat(n2q[0])*100000%36000000;var y=parseFloat(n2q[1])*100000%36000000;var Kh024=parseInt(-kn8(x,y)+x);var B61T=parseInt(-YBM4U(x,y)+y);Kh024=parseInt(-kn8(Kh024,B61T)+x+((x>0)?1:-1));B61T=parseInt(-YBM4U(Kh024,B61T)+y+((y>0)?1:-1));return [Kh024/100000.0,B61T/100000.0]};function e142(x,y){return c2a(x,y)};function Fg63L(x,y){return HyO7(x,y)};function kn8(x,y){return c2a(x,y)};function YBM4U(x,y){return HyO7(x,y)};function c2a(x,y){return pcf3r(RF4(ErtSH(y,x),XqtJ9(x,y)),RF4(Heg(x,y),t062E(y,x)))};function HyO7(x,y){return pcf3r(RF4(Heg(y,x),XqtJ9(x,y)),RF4(ErtSH(x,y),t062E(y,x)))};function RF4(x,y){return x*y};function pcf3r(x,y){return x+y};function ErtSH(x,y){return Math.cos(x/100000)};function Heg(x,y){return Math.sin(x/100000)};function t062E(x,y){return x/9000};function XqtJ9(x,y){return x/18000};var fD=function(name,left,top,width,height,visible,zindex,content,container){this.n7=content;this.container=container;this.name=name;this.qe=1;this.hide=function(){this.style.visibility="hidden"};this.show=function(){this.style.visibility="visible"};this.setVisible=function(visible){if(this.style.display!=(visible?"":"none"))this.style.display=visible?"":"none"};this.moveTo=function(x,y){eval(document.body.scrollTop);this.style.left=parseInt(x)+"px";this.style.top=parseInt(y)+"px"};this.resize=function(w,h){if(parseInt(w)>=0&&parseInt(h)>=0){this.style.width=parseInt(w)+"px";this.style.height=parseInt(h)+"px"}};this.nz=function(){return parseInt(this.style.height)};this.nH=function(){return parseInt(this.style.width)};this.qn=function(x,y){return(x>parseInt(this.style.left)&&x<(parseInt(this.style.left)+parseInt(this.style.width))&&y>parseInt(this.style.top)&&y<(parseInt(this.style.top)+parseInt(this.style.height)))};this.appendChild=function(fK){try{this.div.appendChild(fK)}catch(e){}};this.removeChild=function(fK){try{_removeNode(fK)}catch(e){}};this.clear=function(){this.div.innerHTML=""};this.clean=this.clear;this.getName=function(){return this.name};try{this.div=gq(this.name,left,top,width,height,visible,zindex,content);this.div.unselectable="on";if(this.container)this.container.appendChild(this.div);this.style=this.div.style;this.graphics=(px)?new sN():new jsGraphics(this.name)}catch(e){}};var MBound=function(tj,tl,s4,s6,tp,s0){this.s4=s4;this.tj=tj;this.s6=s6;this.tl=tl;this.s0=(typeof s0=="undefined")?MAX_ZOOM_LEVEL:parseInt(s0);this.tp=(typeof tp=="undefined")?MIN_ZOOM_LEVEL:parseInt(tp);this.qn=function(lat,lon){if(this.s4<lat||this.tj>lat)return false;var g2=(lon-this.tl)%360;if(g2<0)g2+=360;return((this.s6-this.tl)>=g2)}};var MBrush=function(xt,x5,x6,cr,xn,yc,xo,fh,dmstyle){this.color=(typeof xt=="undefined")?"#FF0000":xt;this.stroke=(typeof x5=="undefined")?5:parseInt(x5);this.style=(typeof x6=="undefined")?0:parseInt(x6);this.fill=(typeof cr=="undefined")?false:cr;this.bgcolor=(typeof xn=="undefined")?this.color:xn;this.transparency=(typeof yc=="undefined")?transparencyLevel:parseInt(yc);this.bgtransparency=(typeof xo=="undefined")?transparencyLevel/2:parseInt(xo);this.arrow=(typeof fh=="undefined")?bArrow:fh;this.dmstyle=(typeof dmstyle=="undefined")?{color:"#0000ff",size:this.stroke*4,transparency:this.transparency,strokeWidth:1,strokeColor:"#FFFFFF",strokeTransparency:100}:dmstyle;this.overlap={enable:false,stroke:null,color:"white",transparency:transparencyLevel};this.toString=function(){return 'com.mapbar.maplet.MBrush'}};var MPoint=function(xQ,gYr4,encrypt,levelGroup){this.pid=null;this.lat=null;this.lon=null;this.maplet=null;var b6d=null;var nh7Oy=null;this.mapX=null;this.mapY=null;this.O71Wl=null;this.encrypt=(typeof encrypt=="boolean"?encrypt:true);this.levelGroup=(typeof levelGroup=="number"&&levelGroup>=0&&levelGroup<=3?levelGroup:3);if(typeof xQ!="undefined"||typeof gYr4!="undefined"){if(I41(xQ))xQ=xQ.join(",");if(typeof xQ=="string"&&xQ.indexOf(",")!=-1){if(this.encrypt){this.pid=xQ;this.lon=parseFloat(xQ.split(",")[0]);this.lat=parseFloat(xQ.split(",")[1])}else{nh7Oy=parseFloat(xQ.split(",")[0]);b6d=parseFloat(xQ.split(",")[1])}}else if(!isNaN(parseFloat(xQ))&&!isNaN(parseFloat(gYr4))){if(this.encrypt){this.pid=xQ+","+gYr4;this.lon=parseFloat(xQ);this.lat=parseFloat(gYr4)}else{nh7Oy=xQ;b6d=gYr4}}else{this.pid=(typeof getPid=="undefined")?xQ:getPid(xQ);if(apiType==1){var Ala=cq.vp(this.pid);nh7Oy=Ala[0];b6d=Ala[1];this.lon=parseFloat(this.pid.split(",")[0]);this.lat=parseFloat(this.pid.split(",")[1])}}if(this.encrypt&&nh7Oy==null&&b6d==null){var r=cq.vp(this.pid);nh7Oy=r[0];b6d=r[1]}};this.inLevelRange=function(level){if(level>=0&&level<=3&&this.levelGroup==3)return true;else if(level>=4&&level<=7&&this.levelGroup>=2)return true;else if(level>=8&&level<=11&&this.levelGroup>=1)return true;else if(level>=12&&level<=18&&this.levelGroup>=0)return true;else return false};this.getPid=function(){if(!this.encrypt&&!this.pid){this.pid=cq.zn(nh7Oy,b6d);if(apiType==1){this.lon=this.pid.split(",")[0];this.lat=this.pid.split(",")[1]}else if(this.lon!=null){var r=D307H(nh7Oy+","+b6d);this.lon=r[0];this.lat=r[1]}}return this.pid};this.setMapCoords=function(x,y){this.mapX=x;this.mapY=y;nh7Oy=this.maplet.zp(x,y);b6d=this.maplet.zo(x,y);this.pid=cq.zn(nh7Oy,b6d);if(apiType==1){this.lon=this.pid.split(",")[0];this.lat=this.pid.split(",")[1]}else if(this.lon!=null){var r=D307H(nh7Oy+","+b6d);this.lon=r[0];this.lat=r[1]}};this.recalcScreenCoords=function(){this.mapX=this.maplet.zl(nh7Oy,b6d);this.mapY=this.maplet.zm(b6d,nh7Oy)};this._galn=function(){return nh7Oy};this.Bx1=function(v){nh7Oy=v};this._galt=function(){return b6d};this.b6t6=function(v){b6d=v};this.clone=function(){var pt=new MPoint(undefined,undefined,this.encrypt,this.levelGroup);pt.pid=this.pid;pt.lat=this.lat;pt.lon=this.lon;pt.maplet=this.maplet;pt.Bx1(this._galn());pt.b6t6(this._galt());pt.mapX=this.mapX;pt.mapY=this.mapY;return pt};this.T$3=function(){return!isNaN(nh7Oy)&&!isNaN(b6d)};this.initialize=function(maplet){this.maplet=maplet;this.recalcScreenCoords()};this.toString=function(){return 'com.mapbar.maplet.MPoint'}};var f1={fx:[],uo:100,nk:function(img,src,w,h){if(typeof img!="object"||!img)return;this.fx[this.fx.length]=new Image();var pn=this.fx.length-1;this.fx[pn].q9=img;img.style.filter="alpha(opacity="+this.uo+");";img.style.MozOpacity=(this.uo/100.0);img.style.opacity=(this.uo/100.0);img.style.qK=(this.uo/100);if(typeof w!="undefined"){img.width=parseInt(w)+"px";this.fx[pn].width=parseInt(w)+"px"}if(typeof h!="undefined"){img.height=parseInt(h)+"px";this.fx[pn].height=parseInt(h)+"px"}this.fx[pn].container=this;this.fx[pn].pn=pn;this.fx[pn].ln="0";this.fx[pn].onload=function(){if(typeof w!="undefined"){this.width=parseInt(w)+"px"}if(typeof h!="undefined"){this.height=parseInt(h)+"px"}this.q9.src=this.src;this.q9.style.filter=null;this.q9.style.MozOpacity=1;this.q9.style.opacity=1;this.q9.style.qK=1;if(typeof w!="undefined"&&!rs){this.q9.width=parseInt(w)+"px";this.q9.style.width=parseInt(w)+"px"}if(typeof h!="undefined"&&!rs){this.q9.height=parseInt(h)+"px";this.q9.style.height=parseInt(h)+"px"}this.q9.setAttribute("done","1");this.ln="1";this.container[this.pn]=null;this.container.clearCache();this.container=null;this.q9=null;this.onload=null;this.onerror=null};this.fx[pn].onerror=function(){if(rs)return false;if(typeof w!="undefined"){this.width=parseInt(w)+"px"}if(typeof h!="undefined"){this.height=parseInt(h)+"px"}this.q9.style.filter=null;if(typeof w!="undefined"&&!rs){this.q9.width=parseInt(w)+"px"}if(typeof h!="undefined"&&!rs){this.q9.height=parseInt(h)+"px"}this.ln="1";this.q9.width="300";this.q9.height="300";this.q9.style.width="300";this.q9.style.height="300";this.q9.src=sX;this.q9.style.backgroundColor="#ebeae8";this.q9.setAttribute("done","1");this.container[this.pn]=null;this.container.clearCache();this.container=null;this.q9=null;this.onload=null;this.onerror=null};this.fx[pn].src=src},clearCache:function(){var cp=1;for(var i=0;i<this.fx.length;i++){if(this.fx[i]!=null&&this.fx[i].ln=="0"){cp=0}else if(this.fx[i]!=null){this.fx[i].q9=null;this.fx[i].container=null;this.fx[i].onload=null;this.fx[i].onerror=null;delete(this.fx[i])}}if(cp){for(var qC=0;i<this.fx.length;qC++){if(this.fx[qC]!=null){this.fx[qC].q9=null;this.fx[qC].container=null;this.fx[qC].onload=null;this.fx[qC].onerror=null;delete(this.fx[qC])}}this.fx.length=0;MEvent.trigger(this,"clean")}}};var gb=function(options){this.initialize=function(maplet){this.maplet=maplet;var content=[];rkC4j(content,"ctrlPan",0,0,50,49,-25,0,"_pan_map");rkC4j(content,"ctrlZoomOut",14,54,24,24,0,0,"_zo_map");var y1A=s18();rkC4j(content,"ctrlRuler",14,78,24,y1A,0,-24);rkC4j(content,"ctrlZoomIn",14,77+y1A,24,27,0,-181,"_zi_map");rkC4j(content,"ctrlSlider",0,0,17,7,-25,-51);content.push("<map name=\"_pan_map\" id=\"_pan_map\">");content.push("<area id=\"_fb_n_ctrl_imap\" shape=\"poly\" title=\""+xN[1]+"\" coords=\"35,6,39,3,42,2,47,1,51,1,56,2,61,4,63,6,63,7,55,15,50,13,48,13,43,15,35,7\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,2);\"/>");content.push("<area id=\"_fb_s_ctrl_imap\" shape=\"poly\" title=\""+xN[3]+"\" coords=\"64,38,55,29,50,31,48,31,43,29,34,38,34,39,37,42,42,44,47,45,51,45,56,44,61,42,64,39\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,4);\"/>");content.push("<area id=\"_fb_w_ctrl_imap\" shape=\"poly\" title=\""+xN[0]+"\" coords=\"34,8,42,16,40,21,40,23,42,28,33,37,32,37,30,35,28,30,27,25,27,21,28,16,30,11,33,8\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,1);\"/>");content.push("<area id=\"_fb_e_ctrl_imap\" shape=\"poly\" title=\""+xN[2]+"\" coords=\"64,8,56,16,58,21,58,23,56,28,65,37,66,37,68,35,70,30,71,25,71,21,70,16,68,11,65,8\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,3);\" />");content.push("<area id=\"_fb_m_ctrl_imap\" shape=\"circle\" title=\""+xN[4]+"\" coords=\"48,22,8\" onclick=\"PerformControl(event, this,7);\" onFocus=\"this.blur()\" />");content.push("</map>");content.push("<map name=\"_zo_map\" id=\"_zo_map\">");content.push("<area id=\"_fb_zo_ctrl_imap\" shape=\"poly\" title=\""+xN[6]+"\" coords=\"8,0,5,1,1,5,0,8,0,21,20,21,20,8,19,5,15,1,12,0\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,5);\" />");content.push("</map>");content.push("<map name=\"_zi_map\" id=\"_zi_map\">");content.push("<area id=\"_fb_zi_ctrl_imap\" shape=\"poly\" title=\""+xN[7]+"\" coords=\"0,183,0,196,1,199,5,203,8,204,12,204,15,203,19,199,20,196,20,183\" onFocus=\"this.blur()\" onclick=\"PerformControl(event, this,6);\" />");content.push("</map>");content.push("<div id=\"_fb_ctrl_leveltip\" style=\"position:absolute;left:0px;top:0px;width:"+gb.C2480+"px;height:121px;display:none;\">");deo(content,"_fb_ctrl_lt_s",gb.M000[0],0,0,gb.C2480,gb.$tx,-26,-65,13);deo(content,"_fb_ctrl_lt_c",gb.M000[1],0,40,gb.C2480,gb.$tx,-26,-65,8);deo(content,"_fb_ctrl_lt_p",gb.M000[2],0,72,gb.C2480,gb.$tx,-26,-65,4);deo(content,"_fb_ctrl_lt_cr",gb.M000[3],0,104,gb.C2480,gb.$tx,-26,-65,0);content.push("</div>");this.dom=new fD("LayerControl",Gmp62,HY116,0,0,true,3,content.join(""),this.maplet.panel);M65=aa("ctrlPan");e0HLO=aa("ctrlZoomOut");byyS=aa("ctrlZoomIn");q7YW=aa("ctrlRuler");yaT81=aa("ctrlSlider");Q7o5=aa("_fb_ctrl_leveltip");XNc6=aa("_fb_ctrl_lt_s");t56=aa("_fb_ctrl_lt_c");w637=aa("_fb_ctrl_lt_p");U921=aa("_fb_ctrl_lt_cr");yaT81.firstChild.id="ctrlSliderImg";aa("_pan_map").q9=this.maplet;aa("_zo_map").q9=this.maplet;aa("_zi_map").q9=this.maplet;y1Mnm["_ctlSlider_mousedown"]=MEvent.bindDom(yaT81,"mousedown",this,sMk);y1Mnm["document_mousemove"]=MEvent.bindDom(document,"mousemove",this,k75);y1Mnm["document_mouseup"]=MEvent.bindDom(document,"mouseup",this,_WI8A);y1Mnm["_ctlRuler_click"]=MEvent.bindDom(q7YW,"click",this,$2Pnx);y1Mnm["_ctlRuler_mouseover"]=MEvent.bindDom(q7YW,"mouseover",this,mcUc0);y1Mnm["_ctlRuler_mouseout"]=MEvent.bindDom(q7YW,"mouseout",this,_w6We);y1Mnm["_ctlRuler_mouseout"]=MEvent.bindDom(q7YW,"mousedown",this,y5l);y1Mnm["_ctlRuler_mouseout"]=MEvent.bindDom(q7YW,"mouseup",this,$13);y1Mnm["_zo_map_mouseover"]=MEvent.bindDom(aa("_zo_map"),"mouseover",this,mcUc0);y1Mnm["_zo_map_mouseout"]=MEvent.bindDom(aa("_zo_map"),"mouseout",this,_w6We);y1Mnm["_zi_map_mouseover"]=MEvent.bindDom(aa("_zi_map"),"mouseover",this,mcUc0);y1Mnm["_zi_map_mouseout"]=MEvent.bindDom(aa("_zi_map"),"mouseout",this,_w6We);y1Mnm["_ctlSlider_mouseover"]=MEvent.bindDom(yaT81,"mouseover",this,mcUc0);y1Mnm["_ctlSlider_mouseout"]=MEvent.bindDom(yaT81,"mouseout",this,_w6We);y1Mnm["_ltStreet_click"]=MEvent.bindDom(XNc6,"click",this,gb_6);y1Mnm["_ltCity_click"]=MEvent.bindDom(t56,"click",this,gb_6);y1Mnm["_ltProvince_click"]=MEvent.bindDom(w637,"click",this,gb_6);y1Mnm["_ltCountry_click"]=MEvent.bindDom(U921,"click",this,gb_6);y1Mnm["_ltStreet_mouseup"]=MEvent.bindDom(XNc6,"mouseup",this,yd2o);y1Mnm["_ltCity_mouseup"]=MEvent.bindDom(t56,"mouseup",this,yd2o);y1Mnm["_ltProvince_mouseup"]=MEvent.bindDom(w637,"mouseup",this,yd2o);y1Mnm["_ltCountry_mouseup"]=MEvent.bindDom(U921,"mouseup",this,yd2o);y1Mnm["_ltStreet_mousedown"]=MEvent.bindDom(XNc6,"mousedown",this,W14$a);y1Mnm["_ltCity_mousedown"]=MEvent.bindDom(t56,"mousedown",this,W14$a);y1Mnm["_ltProvince_mousedown"]=MEvent.bindDom(w637,"mousedown",this,W14$a);y1Mnm["_ltCountry_mousedown"]=MEvent.bindDom(U921,"mousedown",this,W14$a);y1Mnm["_zo_map_mouseup"]=MEvent.bindDom(aa("_zo_map"),"mouseup",this,yd2o);y1Mnm["_zi_map_mouseup"]=MEvent.bindDom(aa("_zi_map"),"mouseup",this,yd2o);y1Mnm["_fb_n_ctrl_imap_mouseup"]=MEvent.bindDom(aa("_fb_n_ctrl_imap"),"mouseup",this,yd2o);y1Mnm["_fb_s_ctrl_imap_mouseup"]=MEvent.bindDom(aa("_fb_s_ctrl_imap"),"mouseup",this,yd2o);y1Mnm["_fb_w_ctrl_imap_mouseup"]=MEvent.bindDom(aa("_fb_w_ctrl_imap"),"mouseup",this,yd2o);y1Mnm["_fb_e_ctrl_imap_mouseup"]=MEvent.bindDom(aa("_fb_e_ctrl_imap"),"mouseup",this,yd2o);y1Mnm["_fb_m_ctrl_imap_mouseup"]=MEvent.bindDom(aa("_fb_m_ctrl_imap"),"mouseup",this,yd2o);c8a.apply(this)};var rkC4j=function(content,m6b,F779,_95,HyTiK,bV1K,p1,p3,M540){content.push("<div id=\""+m6b+"\" style=\"position:absolute;left:"+F779+"px;top:"+_95+"px;width:"+HyTiK+"px;height:"+bV1K+"px;overflow:hidden;\" onmousedown=\"return false;\">");if(i639){content.push("<img id=\""+m6b+"_img\" src=\""+sX+"\" style=\"position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:"+p1+"px;top:"+p3+"px;border:0px;cursor:pointer;\"  onmousedown=\"return false;\" unselectable=\"on\" "+(typeof M540=="string"&&M540?"usemap=\"#"+M540+"\"":"")+" galleryimg=\"no\" />")}else{content.push("<img id=\""+m6b+"_img\" src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:"+p1+"px;top:"+p3+"px;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;border:0px;cursor:pointer;\" onmousedown=\"return false;\" unselectable=\"on\" "+(typeof M540=="string"&&M540?"usemap=\"#"+M540+"\"":"")+" galleryimg=\"no\"/>")}content.push("</div>")};var deo=function(content,m6b,text,F779,_95,HyTiK,bV1K,p1,p3,level){content.push("<div id=\""+m6b+"\" style=\"position:absolute;left:"+F779+"px;top:"+_95+"px;width:"+HyTiK+"px;height:"+bV1K+"px;overflow:hidden;\" onmousedown=\"return false;\">");content.push("<div id=\""+m6b+"_text\" style=\"position:absolute;padding-left:16px;padding-top:1px;color:white;z-index:1;width:"+(x00Vr||!px?35:45)+"px;text-align:center;font-size:12px;cursor:pointer;background-image:url('"+sX+"');\" _ml=\""+level+"\">"+text+"</div>");if(i639){content.push("<img src=\""+sX+"\" style=\"position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:"+p1+"px;top:"+p3+"px;border:0px;cursor:pointer;\"  onmousedown=\"return false;\" unselectable=\"on\" galleryimg=\"no\" />")}else{content.push("<img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:"+p1+"px;top:"+p3+"px;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;border:0px;cursor:pointer;\" onmousedown=\"return false;\" unselectable=\"on\" galleryimg=\"no\" />")}content.push("</div>")};var s18=function(){var g$t=MAX_ZOOM_LEVEL-MIN_ZOOM_LEVEL+1;return g$t*gb.w3824+g$t*gb.bA07+gb.w3824-1};var aNJ5N=function(AB){AB=MAX_ZOOM_LEVEL-AB;return AB*gb.w3824+AB*gb.bA07+PB8().max.y+3};var bc3M=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(M65){r.width=U5402(M65.style.width,0);r.height=U5402(M65.style.height,0);r.min.x=U5402(M65.style.left,0);r.min.y=U5402(M65.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var PB8=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(e0HLO){r.width=U5402(e0HLO.style.width,0);r.height=U5402(e0HLO.style.height,0);r.min.x=U5402(e0HLO.style.left,0);r.min.y=U5402(e0HLO.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var e2303=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(q7YW){r.width=U5402(q7YW.style.width,0);r.height=U5402(q7YW.style.height,0);r.min.x=U5402(q7YW.style.left,0);r.min.y=U5402(q7YW.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var GH8uW=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(byyS){r.width=U5402(byyS.style.width,0);r.height=U5402(byyS.style.height,0);r.min.x=U5402(byyS.style.left,0);r.min.y=U5402(byyS.style.top,0);r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var A18=function(){var r={min:{x:0,y:0},max:{x:0,y:0},width:0,height:0};if(Q7o5){r.width=U5402(Q7o5.style.width,0);r.height=U5402(Q7o5.style.height,0);r.min.x=U5402(Q7o5.style.left,0)+Gmp62;r.min.y=U5402(Q7o5.style.top,0)+HY116;r.max.x=r.min.x+r.width;r.max.y=r.min.y+r.height}return r};var ON32=function(){var XRS=e2303();_F2.min=XRS.min.y+gb.w3824;_F2.max=XRS.max.y-1-gb.w3824;_tM1.min=XRS.min.x;_tM1.max=XRS.max.x-3};var T4S=function(){with(this.options.location){var rect=this.getRect();var __7=e2303();if(type==Maplet.LEFT_TOP){Gmp62=marginx;HY116=marginy;GRQr=__7.max.x+5}else{if(type==Maplet.LEFT_BOTTOM){Gmp62=marginx;HY116=this.maplet.height-marginy-rect.height;GRQr=__7.max.x+5}else if(type==Maplet.RIGHT_TOP){Gmp62=this.maplet.width-marginx-rect.width;HY116=marginy;GRQr=__7.min.x-gb.C2480-5}else if(type==Maplet.RIGHT_BOTTOM){Gmp62=this.maplet.width-marginx-rect.width;HY116=this.maplet.height-marginy-rect.height;GRQr=__7.min.x-gb.C2480-5}}}ihs=e2303().min.y-2};this.setLocation=function(location,VMe){location=location||{};if(typeof location.type!="number"&&!(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM||location.type==Maplet.RIGHT_TOP||location.type==Maplet.LEFT_BOTTOM))location.type=Maplet.LEFT_TOP;if(typeof location.K4V!="number")location.marginx=10;if(typeof location.h4_f!="number")location.marginy=10;this.options.location=location;if(typeof VMe!="boolean")VMe=true;if(VMe)Qc5.apply(this)};this.setView=function(view,VMe){view=view||{};if(typeof view.pan!="boolean")view.pan=true;if(typeof view.zoomout!="boolean")view.zoomout=true;if(typeof view.ruler!="boolean")view.ruler=true;if(typeof view.zoomin!="boolean")view.zoomin=true;this.options.view=view;if(typeof VMe!="boolean")VMe=true;if(VMe)c8a.apply(this,[VMe])};var sMk=function(e){QD199(e);if(!Mir&&(e.target==yaT81||e.target==yaT81.firstChild)){ON32.apply(this);Mir=true;this.maplet.q453("move",yaT81)}else{Mir=false}return Mir};var k75=function(e){if(Mir){var currTop=e.clientY-this.maplet.offsetY-this.maplet.top-HY116;if(currTop>=_F2.min&&currTop<=_F2.max){yaT81.style.top=(currTop-3)+"px";if(ZOOM_TRANSITION&&(!ContentInfo||!ContentInfo.isVisible())){var h=(this.isVisible(M65)?0:49+10)+(this.isVisible(e0HLO)?0:24);var AB=MAX_ZOOM_LEVEL-((currTop+h)/(gb.w3824+gb.bA07)-10);this.maplet.AN(AB)}this.maplet.q453("move",document.body)}if(!K68M0&&px){document.body.setCapture();K68M0=true}}return Mir};var _WI8A=function(e){if(!Mir)return false;QD199(e,!HxT);if(Mir){var y=e.clientY-this.maplet.offsetY-this.maplet.top-HY116;y=y<_F2.min?_F2.min:y;y=y>_F2.max?_F2.max:y;var h=(this.isVisible(M65)?0:49+10)+(this.isVisible(e0HLO)?0:24);var AB=Math.ceil(MAX_ZOOM_LEVEL-((y+h)/(gb.w3824+gb.bA07)-10));if(this.maplet.AG==AB){this.maplet.dDig(true);this.maplet.lA.setVisible(true);if(this.maplet.Mv24)this.maplet.Mv24.setVisible(true);this.update(AB)}else{this.maplet.setZoomLevel(parseInt(AB))}Mir=false;if(K68M0){document.body.releaseCapture();K68M0=false;H7O5=true;getTimeout(this,C0SD,700)}return true}this.maplet.q453("default",document.body);this.maplet.q453("default",yaT81);return false};var $2Pnx=function(e){QD199(e);ON32.apply(this);var e=e||window.event;var y=e.clientY-HY116-this.maplet.offsetY-this.maplet.top;y=y<_F2.min?_F2.min:y;y=y>_F2.max?_F2.max:y;var h=(this.isVisible(M65)?0:49+10)+(this.isVisible(e0HLO)?0:24);var AB=Math.ceil(MAX_ZOOM_LEVEL-((y+h)/(gb.w3824+gb.bA07)-10));if(this.maplet.AG!=AB)this.maplet.setZoomLevel(parseInt(AB))};var y5l=function(e){QD199(e)};var $13=function(e){this.maplet.a6(e);_WI8A.apply(this,[e]);if(this.maplet.sS!=ts.D57MH&&this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.tv)QD199(e)};var mcUc0=function(e){QD199(e);if(!this.isVisible(q7YW))return;H7O5=false;if(!this.isVisible(Q7o5)){this.vh4(true)}};var _w6We=function(e){QD199(e);H7O5=true;getTimeout(this,C0SD,700)};var gb_6=function(e){QD199(e);var level=e.target.getAttribute("_ml");if(level){this.maplet.setZoomLevel(U5402(level))}};var yd2o=function(e){this.maplet.a6(e);this.maplet.overview.l1(e);_WI8A.apply(this,[e]);QD199(e)};var W14$a=function(e){QD199(e)};var C0SD=function(){if(!H7O5)return;var loop=false;if(this.isVisible(Q7o5)){var r=A18();var pt={x:this.maplet.moveX,y:this.maplet.moveY};var SS0D={min:{x:r.min.x,y:r.min.y},max:{x:r.max.x,y:r.max.y}};if(_isInsideRect(pt,SS0D))loop=true}if(Mir)loop=true;if(loop){getTimeout(this,C0SD,700);return}this.vh4(false)};this.update=function(AB){if(this.options&&this.options.location){T4S.apply(this);this.dom.style.left=Gmp62+"px";this.dom.style.top=HY116+"px"}if(yaT81&&q7YW&&this.isVisible(yaT81)&&this.isVisible(q7YW)){with(yaT81.style){left=U5402(q7YW.style.left,0)+2+"px";top=aNJ5N(AB)+"px"}}};this.showCtlPan=function(visible,VMe,A4N2){if(!M65)return;if(typeof visible!="boolean")visible=true;if(this.isVisible(M65)!=visible){if(visible){M65.style.height="49px";e0HLO.style.left="14px";q7YW.style.left="14px";byyS.style.left="14px"}else{M65.style.height="0px";e0HLO.style.left="0px";q7YW.style.left="0px";byyS.style.left="0px"}setVisible.apply(this,[M65,visible]);if(typeof A4N2!="boolean")A4N2=true;if(A4N2)this.options.view.pan=visible;if(typeof VMe!="boolean")VMe=true;if(VMe)Qc5.apply(this)}};this.showZOButton=function(visible,VMe,A4N2){if(!e0HLO)return;if(typeof visible!="boolean")visible=true;if(this.isVisible(e0HLO)!=visible){if(visible){if(!this.isVisible(q7YW)){e0HLO.style.height="23px"}else{e0HLO.style.height="24px"}}else{e0HLO.style.height="0px"}setVisible.apply(this,[e0HLO,visible]);if(typeof A4N2!="boolean")A4N2=true;if(A4N2)this.options.view.zoomout=visible;if(typeof VMe!="boolean")VMe=true;if(VMe)Qc5.apply(this)}};this.showCtlRuler=function(visible,VMe,A4N2){if(!q7YW)return;if(typeof visible!="boolean")visible=true;if(this.isVisible(q7YW)!=visible){if(visible){q7YW.style.height=s18()+"px";e0HLO.style.height=(U5402(e0HLO.style.height,0)+1)+"px";byyS.style.height=(U5402(byyS.style.height,0)+1)+"px";byyS.firstChild.style.top=(U5402(byyS.firstChild.style.top,0)+2)+"px"}else{q7YW.style.height="0px";e0HLO.style.height=Math.max((U5402(e0HLO.style.height,0)-1),0)+"px";byyS.style.height=Math.max((U5402(byyS.style.height,0)-1),0)+"px";byyS.firstChild.style.top=(U5402(byyS.firstChild.style.top,0)-2)+"px"}setVisible.apply(this,[yaT81,visible]);setVisible.apply(this,[q7YW,visible]);if(typeof A4N2!="boolean")A4N2=true;if(A4N2)this.options.view.ruler=visible;if(typeof VMe!="boolean")VMe=true;if(VMe)Qc5.apply(this)}};this.showZIButton=function(visible,VMe,A4N2){if(!byyS)return;if(typeof visible!="boolean")visible=true;if(this.isVisible(byyS)!=visible){if(visible)byyS.style.height="24px";else byyS.style.height="0px";setVisible.apply(this,[byyS,visible]);if(typeof A4N2!="boolean")A4N2=true;if(A4N2)this.options.view.zoomin=visible;if(typeof VMe!="boolean")VMe=true;if(VMe)Qc5.apply(this)}};this.vh4=function(visible){if(!Q7o5)return;if(typeof visible!="boolean")visible=true;if(this.isVisible(Q7o5)!=visible){if(visible){Q7o5.style.left=GRQr+"px";Q7o5.style.top=ihs+"px";if(this.options.location.type==Maplet.LEFT_TOP||this.options.location.type==Maplet.LEFT_BOTTOM){XNc6.childNodes[1].style.top=t56.childNodes[1].style.top=w637.childNodes[1].style.top=U921.childNodes[1].style.top="-65px";XNc6.childNodes[0].style.paddingLeft=t56.childNodes[0].style.paddingLeft=w637.childNodes[0].style.paddingLeft=U921.childNodes[0].style.paddingLeft="16px";XNc6.childNodes[0].style.paddingRight=t56.childNodes[0].style.paddingRight=w637.childNodes[0].style.paddingRight=U921.childNodes[0].style.paddingRight="0px"}else{XNc6.childNodes[1].style.top=t56.childNodes[1].style.top=w637.childNodes[1].style.top=U921.childNodes[1].style.top="-84px";XNc6.childNodes[0].style.paddingLeft=t56.childNodes[0].style.paddingLeft=w637.childNodes[0].style.paddingLeft=U921.childNodes[0].style.paddingLeft="0px";XNc6.childNodes[0].style.paddingRight=t56.childNodes[0].style.paddingRight=w637.childNodes[0].style.paddingRight=U921.childNodes[0].style.paddingRight="16px"}setVisible.apply(this,[U921,MIN_ZOOM_LEVEL<=0]);setVisible.apply(this,[w637,(4>=MIN_ZOOM_LEVEL&&4<=MAX_ZOOM_LEVEL)]);setVisible.apply(this,[t56,(8>=MIN_ZOOM_LEVEL&&8<=MAX_ZOOM_LEVEL)]);setVisible.apply(this,[XNc6,MAX_ZOOM_LEVEL>=13]);if(!this.isVisible(XNc6)){var c=13-MAX_ZOOM_LEVEL;Q7o5.style.top=ihs-(c*gb.w3824+c*gb.bA07)+"px"}else if(MAX_ZOOM_LEVEL>13){var c=MAX_ZOOM_LEVEL-13;Q7o5.style.top=ihs+(c*gb.w3824+c*gb.bA07)+"px"}}setVisible.apply(this,[Q7o5,visible])}};var c8a=function(Nahr){if(typeof Nahr!="boolean")Nahr=true;with(this.options.view){this.showCtlPan(pan,false);this.showZOButton(zoomout,false);this.showCtlRuler(ruler,false);this.showZIButton(zoomin,false)}if(Nahr)Qc5.apply(this)};var Qc5=function(){this.vh4(false);e0HLO.style.top=(bc3M().max.y+(this.isVisible(M65)?5:-5))+"px";q7YW.style.top=PB8().max.y+"px";byyS.style.top=e2303().max.y+"px";this.maplet.md0();this.maplet.F0lQ();this.update(this.maplet.AG)};this.hide=function(){setVisible.apply(this,[this.dom,false])};this.show=function(){setVisible.apply(this,[this.dom,true])};var setVisible=function(tX88,visible){if(!this.dom||typeof tX88!="object"||!tX88)return;if(tX88.style.display!=(visible?"":"none"))tX88.style.display=visible?"":"none"};this.isVisible=function(tX88){if(typeof tX88!="object"||!tX88)tX88=this.dom;if(!tX88)return false;return tX88.style.display==""};this.g1=function(){MEvent.removeBuiltInListener(yaT81,"mousedown",y1Mnm["_ctlSlider_mousedown"]);MEvent.removeBuiltInListener(document,"mousemove",y1Mnm["document_mousemove"]);MEvent.removeBuiltInListener(document,"mouseup",y1Mnm["document_mouseup"]);MEvent.removeBuiltInListener(q7YW,"click",y1Mnm["_ctlRuler_click"]);MEvent.removeBuiltInListener(q7YW,"mouseover",y1Mnm["_ctlRuler_mouseover"]);MEvent.removeBuiltInListener(q7YW,"mouseout",y1Mnm["_ctlRuler_mouseout"]);MEvent.removeBuiltInListener(q7YW,"mousedown",y1Mnm["_ctlRuler_mouseout"]);MEvent.removeBuiltInListener(q7YW,"mouseup",y1Mnm["_ctlRuler_mouseout"]);MEvent.removeBuiltInListener(aa("_zo_map"),"mouseover",y1Mnm["_zo_map_mouseover"]);MEvent.removeBuiltInListener(aa("_zo_map"),"mouseout",y1Mnm["_zo_map_mouseout"]);MEvent.removeBuiltInListener(aa("_zi_map"),"mouseover",y1Mnm["_zi_map_mouseover"]);MEvent.removeBuiltInListener(aa("_zi_map"),"mouseout",y1Mnm["_zi_map_mouseout"]);MEvent.removeBuiltInListener(yaT81,"mouseover",y1Mnm["_ctlSlider_mouseover"]);MEvent.removeBuiltInListener(yaT81,"mouseout",y1Mnm["_ctlSlider_mouseout"]);MEvent.removeBuiltInListener(XNc6,"click",y1Mnm["_ltStreet_click"]);MEvent.removeBuiltInListener(t56,"click",y1Mnm["_ltCity_click"]);MEvent.removeBuiltInListener(w637,"click",y1Mnm["_ltProvince_click"]);MEvent.removeBuiltInListener(U921,"click",y1Mnm["_ltCountry_click"]);MEvent.removeBuiltInListener(XNc6,"mouseup",y1Mnm["_ltStreet_mouseup"]);MEvent.removeBuiltInListener(t56,"mouseup",y1Mnm["_ltCity_mouseup"]);MEvent.removeBuiltInListener(w637,"mouseup",y1Mnm["_ltProvince_mouseup"]);MEvent.removeBuiltInListener(U921,"mouseup",y1Mnm["_ltCountry_mouseup"]);MEvent.removeBuiltInListener(XNc6,"mousedown",y1Mnm["_ltStreet_mousedown"]);MEvent.removeBuiltInListener(t56,"mousedown",y1Mnm["_ltCity_mousedown"]);MEvent.removeBuiltInListener(w637,"mousedown",y1Mnm["_ltProvince_mousedown"]);MEvent.removeBuiltInListener(U921,"mousedown",y1Mnm["_ltCountry_mousedown"]);MEvent.removeBuiltInListener(aa("_zo_map"),"mouseup",y1Mnm["_zo_map_mouseup"]);MEvent.removeBuiltInListener(aa("_zi_map"),"mouseup",y1Mnm["_zi_map_mouseup"]);MEvent.removeBuiltInListener(aa("_fb_n_ctrl_imap"),"mouseup",y1Mnm["_fb_n_ctrl_imap_mouseup"]);MEvent.removeBuiltInListener(aa("_fb_s_ctrl_imap"),"mouseup",y1Mnm["_fb_s_ctrl_imap_mouseup"]);MEvent.removeBuiltInListener(aa("_fb_w_ctrl_imap"),"mouseup",y1Mnm["_fb_w_ctrl_imap_mouseup"]);MEvent.removeBuiltInListener(aa("_fb_e_ctrl_imap"),"mouseup",y1Mnm["_fb_e_ctrl_imap_mouseup"]);MEvent.removeBuiltInListener(aa("_fb_m_ctrl_imap"),"mouseup",y1Mnm["_fb_m_ctrl_imap_mouseup"]);if(this.dom)this.dom.finalize();if(aa("_pan_map"))aa("_pan_map").q9=null;if(aa("_zo_map"))aa("_zo_map").q9=null;if(aa("_zi_map"))aa("_zi_map").q9=null;M7e5S(this)};this.getRect=function(){var r={min:{x:null,y:null},max:{x:null,y:null},oUj3:{x:null,y:null},T6G:{x:null,y:null},width:null,height:null};if(this.isVisible(this.dom)){if(this.isVisible(M65)){r=bc3M();r.oUj3={x:null,y:null};r.T6G={x:null,y:null}}if(this.isVisible(e0HLO)){var v=PB8();if(r.min.x==null)r.min.x=v.min.x;if(r.min.y==null)r.min.y=v.min.y;if(r.max.x==null)r.max.x=v.max.x;r.max.y=v.max.y}if(this.isVisible(q7YW)){var v=e2303();if(r.min.x==null)r.min.x=v.min.x;if(r.min.y==null)r.min.y=v.min.y;if(r.max.x==null)r.max.x=v.max.x;r.max.y=v.max.y}if(this.isVisible(byyS)){var v=GH8uW();if(r.min.x==null)r.min.x=v.min.x;if(r.min.y==null)r.min.y=v.min.y;if(r.max.x==null)r.max.x=v.max.x;r.max.y=v.max.y}r.oUj3.x=r.min.x+Gmp62;r.oUj3.y=r.min.x+HY116;r.T6G.x=r.max.x+Gmp62;r.T6G.y=r.max.y+HY116;r.width=r.max.x-r.min.x;r.height=r.max.y-r.min.y}return r};var M65=null;var e0HLO=null;var byyS=null;var q7YW=null;var yaT81=null;var Q7o5=null;var XNc6=null;var t56=null;var w637=null;var U921=null;var y1Mnm=[];var Mir=false;var _F2={min:0,max:0};var _tM1={min:0,max:0};var Gmp62=-Number.MAX_VALUE;var HY116=-Number.MAX_VALUE;var GRQr=-Number.MAX_VALUE;var ihs=-Number.MAX_VALUE;var H7O5=true;var K68M0=false;this.maplet=null;this.dom=null;this.options=options||{};with(this.options){this.setLocation(typeof location!="object"?undefined:location,false);this.setView(typeof view!="object"?undefined:view,false)};this.controlCanvas={};this.controlCanvas.div={};this.controlCanvas.div.update=function(){};this.onmousedown=sMk;this.onmousemove=k75;this.onmouseup=_WI8A;this.onmouseout=function(){}};gb.w3824=6;gb.bA07=2;gb.C2480=52;gb.$tx=18;gb.M000=["\u8857\u9053","\u57ce\u5e02","\u7701","\u56fd\u5bb6"];function ny(e){if(!e){e=window.event}if(e&&!e.target){e.target=e.srcElement}if(e&&typeof e.button=="undefined"){e.button=e.which}e.yK9=function(){if(this.stopPropagation){this.stopPropagation()}else{this.cancelBubble=false}};e.$10w=function(){if(this.preventDefault){this.preventDefault()}else{this.returnValue=false}};return e};function getTimeout(uy,q0,yI){return window.setTimeout(function(){q0.apply(uy)},yI)};function nB(uy,q0,yI){return window.setInterval(function(){q0.apply(uy)},yI)};var MEvent={nD:function(l7){return "_e__"+l7},addListener:function(uy,l7,q0){var l8=this.nD(l7);if(uy[l8]){var cZ=true;for(var i=0;i<uy[l8].length;i++){var h=uy[l8][i];if(h==q0){cZ=false;break}}if(cZ)uy[l8].push(q0)}else{uy[l8]=[q0]}return{qg:uy,propertyName:l8,q0:q0}},removeListener:function(q9){var uy=q9.qg[q9.propertyName];for(var c=0;c<uy.length;c++){if(uy[c]==q9.q0){uy.splice(c,1);return}}},contains:function(uy,l7){var l8=this.nD(l7);if(typeof uy[l8]!="undefined")return uy[l8].length;else return 0},clearListeners:function(uy,l7){var l8=this.nD(l7);uy[l8]=null},trigger:function(uy,l8){var l9=this.nD(l8);var lS=uy[l9];if(lS&&lS.length>0){var vn=[];for(var c65=2;c65<arguments.length;c65++){vn.push(arguments[c65])}for(var i=0;i<lS.length;i++){var h=lS[i];if(h){try{h.apply(uy,vn)}catch(e){}}}}},addBuiltInListener:function(uy,l8,q0,d46){if(uy.addEventListener){uy.addEventListener(l8,q0,d46)}else if(uy.attachEvent){uy.attachEvent("on"+l8,q0)}else{uy["on"+l8]=q0}return q0},removeBuiltInListener:function(uy,l8,q0){if(uy.removeEventListener){uy.removeEventListener(l8,q0,false)}else if(uy.detachEvent){uy.detachEvent("on"+l8,q0)}else{uy["on"+l8]=null}},bind:function(uy,l8,fU,q0){return this.addListener(uy,l8,function(){q0.apply(fU,arguments)})},bindDom:function(uy,l8,fU,q0,d46){d46=!!d46;var an=this.gm(fU,q0);return this.addBuiltInListener(uy,l8,an,d46)},gm:function(uy,l8){return function(e){e=ny(e);l8.call(uy,e)}},callback:function(q0,uy){return function(){return uy.apply(q0,arguments)}}};var MIcon=function(imgUrl,width,height,anchorX,anchorY,l44Is){this.ao=new Array();this.X6899=1;this.div=document.createElement("div");this.div.unselectable="on";this.div.style.zIndex=this.X6899;this.div.style.position="absolute";width=(typeof width=="undefined")?16:width;height=(typeof height=="undefined")?16:height;this.img=document.createElement("div");this.img.unselectable="on";this.img.style.MozUserSelect="none";this.img.style.zIndex=this.X6899;this.img.style.position="absolute";this.img.style.top="0px";this.img.style.left="0px";this.imgUrl=imgUrl;this.left=0;this.top=0;this.Ft2=this.left;this.d$L=this.top;this.wz=function(id){this.div.id="OverlayBg"+id;this.img.id=id};this.initialize=function(marker){if(px)this.img.ondragstart=function(){return false};this.marker=marker;pps(this.img.firstChild,"oid",this.marker.id);this.ao["mouseover"]=MEvent.bindDom(this.img.firstChild,"mouseover",this.marker,this.marker.hiliteIcon);this.ao["mouseout"]=MEvent.bindDom(this.img.firstChild,"mouseout",this.marker,this.marker.v4)};this.setContextMenu=function(menu){};this.getImgUrl=function(){var N7k="";var pC=this.img;if(pC.innerHTML.indexOf(Maplet.MICON_IMGSRC_FLAG)!=-1){var bc06=new RegExp(Maplet.MICON_IMGSRC_FLAG+"=\"?([^\"\t ]*)","gi");var f7x5=bc06.exec(pC.innerHTML);if(f7x5!=null)N7k=f7x5[1]}else if(pC.firstChild&&pC.firstChild.tagName.toUpperCase()=="IMG"){N7k=pC.firstChild.src}else{N7k=this.imgUrl}return N7k};this.enableDragMap=function(enable){if(!this.img||!this.img.firstChild)return;if(enable)pps(this.img.firstChild,_Fj3O,"true");else o110(this.img.firstChild,_Fj3O)};this.updateImage=function(w7,Aj,nV){if((this.img.firstChild&&this.imgUrl==w7)||!w7)return;this.imgUrl=w7;if(typeof this.imgUrl=="string"){if(this.imgUrl.indexOf("<")>=0){this.img.innerHTML=this.imgUrl}else{this.img.innerHTML="<img src="+this.imgUrl+" width="+(typeof Aj=="undefined"?width:Aj)+" height="+(typeof Aj=="undefined"?height:nV)+">";if(this.marker){if(this.marker.label&&typeof Aj!="undefined"){this.marker.label.xoffset+=Aj-width;width=Aj}if(this.marker.maplet){this.marker.initialize(this.marker.maplet)}}}}else{this.img.innerHTML="";this.img.appendChild(this.imgUrl)}this.img.firstChild.onmousedown=function(e){return false};pps(this.img.firstChild,N152,"marker");this.enableDragMap(this.marker?!this.marker.bEditable:true)};this.updateImage(imgUrl);this.width=(typeof width=="undefined")?parseInt(this.img.width):parseInt(width);this.height=(typeof height=="undefined")?parseInt(this.img.height):parseInt(height);this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.l44Is=(typeof l44Is=="undefined")?imgUrl:l44Is;this.anchorX=(typeof anchorX=="undefined")?this.width/2:parseInt(anchorX);this.anchorY=(typeof anchorY=="undefined")?this.height/2:parseInt(anchorY);this.div.appendChild(this.img);this.update=function(maplet,left,top){var zB=parseInt(left)-parseInt(this.anchorX);var zF=parseInt(top)-parseInt(this.anchorY);if(this.marker.autoHide&&!this.marker.ls&&(zB>maplet.width||zB<-this.width||zF>maplet.height||zF<-this.height)){if(this.div.parentNode){this.div.style.top=zF+"px";this.div.style.left=zB+"px";this.div.parentNode.removeChild(this.div);if(this.marker.label)this.marker.label.remove();this.fu=false}}else{if(this.div.parentNode!=maplet.lA.div&&!this.marker.ls){maplet.lA.appendChild(this.div);this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.img.width=this.width+"px";this.img.height=this.height+"px";this.fu=true}this.div.style.top=zF+"px";this.div.style.left=zB+"px";this.Ft2=this.left;this.d$L=this.top;this.left=zB;this.top=zF;left=zB;top=zF;if(this.marker.label)this.marker.label.update(this.marker.maplet,left,top)}};this.isVisible=function(){return(this.fu)};this.zq=function(){return(this.img.firstChild.src)+","+this.width+","+this.height};this.hilite=function(){if(this.marker){this.marker.hiliteIcon({target:this.img})}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.img.firstChild){if(px)this.img.ondragstart=null;this.img.firstChild.onmousedown=null;for(var l8 in this.ao){MEvent.removeBuiltInListener(this.img.firstChild,l8,this.ao[l8]);this.ao[l8]=null;if(finalize)delete this.ao[l8]}}if(finalize)this.ao=null;if(this.div){if(!finalize){if(this.div.parentNode)this.div.parentNode.removeChild(this.div)}else{_removeNode(this.div);this.div=null}}if(finalize)this.marker=null};this.setZIndex=function(CV0){if(this.div&&this.div.parentNode&&CV0!=this.div.style.zIndex){this.X6899=this.div.style.zIndex;this.div.style.zIndex=CV0}};this.e4501=function(){if(!this.div)return;if(this.X6899!=this.div.style.zIndex){this.setZIndex(this.X6899)}};this.getRect=function(){var r={min:{x:this.div.offsetLeft,y:this.div.offsetTop},max:{x:0,y:0}};r.max.x=r.min.x+this.div.offsetWidth;r.max.y=r.min.y+this.div.offsetHeight;return r};this.toString=function(){return 'com.mapbar.maplet.MIcon'}};var MMarker=function(pt,icon,info,label,shadow){this.id=new Date().getTime()+""+parseInt(Math.random()*10000);this.pt=pt;this.icon=(typeof icon=="undefined")?null:icon;if(this.icon&&this.icon.wz){this.icon.wz(this.id)}this.shadow=typeof shadow=="undefined"?null:shadow;if(this.shadow&&this.shadow.wz)this.shadow.wz(this.id);this.label=(typeof label=="undefined")?null:label;if(this.label&&this.label.wz){this.label.wz(this.id)}this.info=null;if(typeof info!="undefined"&&info){this.info=info;this.info.setOverlay(this)}this.lw=0;this.ls=false;this.bEditable=false;this.rotation=0;this.ao=new Array();this.contextmenu=null;this.autoHide=true;this.dragAnimation=true;this.KL0=false;this.creator=MLayer.USER;this.M26G=false;this.setContextMenu=function(menu){this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet)this.contextmenu.initialize(this.maplet);if(!this.contextmenu.containsOverlay(this))this.contextmenu.addOverlay(this)}else if(!menu){this.removeContextMenu()}};this.getContextMenu=function(dom){return this.contextmenu};this.wz=function(id){this.id=id;if(this.icon&&this.icon.wz){this.icon.wz(id)}if(this.shadow&&this.shadow.wz)this.shadow.wz(id)};this.setEditable=function(cs){this.bEditable=(typeof cs=="undefined")?false:cs;if(REFRESH_MK_INDEX)this.refreshZIndex();if(this.icon)this.icon.enableDragMap(!this.bEditable)};this.refreshZIndex=function(j8v){if(!this.icon)return;if(typeof j8v!="boolean")j8v=true;if(this.maplet){var p6D=this.maplet.getMarkerPolygons(this);if(p6D.length>0){var b=false;for(var i=0;i<p6D.length;i++){if(p6D[i].bEditable){b=true;break}}if(this.bEditable||!b){if(this.icon.div.style.zIndex<0)this.e4501()}else{if(this.icon.div.style.zIndex>=0)this.setZIndex(-1)}if(j8v){for(var i=0;i<p6D.length;i++){p6D[i].$98$s(this)}}}}};this.initialize=function(maplet){this.gd7(true);this.maplet=maplet;this.dragAnimation=this.maplet.markerDragAnimation&&this.dragAnimation;if(typeof this.contextmenu=="object"&&this.contextmenu){if(!this.contextmenu.maplet)this.contextmenu.initialize(this.maplet);if(!this.contextmenu.containsOverlay(this))this.contextmenu.addOverlay(this)}this.ao["mousedown"]=MEvent.bindDom(this.maplet.map,"mousedown",this,this.w0);if(this.icon!=null){this.icon.initialize(this)}if(this.label!=null){this.label.initialize(this)}if(this.shadow!=null){this.shadow.initialize(this)}{if(this.info!=null){this.ao["info_"+this.info.yd]=MEvent.bindDom(this.maplet.map,this.info.yd,this,this.openInfoWindow)}else{this.ao["click"]=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}}if(typeof this.maplet.lA!="undefined"){this.paint()}if(REFRESH_MK_INDEX)this.refreshZIndex()};this.toString=function(){return 'com.mapbar.maplet.MMarker'};this.paint=function(){if(!this.maplet)return;if(!this.pt.maplet)this.pt.initialize(this.maplet);if(this.maplet._67R){if(this.maplet.O71Wl!=this.pt.O71Wl){this.pt.mapX+=this.maplet.tJW3;this.pt.mapY+=this.maplet.R8G;this.pt.O71Wl=this.maplet.O71Wl}}else{this.pt.recalcScreenCoords()}if(this.icon){if(!this.icon.marker)this.icon.initialize(this);this.icon.update(this.maplet,this.pt.mapX,this.pt.mapY)}if(this.shadow){if(!this.shadow.marker)this.shadow.initialize(this);this.shadow.update(this.maplet,this.pt.mapX,this.pt.mapY)}};this.zq=function(){return(this.icon.isVisible())?"1"+","+this.pt.getPid()+","+this.icon.zq():""};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.maplet&&this.maplet.markerDragAnimation)this.maplet.T352(false);if(finalize)this.removeContextMenu();if(this.icon){this.icon.remove(finalize)}if(this.label){this.label.remove(finalize)}if(this.shadow){this.shadow.remove(finalize)}this.gd7(finalize);if(this.maplet){if(this.maplet.u5[this.id]){this.maplet.u5[this.id]=null;delete this.maplet.u5[this.id]}}if(finalize)this.ao=null;this.maplet=null};this.gd7=function(finalize){if(this.maplet){for(var l8 in this.ao){var l9=l8.substring(0,5)=="info_"?l8.substring(5):l8;MEvent.removeBuiltInListener(this.maplet.map,l9,this.ao[l8]);this.ao[l8]=null;if(finalize)delete this.ao[l8]}}};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.openInfoWindow=function(e){if(this.openInfoWindow.caller==null){}if(this.maplet!=null){if((new Date().getTime()-this.lw)<200)return;if(this.maplet.dM6O&&typeof e=="object"&&((this.icon&&fJ(e.target,this.icon.img))||(this.label&&fJ(e.target,this.label.div)))){this.maplet.dM6O=false;if(this.maplet.Su15||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this))return}var x=this.pt.mapX;var y=this.pt.mapY;if(typeof e=="undefined"||(typeof e=="object"&&this.icon&&fJ(e.target,this.icon.img))||(typeof e=="object"&&this.label&&fJ(e.target,this.label.div))){if(typeof e=="object"&&this.maplet.sS!=ts.ty&&this.maplet.sS!=ts.tu){return}if(!this.icon.isVisible()){if(x>=this.maplet.width*1.5||x<=-(this.maplet.width/2)||y<=-(this.maplet.height/2)||y>=this.maplet.height*1.5){this.maplet.setCenter(this.pt.getPid());x=this.maplet.width/2;y=this.maplet.height/2}}this.x=x;this.y=y;if(this.openInfoWindow.caller&&this.openInfoWindow.caller.toString().indexOf(".call(")!=-1){avBubble.uTc=false;MEvent.trigger(this,"click",this)}if(!this.maplet)return;if(!this.info){return}else if(!this.info.getOverlay()){this.info.setOverlay(this)}if(iToolTipStyle!=2){this.hiliteIcon({target:{id:this.id}});this.maplet.wN(x,y,this.info,"","",true)}}else if(typeof e=="boolean"&&e||e=="true"){if(!this.info){return}else if(!this.info.getOverlay()){this.info.setOverlay(this)}if(x>this.maplet.width*2||x<-this.maplet.width||y<-this.maplet.height||y>this.maplet.height*2){this.maplet.setCenter(this.pt.getPid());x=this.maplet.width/2;y=this.maplet.height/2}this.maplet.wN(x,y,this.info,true)}}};this.w0=function(e){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.sS==ts.tu)&&fJ(e.target,this.icon.img)&&e.button!=2){this.qo=true;this.fd=false;this.l6=this.id;this.l0=parseInt(e.clientX-this.maplet.offsetX-this.maplet.left)-parseInt(this.icon.div.style.left);this.na=parseInt(e.clientY-this.maplet.offsetY-this.maplet.top)-parseInt(this.icon.div.style.top);if(this.rotation==1){var lb=this.l0-this.icon.width/2;var lc=this.na-this.icon.height/2;var la=Math.sqrt(lb*lb+lc*lc);if(la>(this.icon.width/4-5)){this.fd=true;this.downX=e.clientX;this.downY=e.clientY}}this.ao["mousemove"]=MEvent.bindDom(document,"mousemove",this,this.f9);this.ao["mouseup"]=MEvent.bindDom(document,"mouseup",this,this.l1);if(px)this.ao["losecapture"]=MEvent.bindDom(document.body,"losecapture",this,this.l1);else this.ao["blur"]=MEvent.bindDom(window,"blur",this,this.l1)}};this.f9=function(e){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.sS==ts.tu)&&(fJ(e.target,this.icon.img)||this.l6==this.id)){if(this.qo){if(avBubble.overlay&&avBubble.overlay.id==this.id)this.maplet.hideBubble();if(!this.fd){var x=e.clientX-this.maplet.offsetX-this.maplet.left-this.l0;var y=e.clientY-this.maplet.offsetY-this.maplet.top-this.na;var Pq0i9=this.maplet.Fqa;var c19=0,ep5l_=0;if(this.icon.div.parentNode==this.maplet.lA.div){this.maplet.panel.appendChild(this.icon.div);if(this.label)this.maplet.panel.appendChild(this.label.div);if(this.shadow)this.maplet.panel.appendChild(this.shadow.div);this.setZIndex(pF);if(px)document.body.setCapture();if(this.maplet.markerDragAnimation){c19=Pq0i9.Rk4;ep5l_=Pq0i9.Yb1}}if(!Bo99S)Bo99S=nB(this,Es42g,100);if(this.dragAnimation){y=y+this.icon.anchorY-Pq0i9.height/2;this.maplet.T352(true,x+this.icon.anchorX-Pq0i9.width/2,y);y=y-Pq0i9.offsetY-this.icon.height}this.x=x;this.y=y;this.lw=new Date().getTime();this.ls=true;this.icon.update(this.maplet,x+this.icon.anchorX,y+this.icon.anchorY);if(this.shadow){var g4=this.icon.left-this.icon.Ft2;var g5=this.icon.top-this.icon.d$L;this.shadow.update(this.maplet,this.shadow.left+g4+this.shadow.anchorX+c19,this.shadow.top+g5+this.shadow.anchorY+ep5l_)}if((MEvent.contains(this,"dragstart")&&!this.KL0)||MEvent.contains(this,"draging")){var pt=null;if(this.dragAnimation){pt=new MPoint(this.maplet.toMapCoordinate(U5402(Pq0i9.fC.div.style.left)+Pq0i9.width/2,U5402(Pq0i9.fC.div.style.top)+Pq0i9.height/2))}else{pt=new MPoint(this.maplet.toMapCoordinate(this.x+this.icon.anchorX,this.y+this.icon.anchorY))}pt.initialize(this.maplet);if(MEvent.contains(this,"dragstart")&&!this.KL0){MEvent.trigger(this,"dragstart",this,pt);this.KL0=true}if(MEvent.contains(this,"draging")){MEvent.trigger(this,"draging",this,pt)}}}else{var wc=parseInt(e.clientX-this.maplet.offsetX-this.maplet.left)-parseInt(this.icon.div.style.left);var wd=parseInt(e.clientY-this.maplet.offsetY-this.maplet.top)-parseInt(this.icon.div.style.top);var wa=Math.atan2((wd-this.icon.height/2),wc-this.icon.width/2);var wb=((90+wa*180/Math.PI)+360)%360;MEvent.trigger(this,"rotate",wb)}if(px)this.maplet.a3(e)}}};this.l1=function(e){if(this.icon!=null&&this.maplet&&(this.bEditable||this.maplet.sS==ts.tu)&&this.qo&&this.ls){if(this.maplet.fa)this.maplet.finishupPan();MEvent.removeBuiltInListener(document,"mousemove",this.ao["mousemove"]);this.ao["mousemove"]=null;MEvent.removeBuiltInListener(document,"mouseup",this.ao["mouseup"]);this.ao["mouseup"]=null;if(px){MEvent.removeBuiltInListener(document.body,"losecapture",this.ao["losecapture"]);this.ao["losecapture"]=null}else{MEvent.removeBuiltInListener(window,"blur",this.ao["blur"]);this.ao["blur"]=null}this.KL0=false;if(!this.fd){var x=e.clientX-this.maplet.offsetX-this.maplet.left-this.l0;var y=e.clientY-this.maplet.offsetY-this.maplet.top-this.na;if(isNaN(x))x=this.x;if(isNaN(y))y=this.y;if(this.icon.div.parentNode!=this.maplet.lA.div){this.maplet.lA.appendChild(this.icon.div);if(this.label)this.maplet.lA.appendChild(this.label.div);if(this.shadow){this.maplet.lA.appendChild(this.shadow.div);this.shadow.e4501()}with(this.maplet.Fqa.fC){if(div.parentNode!=this.maplet.lA.div){this.maplet.lA.div.appendChild(div);div.style.zIndex=this.icon.div.style.zIndex-1}}if(px)document.body.releaseCapture()}if(this.dragAnimation){y=parseInt(this.maplet.Fqa.fC.style.top)+this.maplet.Fqa.height/2-this.icon.anchorY}this.pt.setMapCoords(x+this.icon.anchorX,y+this.icon.anchorY);this.x=x;this.y=y;if(this.dragAnimation)S05V.apply(this)}else{}MEvent.trigger(this,"drag",this);MEvent.trigger(this.maplet,"edit",this);if(this.ls){this.lw=new Date().getTime();this.ls=false}if(this.maplet.sS==ts.tb||this.maplet.sS==ts.ta||this.maplet.sS==ts.lz||this.maplet.sS==ts.ly)this.maplet.Jj1j=false}if(this.l6==this.id){this.l6=null}this.qo=false};this.hiliteIcon=function(e){if(this.icon!=null&&fJ(e.target,this.id)&&!this.qo){if(this.maplet.sS==ts.tz||this.maplet.sS==ts.tA||this.maplet.sS==ts.D57MH){this.maplet.q453("no-drop",this.icon.img)}else if(this.info||MEvent.contains(this,"click")>0||this.bEditable){this.maplet.q453("pointer",this.icon.img)}if(this.icon.div.style.zIndex<pF){pF++}this.icon.setZIndex(pF);if(this.label)this.label.setZIndex(pF);var x=this.maplet.zl(this.pt.lon,this.pt.lat);var y=this.maplet.zm(this.pt.lat,this.pt.lon);this.x=x;this.y=y;if(typeof e.button!="undefined"&&!this.M26G){this.M26G=true;MEvent.trigger(this,"mouseover",this)}}};this.v4=function(e){this.maplet.q453("default",this.icon.img);if(this.icon!=null&&fJ(e.target,this.id)&&!this.qo){var x=this.maplet.zl(this.pt.lon,this.pt.lat);var y=this.maplet.zm(this.pt.lat,this.pt.lon);this.x=x;this.y=y;MEvent.trigger(this,"mouseout",this);this.M26G=false}};this.setZIndex=function(CV0){if(this.icon)this.icon.setZIndex(CV0);if(this.label)this.label.setZIndex(CV0);if(this.shadow)this.shadow.setZIndex(CV0)};this.e4501=function(){if(this.icon)this.icon.e4501();if(this.label)this.label.e4501();if(this.shadow)this.shadow.e4501()};this.setIcon=function($LE28,S$85){if(typeof S$85!="boolean")S$85=true;if(this.icon){this.icon.remove();this.icon=null}if($LE28){this.icon=$LE28;this.icon.wz(this.id);this.icon.initialize(this);this.icon.enableDragMap(!this.bEditable);if(S$85)this.paint()}};this.setLabel=function(F$1,S$85){if(typeof S$85!="boolean")S$85=true;if(this.label){this.label.remove();this.label=null}if(F$1){this.label=F$1;this.label.wz(this.id);this.label.initialize(this);if(S$85)this.paint()}};this.setShadow=function(O7h75,S$85){if(typeof S$85!="boolean")S$85=true;if(this.shadow){this.shadow.remove();this.shadow=null}if(O7h75){this.shadow=O7h75;this.shadow.wz(this.id);this.shadow.initialize(this);if(S$85)this.paint()}};this.setInfoWindow=function(DP8){if(this.info){if(avBubble.overlay&&avBubble.overlay.id==this.id&&ContentInfo&&ContentInfo.isVisible())this.maplet.hideBubble();this.info=null}if(DP8){this.info=DP8;this.info.setOverlay(this)}};this.setPoint=function(_U9,S$85){if(typeof S$85!="boolean")S$85=true;this.pt=_U9;if(avBubble.overlay&&avBubble.overlay.id==this.id)this.maplet.hideBubble();if(S$85)this.paint()};var Bo99S=null;var Es42g=function(){if(this.ls){var $2S=this.maplet.r9fhe;var rt=this.icon.getRect();if(rt.min.x==rt.max.x||rt.min.y==rt.max.y)return;var vj=0,vk=0;if(rt.min.x<$2S)vj=50;if(rt.min.y<$2S)vk=50;if(rt.max.x>this.maplet.width-$2S)vj=-50;if(rt.max.y+(this.dragAnimation?(this.maplet.Fqa.height+this.maplet.Fqa.offsetY):0)+2>this.maplet.height-$2S)vk=-50;if((vj!=0||vk!=0)){this.maplet.panTo(vj,vk);if(MEvent.contains(this,"draging")){var pt=null;if(this.dragAnimation){var Pq0i9=this.maplet.Fqa;pt=new MPoint(this.maplet.toMapCoordinate(U5402(Pq0i9.fC.div.style.left)+Pq0i9.width/2,U5402(Pq0i9.fC.div.style.top)+Pq0i9.height/2))}else pt=new MPoint(this.maplet.toMapCoordinate(this.x+this.icon.anchorX,this.y+this.icon.anchorY));pt.initialize(this.maplet);MEvent.trigger(this,"draging",this,pt)}return}}window.clearInterval(Bo99S);Bo99S=null};jc50=null;var S05V=function(){window.clearTimeout(jc50);this.maplet.Fqa.overlay=this;var yw=0,d=50;var Ili7Q={b:parseInt(this.icon.div.style.top),c:0};Ili7Q.c=this.pt.mapY-this.icon.anchorY-Ili7Q.b;var F9nB=null,f107=null;if(this.shadow){var F9nB={b:parseInt(this.shadow.div.style.left),c:0};F9nB.c=this.pt.mapX-this.shadow.anchorX-F9nB.b;var f107={b:parseInt(this.shadow.div.style.top),c:0};f107.c=this.pt.mapY-this.shadow.anchorY-f107.b}function _85d2(){if(yw<d){yw++;this.icon.update(this.maplet,this.pt.mapX,Math.ceil(N1hw$(yw,Ili7Q.b,Ili7Q.c,d))+this.icon.anchorY);if(this.shadow)this.shadow.update(this.maplet,Math.ceil(N1hw$(yw,F9nB.b,F9nB.c,d))+this.shadow.anchorX,Math.ceil(N1hw$(yw,f107.b,f107.c,d))+this.shadow.anchorY);jc50=getTimeout(this,_85d2,10)}else{this.maplet.T352(false)}};_85d2.apply(this)};this.o1a=function(){if(jc50){window.clearTimeout(jc50);jc50=null}this.paint()};var N1hw$=function(yw,b,c,d){if((yw/=d)<(1/2.75)){return c*(7.5625*yw*yw)+b}else if(yw<(2/2.75)){return c*(7.5625*(yw-=(1.5/2.75))*yw+.75)+b}else if(yw<(2.5/2.75)){return c*(7.5625*(yw-=(2.25/2.75))*yw+.9375)+b}else{return c*(7.5625*(yw-=(2.625/2.75))*yw+.984375)+b}}};var MPolyline=function(pts,brush,info,label,options){this.options=options||{};if(typeof this.options.editHilite!="boolean"){this.options.editHilite=true}this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"MPolyline";this.pts=pts;this.brush=(typeof brush=="undefined")?new MBrush():brush;this.info=null;if(typeof info!="undefined"&&info){this.info=info;this.info.setOverlay(this)}this.label=(typeof label=="undefined")?null:label;this.qo=false;this.wk=null;this.z9=null;this.um=new MContextMenu();this.un=new MContextMenuItem('\u5220\u9664\u8282\u70B9');this.um.addItem(this.un);this.contextmenu=null;this.pathNodeMenu=null;this.ao=new Array();this.et427=new Object();this.isRefreshMkIndex=REFRESH_MK_INDEX;this.to=this.tn=Number.MAX_VALUE;this.Ig4_q=this.K0xXM=-Number.MAX_VALUE;this.maplet=null;this.bEditable=false;this.kgB=false;this.D571g=false;this.N1g10=true;this.o$0=null;var u0I={yN:null,m49:{x:null,y:null},Pa57H:{x:null,y:null},n5N:{x:null,y:null}};this.Ife=[];var K12=[];this.creator=MLayer.USER;this.setEditable=function(enable){this.bEditable=(typeof enable!="boolean")?false:enable;if(!this.bEditable&&this.z9)this.dPm_();if(this.maplet!=null)this.update()};this.setEditMode=function(mode,_42){if(typeof _42!="boolean")_42=true;var lE10W=false;if(mode=="path"){lE10W=!this.traffic;this.traffic=true}else if(mode=="default"){lE10W=this.traffic;this.traffic=false}if(lE10W&&this.maplet)this.c_NJ();if(_42&&!this.bEditable)this.setEditable(true)};this.c_NJ=function(){if(!this.maplet)return;if(this.contextmenu)this.contextmenu.hide();if(this.pathNodeMenu)this.pathNodeMenu.hide();if(this.um)this.um.hide();MEvent.removeBuiltInListener(this.maplet.map,"mousedown",this.ao["mousedown"]);this.ao["mousedown"]=null;MEvent.removeBuiltInListener(this.maplet.map,"mouseup",this.ao["mouseup"]);this.ao["mouseup"]=null;this.update();if(!this.traffic){MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.ao["mousemove"][0]);MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.ao["mousemove"][1]);this.ao["mousemove"]=null;this.ao["mousemove"]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.f9);this.ao["mousedown"]=MEvent.bindDom(this.maplet.map,"mousedown",this,this.w0);this.ao["mouseup"]=MEvent.bindDom(this.maplet.map,"mouseup",this,this.l1);if(this.z9){this.z9.style.overflow="";this.z9.style.width="";this.z9.style.height="";this.z9.style.left="";this.z9.style.top=""}}else{MEvent.removeBuiltInListener(this.maplet.map,"mousemove",this.ao["mousemove"]);this.ao["mousemove"]=null;this.ao["mousedown"]=MEvent.bindDom(this.maplet.map,"mousedown",this,this.qiG9);this.ao["mouseup"]=MEvent.bindDom(this.maplet.map,"mouseup",this,this.Or8);this.ao["mousemove"]=[];this.ao["mousemove"][0]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.uG);this.ao["mousemove"][1]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.x1pJ);if(this.z9)this.z9.style.overflow="hidden"}};this.initialize=function(maplet,g7v){this.maplet=maplet;this.g7v=typeof g7v==='undefined'?true:false;if(typeof this.contextmenu=="object"&&this.contextmenu){if(!this.contextmenu.maplet)this.contextmenu.initialize(this.maplet);if(!this.contextmenu.containsOverlay(this))this.contextmenu.addOverlay(this)}if(this.pathNodeMenu){if(!this.pathNodeMenu.maplet)this.pathNodeMenu.initialize(this.maplet);if(!this.pathNodeMenu.containsOverlay(this))this.pathNodeMenu.addOverlay(this)}this.um.initialize(this.maplet);this.ao["click"]=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow);if(this.traffic){this.ao["mouseover"]=MEvent.bindDom(this.maplet.map,"mouseover",this,this.uG);this.ao["mousedown"]=MEvent.bindDom(this.maplet.map,"mousedown",this,this.qiG9);this.ao["mouseup"]=MEvent.bindDom(this.maplet.map,"mouseup",this,this.Or8);this.ao["mousemove"]=[];this.ao["mousemove"][0]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.uG);this.ao["mousemove"][1]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.x1pJ)}else{this.ao["mouseover"]=MEvent.bindDom(this.maplet.map,"mouseover",this,this.uG);this.ao["mousemove"]=MEvent.bindDom(this.maplet.map,"mousemove",this,this.f9);this.ao["mousedown"]=MEvent.bindDom(this.maplet.map,"mousedown",this,this.w0);this.ao["mouseup"]=MEvent.bindDom(this.maplet.map,"mouseup",this,this.l1)}if(typeof this.maplet.lA!="undefined"){this.paint()}};this.toString=function(){return 'com.mapbar.maplet.MPolyline'};this.zq=function(){return ""};this.zn=function(){if(apiType==1)return{brush:this.brush,points:this.pts};else{var xU=this.brush.filled?"2":"0";var xT=this.brush.stroke+","+xU+","+this.brush.color+":";for(var i=0;i<this.pts.length;i++)xT+=this.pts[i].getPid()+",";return xT}};this.paint=function(){this.zX=this.maplet.e61p4();if(!Uby5j){if(!this.z0){this.z0=document.createElement("v:shape");this.z0.style.width="1px";this.z0.style.height="1px";this.z0.coordsize="1,1";this.z0.unselectable="on";this.z0.id=this.id;this.z0.setAttribute("MStrName",this.toString());this.z0.strokecolor=this.brush.color;this.z0.strokeweight=this.brush.stroke+'px';this.z0.fill=this.brush.fill;this.z0.filled=this.brush.fill;this.z0.style.position="absolute";this.z0.contextmenu=this.contextmenu;pps(this.z0,_Fj3O,"true");pps(this.z0,N152,"polyline");pps(this.z0,"oid",this.id);this.Ad=document.createElement("v:stroke");this.Ad.opacity=parseInt(this.brush.stroke)==0?0:this.brush.transparency/100.0;this.Ad.joinstyle="round";this.Ad.endcap="round";this.Ad.fill=this.brush.fill;this.Ad.dashstyle=parseInt(this.brush.style)?"dash":"";this.zY=document.createElement("v:fill");this.zY.opacity=((this.brush.bgtransparency)/100);this.zY.color=this.brush.bgcolor;this.z0.appendChild(this.zY);this.z0.appendChild(this.Ad);this.zX.appendChild(this.z0);if(!this.brush.fill&&this.brush.overlap.enable){var _UV=this.brush.overlap;this.o$0=document.createElement("v:shape");this.o$0.style.width="1px";this.o$0.style.height="1px";this.o$0.coordsize="1,1";this.o$0.unselectable="on";this.o$0.strokecolor=_UV.color;this.o$0.strokeweight=(_UV.stroke&&!isNaN(_UV.stroke)?_UV.stroke:this.brush.stroke-2)+"px";this.o$0.fill=false;this.o$0.filled=false;this.o$0.style.position="absolute";pps(this.o$0,_Fj3O,"true");pps(this.o$0,N152,"polyline");pps(this.o$0,"oid",this.id);this.r58_=document.createElement("v:stroke");this.r58_.opacity=_UV.transparency/100.0;this.r58_.joinstyle="round";this.r58_.endcap="round";this.r58_.fill=false;this.r58_.endarrow=this.brush.arrow?"classic":"";this.r58_.dashstyle=parseInt(this.brush.style)?"dash":"";this.o$0.appendChild(this.r58_);this.zX.appendChild(this.o$0)}this.z0.onmouseover=MEvent.gm(this,K50);this.z0.onmouseout=MEvent.gm(this,c485);this.z0.onmousedown=MEvent.gm(this,Oj3j);this.z0.onmouseup=MEvent.gm(this,_2AP7);if(this.o$0){this.o$0.onmouseover=MEvent.gm(this,K50);this.o$0.onmouseout=MEvent.gm(this,c485);this.o$0.onmousedown=MEvent.gm(this,Oj3j);this.o$0.onmouseup=MEvent.gm(this,_2AP7)}}}else{this.z0=this.zX.firstChild;if(!this.Ad){this.Ad=document.createElementNS("http://www.w3.org/2000/svg","path");this.Ad.setAttribute("id",this.id);this.Ad.setAttribute("MStrName",this.toString());this.Ad.setAttribute("stroke-linejoin","round");this.Ad.setAttribute("stroke-linecap","round");this.Ad.setAttribute("stroke",this.brush.color);this.Ad.setAttribute("stroke-width",this.brush.stroke+"px");this.Ad.setAttribute("stroke-opacity",this.brush.transparency/100);this.Ad.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:3,15":"");this.Ad.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.Ad.setAttribute("fill",(this.brush.fill)?this.brush.bgcolor:"none");pps(this.Ad,_Fj3O,"true");pps(this.Ad,N152,"polyline");pps(this.Ad,"oid",this.id);if(!this.brush.fill&&this.brush.overlap.enable){var _UV=this.brush.overlap;this.o$0=document.createElementNS("http://www.w3.org/2000/svg","path");this.o$0.setAttribute("stroke-linejoin","round");this.o$0.setAttribute("stroke-linecap","round");this.o$0.setAttribute("stroke",_UV.color);this.o$0.setAttribute("stroke-width",(_UV.stroke&&!isNaN(_UV.stroke)?_UV.stroke:this.brush.stroke-2)+"px");this.o$0.setAttribute("stroke-opacity",_UV.transparency/100);this.o$0.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:3,15":"");this.o$0.setAttribute("fill","none");pps(this.o$0,_Fj3O,"true");pps(this.o$0,N152,"polyline");pps(this.o$0,"oid",this.id)}this.ao["vstroke_mouseover"]=MEvent.bindDom(this.Ad,"mouseover",this,K50);this.ao["vstroke_mouseout"]=MEvent.bindDom(this.Ad,"mouseout",this,c485);this.ao["vstroke_mousedown"]=MEvent.bindDom(this.Ad,"mousedown",this,Oj3j);this.ao["vstroke_mouseup"]=MEvent.bindDom(this.Ad,"mouseup",this,_2AP7);this.ao["vstroke_mousemove"]=MEvent.bindDom(this.Ad,"mousemove",this,C999);if(this.o$0){this.ao["overlapLine_mouseover"]=MEvent.bindDom(this.o$0,"mouseover",this,K50);this.ao["overlapLine_mouseout"]=MEvent.bindDom(this.o$0,"mouseout",this,c485);this.ao["overlapLine_mousedown"]=MEvent.bindDom(this.o$0,"mousedown",this,Oj3j);this.ao["overlapLine_mouseup"]=MEvent.bindDom(this.o$0,"mouseup",this,_2AP7);this.ao["overlapLine_mousemove"]=MEvent.bindDom(this.o$0,"mousemove",this,C999)}if(typeof this.contextmenu=="object"&&this.contextmenu){this.Ad.contextmenu=this.contextmenu}this.z0.appendChild(this.Ad);if(this.o$0)this.z0.appendChild(this.o$0)}}this.update()};var K50=function(e){var _UV=e.target;if(this.maplet.sS==ts.tz||this.maplet.sS==ts.tA||this.maplet.sS==ts.D57MH)this.maplet.q453("crosshair",_UV);else if(this.info||MEvent.contains(this,"click"))this.maplet.q453("pointer",_UV);else this.maplet.q453("default",_UV);if(e.type=="mouseover")MEvent.trigger(this,"mouseover",this)};var c485=function(e){if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("default",e.target);MEvent.trigger(this,"mouseout",this)};var Oj3j=function(e){if(!px){this.kgB=true;this.D571g=false}if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("move",e.target)};var _2AP7=function(e){if(!px)this.kgB=false;K50.apply(this,[e])};var C999=function(e){if(this.kgB&&!this.D571g)this.D571g=true};this.setContextMenu=function(menu){this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet)this.contextmenu.initialize(this.maplet);if(!this.contextmenu.containsOverlay(this))this.contextmenu.addOverlay(this)}else if(!menu){this.removeContextMenu()}};this.getContextMenu=function(dom){if(!dom)return null;if(typeof dom.id=="string"&&dom.id.indexOf("traffic")!=-1&&this.traffic)return this.pathNodeMenu;else return this.contextmenu};this.setPathNodeMenu=function(menu){this.pathNodeMenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.pathNodeMenu.maplet)this.pathNodeMenu.initialize(this.maplet);if(!this.pathNodeMenu.containsOverlay(this))this.pathNodeMenu.addOverlay(this)}else if(!menu){this.removePathNodeMenu()}};this.removePathNodeMenu=function(){if(this.pathNodeMenu){this.pathNodeMenu.removeOverlay(this);this.pathNodeMenu=null}};this.setBrush=function(pH24y){if(!(pH24y instanceof MBrush))return;this.brush=pH24y;if(!Uby5j){if(this.z0&&this.Ad&&this.zY){this.z0.strokecolor=pH24y.color;this.z0.strokeweight=pH24y.stroke+'px';this.Ad.opacity=parseInt(pH24y.stroke)==0?0:pH24y.transparency/100.0;this.Ad.fill=pH24y.fill;this.Ad.endarrow=pH24y.arrow?"classic":"none";this.Ad.dashstyle=parseInt(pH24y.style)?"dash":"";this.zY.opacity=((pH24y.bgtransparency)/100);this.zY.color=pH24y.bgcolor}}else{if(this.arrow){this.arrow.setAttribute("fill",pH24y.color);this.arrow.setAttribute("fill-opacity",pH24y.bgtransparency/100+0.3)}if(this.Ad){this.Ad.setAttribute("marker-end",pH24y.arrow?"url(#svgArrow)":"");this.Ad.setAttribute("stroke",pH24y.color);this.Ad.setAttribute("stroke-width",pH24y.stroke+"px");this.Ad.setAttribute("stroke-opacity",pH24y.transparency/100);this.Ad.setAttribute("style",parseInt(pH24y.style)?"stroke-dasharray:10,15":"");this.Ad.setAttribute("fill-opacity",pH24y.bgtransparency/100);this.Ad.setAttribute("fill",(pH24y.fill)?pH24y.bgcolor:"none")}}if(this.brush.fill!=pH24y.fill)this.update()};this.setInfoWindow=function(DP8){if(this.info){if(avBubble.overlay&&avBubble.overlay.id==this.id&&ContentInfo&&ContentInfo.isVisible())this.maplet.hideBubble();this.info=null}if(DP8){this.info=DP8;this.info.setOverlay(this)}};this.setPoints=function(pts){this.pts=pts;if(this.maplet)this.update()};this.v4_H4=function(Aa){if(this.z0&&Aa&&Aa.length>0){var d828=Math.max(this.K0xXM-this.tn,this.Ig4_q-this.to),b_t51=parseInt(this.brush.stroke)*3,dXpO5=parseInt(this.brush.overlap.stroke)*3;if(!Uby5j){_removeNode(document.getElementById("fix_id"));var s=document.createElement("script");s.id="fix_id";document.body.insertBefore(s,document.body.firstChild);this.z0.style.display="none";this.z0.path=Aa.join(" ")+" e";this.z0.style.display="";if(this.o$0){this.o$0.style.display="none";this.o$0.path=Aa.join(" ")+" e";this.o$0.style.display=""}if(this.g7v){if(this.Ad){this.Ad.endarrow='none';var _bU7=d828+parseInt(this.brush.stroke);if(b_t51<_bU7&&this.brush.arrow){(!this.brush.fill)&&(this.Ad.endarrow='classic')}}if(this.r58_){this.r58_.endarrow='none';var _bU7=d828+parseInt(this.brush.overlap.stroke);if(dXpO5<_bU7&&this.brush.arrow){(!this.brush.fill)&&(this.r58_.endarrow='classic')}}}}else{var EA4=this;if(this.Ad){this.Ad.setAttribute("d",Aa.join(" "));if(px){o110(this.Ad,'marker-end')}else{EA4.Ad.setAttribute("marker-end","")}var _bU7=d828+parseInt(this.brush.stroke);if(b_t51<_bU7&&Aa[0].indexOf('L')>-1&&this.brush.arrow){window.setTimeout(function(){(!EA4.brush.fill)&&EA4.Ad&&EA4.Ad.setAttribute("marker-end","url(#svgArrow)")},0)}}if(this.o$0){this.o$0.setAttribute("d",Aa.join(" "));if(px){o110(this.o$0,'marker-end')}else{EA4.o$0.setAttribute("marker-end","")}var _bU7=d828+parseInt(this.brush.overlap.stroke);if(dXpO5<_bU7&&Aa[0].indexOf('L')>-1&&this.brush.arrow){window.setTimeout(function(){(!EA4.brush.fill)&&EA4.o$0&&EA4.o$0.setAttribute("marker-end","url(#svgArrow)")},0)}}}}};this.update=function(){this.z9=document.getElementById(this.id+"vNodeLayer");if(this.bEditable||this.maplet.sS==ts.tu){if((!this.traffic||(this.traffic&&!this.qo))&&this.z9){this.dPm_()}if(!this.z9){this.z9=document.createElement("div");this.z9.id=this.id+"vNodeLayer";this.z9.style.position="absolute";this.z9.style.display="none";this.z9.unselectable="on";this.z9.style.zIndex=1;this.zX.appendChild(this.z9)}if(this.traffic){var y7W6=document.getElementById(this.id+"_node_traffic");if(y7W6==null){y7W6=document.createElement("IMG");y7W6.style.width=CTLIMG_RESOURCE[0].w+"px";y7W6.style.height=CTLIMG_RESOURCE[0].h+"px";if(i639){y7W6.src=sX;y7W6.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);"}else{y7W6.src=CTLIMG_RESOURCE[0].url}y7W6.id=this.id+"_node_traffic";y7W6.style.position="absolute";y7W6.unselectable="on";y7W6.alt=lt;y7W6.title=lt;y7W6.style.left="-65px";y7W6.style.top="-112px";y7W6.D7o="no";y7W6.style.cursor="pointer";y7W6.onmousedown=function(){return false};pps(y7W6,"oid",this.id);this.z9.style.width="11px";this.z9.style.height="11px";this.z9.style.overflow="hidden";this.z9.appendChild(y7W6)}if(!this.qo)this.z9.style.display="none"}}vg72C.apply(this);this.aP=[];this.aR=[];var us=10;if(this.pts==null||this.pts.length<=0){return}var cY=false;var tn=this.maplet.width;var to=this.maplet.height;this.tn=Number.MAX_VALUE;this.to=this.tn;this.K0xXM=-Number.MAX_VALUE;this.Ig4_q=this.K0xXM;this.Ife=[];var b0R={min:{x:-this.maplet.width,y:-this.maplet.height},max:{x:this.maplet.width*2,y:this.maplet.height*2}};var gF=null,tS47=null;var pts=[];var pn=[];for(var qC=0;qC<this.pts.length;qC++){var pt=this.pts[qC];if(pt.inLevelRange(this.maplet.AG)){pts.push(pt);pn.push(qC)}}for(var qC=0;qC<pts.length;qC++){var pt=pts[qC];if(!pt.getPid()){continue}if(!pt.maplet)pt.initialize(this.maplet);if(this.maplet._67R){if(this.maplet.O71Wl!=pt.O71Wl){pt.mapX+=U5402(this.maplet.tJW3);pt.mapY+=U5402(this.maplet.R8G);pt.O71Wl=this.maplet.O71Wl}}else{pt.recalcScreenCoords()}var M9f=pts[(qC==pts.length-1)?qC:qC+1];if(!M9f.maplet)M9f.initialize(this.maplet);if(this.maplet._67R){if(this.maplet.O71Wl!=M9f.O71Wl){M9f.mapX+=U5402(this.maplet.tJW3);M9f.mapY+=U5402(this.maplet.R8G);M9f.O71Wl=this.maplet.O71Wl}}else{M9f.recalcScreenCoords()}this.aP.push(pt.mapX);this.aR.push(pt.mapY);this.tn=Math.min(this.tn,pt.mapX);this.to=Math.min(this.to,pt.mapY);this.K0xXM=Math.max(this.K0xXM,pt.mapX);this.Ig4_q=Math.max(this.Ig4_q,pt.mapY);var TErp={c18:{x:pt.mapX,y:pt.mapY},Fj0:{x:M9f.mapX,y:M9f.mapY}};var GaqL7=!this.brush.fill?Vb12a(TErp,b0R):true;if(GaqL7){if(!gF){gF=[TErp.c18];tS47=TErp.c18}else if(TErp.c18.x!=tS47.x||TErp.c18.y!=tS47.y){gF.push(TErp.c18);tS47=TErp.c18}if(TErp.Fj0.x!=tS47.x||TErp.Fj0.y!=tS47.y){gF.push(TErp.Fj0);tS47=TErp.Fj0}}if((!GaqL7&&gF)||(TErp.Fj0.x!=M9f.mapX||TErp.Fj0.y!=M9f.mapY)){if(gF.length>=2)this.Ife.push(gF);gF=null;tS47=null}}if(gF){if(this.g7v&&gF.length==1){var E_0yQ=gF[0].x;var D3UI=gF[0].y;gF.push({x:E_0yQ,y:D3UI})}if(gF.length>=2)this.Ife.push(gF);gF=null;tS47=null}var Aa=[];if(this.Ife.length>0){for(var i=0;i<this.Ife.length;i++){var zh=[];var pt=null;for(var qC=0;qC<this.Ife[i].length;qC++){pt=this.Ife[i][qC];if(qC!=0)zh.push(pt.x+","+pt.y)}pt=this.Ife[i][0];Aa.push("M"+pt.x+","+pt.y+" L"+zh.join(!Uby5j?",":" L"))}if(this.brush.fill&&this.g7v){Aa.push(Uby5j?'Z':'x')}}else{Aa.push('M0,0')}tS47=null;for(var i=0;i<this.aP.length;i++){var x=this.aP[i];var y=this.aR[i];if((this.bEditable||this.maplet.sS==ts.tu)&&!this.traffic){var r=us+1;if(tS47)r=Math.abs(x-tS47.x)+Math.abs(y-tS47.y);if(x>0&&x<this.maplet.width&&y>0&&y<this.maplet.height&&r>us){var z7=document.getElementById(this.id+"_node_"+i);if(z7==null){z7=new Image();z7.id=this.id+"_node_"+i;z7.qf=i;z7.qk=pn[i];z7.src=ul;z7.unselectable="on";z7.alt=lt;z7.title=lt;z7.style.position="absolute";z7.xSi=this;z7.onmousedown=function(){return false};if(this.pts.length>2){z7.contextmenu=this.um}}z7.style.left=(x-5)+"px";z7.style.top=(y-5)+"px";this.z9.appendChild(z7);tS47={x:x,y:y}}var xR0x=0,D740=0;if(r>us){if(i==0){if(this.brush.fill){xR0x=(x+this.aP[this.aP.length-1])/2-5;D740=(y+this.aR[this.aP.length-1])/2-5}else{continue}}else{xR0x=(x+this.aP[i-1])/2-5;D740=(y+this.aR[i-1])/2-5}}if(Math.abs(xR0x-x)<20&&Math.abs(D740-y)<20){continue}x=xR0x;y=D740;if(x>0&&x<this.maplet.width&&y>0&&y<this.maplet.height){var z8=document.getElementById(this.id+"_midnode_"+i);if(z8==null){z8=new Image();z8.id=this.id+"_midnode_"+i;z8.qf=i;z8.qk=pn[i];z8.unselectable="on";z8.src=ul;z8.alt=lt;z8.title=lt;z8.style.position="absolute";z8.style.filter="alpha(opacity=60);";z8.style.MozOpacity=0.6;z8.style.opacity=0.6;z8.onmousedown=function(){return false}}z8.style.left=x+"px";z8.style.top=y+"px";this.z9.appendChild(z8)}}};this.v4_H4(Aa);var Tp0=this.options.dirmark;if(this.maplet.AG>=Tp0.minLevel&&this.maplet.AG<=Tp0.maxLevel){for(var i=1;i<pn.length;i++){if(typeof Tp0.v725[pn[i]]=="undefined")continue;if(pn[i]==this.pts.length-1)break;var pt=pts[i];if(pt.mapX>0&&pt.mapX<this.maplet.width&&pt.mapY>0&&pt.mapY<this.maplet.height){var c=1,a58l5=pts[i-c];while(pt.mapX==a58l5.mapX&&pt.mapY==a58l5.mapY&&(i-(c+1))>=0){a58l5=pts[i-(++c)]}if(pt.mapX==a58l5.mapX&&pt.mapY==a58l5.mapY)continue;JGJ.apply(this,[a58l5.mapX,a58l5.mapY,pt.mapX,pt.mapY])}}}if(this.isRefreshMkIndex&&!(this.maplet.sS==ts.tb||this.maplet.sS==ts.ta||this.maplet.sS==ts.lz||this.maplet.sS==ts.ly))this.refreshMarkerZIndex()};this.refreshMarkerZIndex=function(){if(!this.c15S()||!this.maplet)return;var D50_8=this.maplet.getMarkersInPolygon(this);var OtE5=new Object();if(D50_8.length>0){for(var i=0;i<D50_8.length;i++){if(this.bEditable&&!D50_8[i].bEditable){D50_8[i].setZIndex(-1)}else if(D50_8[i].icon&&D50_8[i].icon.div.style.zIndex<0){D50_8[i].e4501()}OtE5[D50_8[i].id]=D50_8[i]}}for(var qC in this.et427){if(!OtE5[this.et427[qC].id]){if(typeof this.et427[qC].e4501=="function"){this.et427[qC].e4501()}}}this.et427=OtE5};this.c15S=function(){if(!this.Ad)return false;return this.Ad.getAttribute("fill")!="none"||this.Ad.getAttribute("fill")==eval(true)};this.$98$s=function(YTW){if(!this.et427[YTW.id])this.et427[YTW.id]=YTW};this.dPm_=function(){if(this.z9){var UI4=this.z9.childNodes;for(var i=0;i<UI4.length;i++){UI4[i].onmousedown=null;UI4[i].contextmenu=null;UI4[i].xSi=null}_removeNode(this.z9);this.z9=null}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.c15S()&&this.bEditable){this.bEditable=false;this.refreshMarkerZIndex();if(!finalize)this.bEditable=true}if(px){if(this.z0){this.z0.onmouseover=null;this.z0.onmouseout=null;this.z0.onmousedown=null;this.z0.onmouseup=null}if(this.o$0){this.o$0.onmouseover=null;this.o$0.onmouseout=null;this.o$0.onmousedown=null;this.o$0.onmouseup=null}}for(var l8 in this.ao){if(l8.substring(0,8)=="vstroke_"){if(this.Ad)MEvent.removeBuiltInListener(this.Ad,l8.substring(8),this.ao[l8])}else if(l8.substring(0,10)=="vpolyline_"){if(this.z0)MEvent.removeBuiltInListener(this.z0,l8.substring(10),this.ao[l8])}else if(l8.substring(0,12)=="overlapLine_"){if(this.o$0)MEvent.removeBuiltInListener(this.o$0,l8.substring(12),this.ao[l8])}else{if(this.maplet){var _04=this.ao[l8];if(I41(_04)){for(var i=0;i<_04.length;i++)MEvent.removeBuiltInListener(this.maplet.map,l8,_04[i])}else{MEvent.removeBuiltInListener(this.maplet.map,l8,_04)}}}this.ao[l8]=null;if(finalize)delete this.ao[l8]}if(finalize){this.ao=null;this.removeContextMenu();if(this.um){this.um.remove(true);this.um=null}}vg72C.apply(this);if(typeof this.o$0=="object"&&this.o$0){_removeNode(this.o$0);this.o$0=null}if(!Uby5j){if(typeof this.z0=="object"&&this.z0){_removeNode(this.z0);this.z0=null}}else{if(typeof this.Ad=="object"&&this.Ad){_removeNode(this.Ad);this.Ad=null}}if(this.maplet){if(this.maplet.No1==this)this.maplet.No1=null;if(this.maplet.u5[this.id]){this.maplet.u5[this.id]=null;delete this.maplet.u5[this.id]}}this.dPm_();if(finalize)this.maplet=null};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.getCenterXY=function(){var xR0x=0;var D740=0;if(this.brush.fill){xR0x=this.tn+(this.K0xXM-this.tn)/2;D740=this.to+(this.Ig4_q-this.to)/2}else if(this.maplet){var pn=Math.ceil(this.aP.length/2)-(this.aP.length%2);if(pn<this.aP.length){xR0x=this.aP[pn];D740=this.aR[pn]}}return{x:xR0x,y:D740}};this.getCenterPt=function(){if(this.tn!=Number.MAX_VALUE&&this.maplet){var MfS=this.getCenterXY();var pt=new MPoint(this.maplet.toMapCoordinate(MfS.x,MfS.y));pt.initialize(this.maplet);return pt}else{return null}};this.getPointsByLevelGroup=function(H8v15,q0J6_){var N7k=[];H8v15=U5402(H8v15);H8v15=Math.max(Math.min(H8v15,this.pts.length-1),0);q0J6_=U5402(q0J6_,this.pts.length-1);q0J6_=Math.max(Math.min(q0J6_,this.pts.length-1),0);var pt=this.pts[H8v15];pt.levelGroup=3;N7k.push(pt);for(var i=H8v15+1;i<q0J6_;i++){if(this.pts[i].inLevelRange(this.maplet.AG)){pt=this.pts[i];pt.levelGroup=3;N7k.push(pt)}}var pt=this.pts[q0J6_];pt.levelGroup=3;N7k.push(pt);return N7k};this.openInfoWindow=function(e){if(this.maplet){if(typeof e!="undefined"&&(e.target.id==this.id||e.target==this.o$0)&&this.maplet.B076){this.maplet.B076=false;if(this.maplet.Su15||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this))return}if(this.maplet.sS!=ts.ty&&this.maplet.sS!=ts.tu)return;if(this.info&&!this.info.getOverlay())this.info.setOverlay(this);if(typeof e=="undefined"){if(this.info!=null&&this.pts.length>=2){var h209j=this.getCenterXY();var xR0x=h209j.x;var D740=h209j.y;if(xR0x>=this.maplet.width*1.5||xR0x<=-(this.maplet.width/2)||D740<=-(this.maplet.height/2)||D740>=this.maplet.height*1.5){this.maplet.setCenter(new MPoint(this.maplet.toMapCoordinate(xR0x,D740)));xR0x=this.maplet.width/2;D740=this.maplet.height/2}if(iToolTipStyle==2){this.x=xR0x;this.y=D740;MEvent.trigger(this,"click",this)}else{this.maplet.wN(xR0x,D740,this.info,"","",true)}}}else if((e.target.id==this.id||e.target==this.o$0)&&!this.maplet.B076){var x=e.clientX-this.maplet.offsetX-this.maplet.left;var y=e.clientY-this.maplet.offsetY-this.maplet.top;if(iToolTipStyle==2){this.x=x;this.y=y;MEvent.trigger(this,"click",this)}else{if(MEvent.contains(this,"click")>0){with(this.maplet){var qa7E=e.clientX-offsetX-left;var Lf4=e.clientY-offsetY-top;var l137=cq.zn(zp(qa7E,Lf4),zo(qa7E,Lf4))}if(apiType==1){var pt=new MPoint(l137);pt.initialize(this.maplet);MEvent.trigger(this,'click',this,e,pt)}else MEvent.trigger(this,'click',this,e,l137)}if(this.info){if(!this.info.getOverlay())this.info.setOverlay(this);this.maplet.wN(x,y,this.info,false);avBubble.v1_In=true}}}}};this.wQ=function(fg){if(this.z9!=null){if(fg){this.z9.style.display="block";this.z9.style.zIndex=10;this.maplet.No1=this}else{this.z9.style.display="none";this.z9.style.zIndex=0;this.maplet.No1=null}}};this.uG=function(e){if(!this.maplet)return;if(this.maplet.sS==ts.tb||this.maplet.sS==ts.ta||this.maplet.sS==ts.lz||this.maplet.sS==ts.ly||this.maplet.cN){return}if(this.traffic){if((this.bEditable||this.maplet.sS==ts.tu)&&!this.qo&&(!this.maplet.No1||this.maplet.No1==this)&&!this.ls){if(typeof e.target.getAttribute=="function"&&e.target.getAttribute(N152)=="marker"){this.wQ(false);return}var Mc77=this.F9K76([e.clientX-this.maplet.offsetX,e.clientY-this.maplet.offsetY],this.Ife);if(this.zX!=null&&this.maplet&&Mc77!=null||fJ(e.target,this.z9)){this.wQ(true);var KFlec={x:-10,y:-10};if(Mc77!=null&&this.maplet){KFlec=this.o67Ic(Mc77[0],Mc77[1],[e.clientX-this.maplet.offsetX,e.clientY-this.maplet.offsetY]);this.Mc77=Mc77;if(px)this.z0.style.cursor="pointer";else this.Ad.style.cursor="pointer"}else{if(px)this.z0.style.cursor="default";else this.Ad.style.cursor="default"}this.e7$60=true;clearTimeout(this.EQHs);this.EQHs=null;var dODV0=[0,0];switch(this._10b5){case 1:dODV0=[0,1];break;case 2:dODV0=[1,0];break;case 3:dODV0=[1,1];break;case 4:dODV0=[0,0];break;default:dODV0=[0,0];break}this.z9.style.left=(KFlec.x-(px?(5+dODV0[0]):5))+"px";this.z9.style.top=(KFlec.y-(px?(5+dODV0[1]):5))+"px"}else{if(px)this.z0.style.cursor="default";else this.Ad.style.cursor="default";if(this.z9!=null&&this.z9.style.display=="none")return;if(this.EQHs!=null)return;this.e7$60=false;this.EQHs=getTimeout(this,function(){if(this.e7$60)return;if(this.z9!=null&&this.z9.style.display=="none")return;this.wQ(false);clearTimeout(this.EQHs);this.EQHs=null},500)}}else if(this.qo){this.x1pJ(e)}}else{if(this.bEditable||this.maplet.sS==ts.tu){if(this.ls||this.zX&&this.maplet&&fJ(e.target,Uby5j?this.Ad:this.z0)||fJ(e.target,this.z9)||fJ(e.target,this.o$0)||e.target.getAttribute(N152)=="linemarker"){if(this.options.editHilite){if(px){this.Ad.opacity=parseInt(this.brush.stroke)==0?0:1}else{this.Ad.setAttribute("stroke-opacity",1)}}this.wQ(true)}else{if(this.options.editHilite){if(px){this.Ad.opacity=parseInt(this.brush.stroke)==0?0:this.brush.transparency/100.0}else{this.Ad.setAttribute("stroke-opacity",this.brush.transparency/100.0)}}this.wQ(false)}}}};this.w0=function(e){if(this.zX!=null&&this.maplet&&(!Uby5j&&e.button==1||Uby5j&&e.button==0)&&(this.bEditable||this.maplet.sS==ts.tu)&&(fJ(e.target,!Uby5j?this.z9:this.Ad)||Uby5j&&fJ(e.target,this.z9))&&e.target.id.indexOf("node")!=-1){this.qo=true;this.maplet.l6=e.target.id;this.l0=(px||bN9I)?e.offsetX:e.layerX;this.na=(px||bN9I)?e.offsetY:e.layerY;bx06f=e.target;if(this.wk==null){if(!Uby5j){this.wk=document.createElement("v:shape");this.wk.style.width="1px";this.wk.style.height="1px";this.wk.coordsize="1,1";this.wk.unselectable="on";this.wk.id=this.id;this.wk.strokecolor=this.brush.color;this.wk.strokeweight=this.brush.stroke+'px';this.wk.fill=this.brush.fill;this.wk.filled=this.brush.fill;this.wk.style.position="absolute";this.Ac=document.createElement("v:stroke");this.Ac.opacity=parseInt(this.brush.stroke)==0?0:1;this.Ac.joinstyle="round";this.Ac.endcap="round";this.Ac.fill=this.brush.fill;this.Ac.dashstyle="dash";var Ab=document.createElement("v:fill");Ab.opacity=((this.brush.bgtransparency)/100);Ab.color=this.brush.bgcolor;this.wk.appendChild(Ab)}else{this.wk=document.createElementNS("http://www.w3.org/2000/svg","svg");this.wk.setAttribute("version","1.1");this.wk.setAttribute("overflow","visible");this.wk.setAttribute("viewBox","0 0 "+this.maplet.width+" "+this.maplet.height);this.wk.setAttribute("height",this.maplet.height+"px");this.wk.setAttribute("width",this.maplet.width+"px");this.wk.setAttribute("unselectable","on");this.Ac=document.createElementNS("http://www.w3.org/2000/svg","path");this.Ac.setAttribute("MStrName",this.toString());this.Ac.setAttribute("stroke-linejoin","round");this.Ac.setAttribute("stroke-linecap","round");this.Ac.setAttribute("stroke",this.brush.color);this.Ac.setAttribute("stroke-width",this.brush.stroke+"px");this.Ac.setAttribute("stroke-opacity",1);this.Ac.setAttribute("style","stroke-dasharray:10,15");this.Ac.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.Ac.setAttribute("fill",(this.brush.fill)?this.brush.bgcolor:"none");if(this.brush.arrow){this.arrow=document.createElementNS("http://www.w3.org/2000/svg","path");this.arrow.setAttribute("d",px?"M 0 0 L 40 20 L 0 40 L 16 20 Z":"M 0 0 L 10 5 L 0 10 L 4 5 z");this.arrow.setAttribute("fill",this.brush.color);this.arrow.setAttribute("fill-opacity",this.brush.bgtransparency/100+0.3);this.zY=document.createElementNS("http://www.w3.org/2000/svg","marker");this.zY.setAttribute("id","arrow"+this.id);this.zY.setAttribute("viewBox",px?"0 0 40 40":"0 0 10 10");this.zY.setAttribute("refX",px?"24":"6");this.zY.setAttribute("refY",px?"20":"5");this.zY.setAttribute("markerUnits","strokeWidth");this.zY.setAttribute("orient","auto");this.zY.appendChild(this.arrow);this.wk.appendChild(this.zY)}}}this.wk.appendChild(this.Ac);this.zX.appendChild(this.wk)}};this.f9=function(e){if(bx06f!=null&&(this.bEditable||this.maplet.sS==ts.tu)&&bx06f.id.indexOf("node")>0&&this.qo){if(bx06f!=null){if(avBubble.overlay&&avBubble.overlay.id==this.id)this.maplet.hideBubble();var x=e.clientX-this.maplet.offsetX-this.maplet.left-this.l0;var y=e.clientY-this.maplet.offsetY-this.maplet.top-this.na;bx06f.style.left=(parseInt(x))+"px";bx06f.style.top=(parseInt(y))+"px";this.lw=new Date().getTime();this.ls=true;var ps=parseInt(bx06f.qf);var XWd,X83b0;var Aa="M";XWd=(ps==0)?(this.aP.length-1):(ps-1);if(bx06f.id.indexOf("_midnode_")>0){Aa+=this.aP[XWd]+','+this.aR[XWd]+' L'+(x+5)+','+(y+5);Aa+=(!Uby5j?",":"L")+this.aP[ps]+','+this.aR[ps]}else{X83b0=(ps==this.aP.length-1)?(0):(ps+1);if(ps==0){if(this.brush.fill){Aa+=this.aP[XWd]+','+this.aR[XWd]+' L'+(x+5)+','+(y+5)+(!Uby5j?",":" L")}else{Aa+=(x+5)+','+(y+5)+' L'}}else{Aa+=this.aP[XWd]+','+this.aR[XWd]+' L'+(x+5)+','+(y+5)+(!Uby5j?",":" L")}if(ps<this.aP.length-1||this.brush.fill){Aa+=this.aP[X83b0]+','+this.aR[X83b0]}}if(this.wk!=null){if(!Uby5j){this.wk.path=Aa}else if(this.wk.points){this.wk.points.value=Aa}else{this.Ac.setAttribute("d",Aa)}}}}};this.l1=function(e){if(this.zX!=null&&this.maplet&&(this.bEditable||this.maplet.sS==ts.tu)&&this.qo){if(bx06f!=null&&this.ls){var x=parseInt(e.clientX)-parseInt(this.maplet.offsetX)-parseInt(this.maplet.left)-this.l0;var y=parseInt(e.clientY)-parseInt(this.maplet.offsetY)-parseInt(this.maplet.top)-this.na;var ps=U5402(bx06f.qk);var e3S=new MPoint(this.maplet.toMapCoordinate(x+5,y+5));if(bx06f.id.indexOf("_midnode_")>0)this.pts.splice(ps,0,e3S);else this.pts.splice(ps,1,e3S);this.lw=new Date().getTime();this.ls=false;bx06f=null;this.update();MEvent.trigger(this,"drag",this,e3S);MEvent.trigger(this.maplet,"edit",this,e3S)}this.qo=false;if(this.wk.parentNode!=null){_removeNode(this.wk);this.wk=null}}if(this.maplet&&this.maplet.l6==this.id){this.maplet.l6=null}};this.removeNode=function(MGi,menu,overlay){var qf=menu.D8$27;if(typeof qf!="undefined"){if(qf.toString().indexOf(this.id)>=0&&qf.toString().lastIndexOf("_")>=0){qf=qf.toString().substring(qf.toString().lastIndexOf("_")+1)}qf=parseInt(qf);if(!isNaN(qf)&&qf<this.pts.length){this.pts.splice(qf,1);MEvent.trigger(this,"edit",this);MEvent.trigger(this.maplet,"edit",this);if(this.wk!=null&&this.wk.parentNode!=null){_removeNode(this.wk);this.wk=null}this.update()}}};MEvent.bind(this.un,"select",this,this.removeNode);this.M598=function(n14,Tkq_3,nc,V6Et_){this.qv934=function(I2QN_){var fGav1=Math.atan2(Tkq_3-I2QN_.E077,n14-I2QN_.$13We)-I2QN_.GJB;var rleY=Math.atan2(V6Et_-I2QN_.E077,nc-I2QN_.$13We)-I2QN_.GJB;while(fGav1<0)fGav1+=2*Math.PI;while(rleY<0)rleY+=2*Math.PI;while(fGav1>2*Math.PI)fGav1-=2*Math.PI;while(rleY>2*Math.PI)rleY-=2*Math.PI;return(fGav1-Math.PI)*(rleY-Math.PI)<0&&(fGav1>Math.PI?2*Math.PI-fGav1:fGav1)+(rleY>Math.PI?2*Math.PI-rleY:rleY)<Math.PI}};this.J$2b5=function($13We,E077,GJB){this.$13We=$13We;this.E077=E077;this.GJB=GJB};this.r8q72=function(Tax6$){var v6=null;var LvBj=parseInt(Tax6$[0].x);var DU03=parseInt(Tax6$[0].y);var d$0S=parseInt(Tax6$[1].x);var Ty4oy=parseInt(Tax6$[1].y);var Ds84=Math.abs(LvBj-d$0S);var L04_=Math.abs(DU03-Ty4oy);var imA8=parseInt(this.brush.stroke);var g4=imA8*L04_/Math.sqrt(Math.pow(Ds84,2)+Math.pow(L04_,2));var g5=g4*Ds84/L04_;var KW1N=4;this._10b5=0;if(LvBj==d$0S){this._10b5=1;v6=[[LvBj-imA8-KW1N,DU03],[LvBj+imA8+KW1N,DU03],[d$0S+imA8+KW1N,Ty4oy],[d$0S-imA8-KW1N,Ty4oy]]}else if(DU03==Ty4oy){this._10b5=2;v6=[[LvBj,DU03+imA8+KW1N],[d$0S,Ty4oy+imA8+KW1N],[d$0S,Ty4oy-imA8-KW1N],[LvBj,DU03-imA8-KW1N]]}else if(DU03<Ty4oy&&LvBj<d$0S){this._10b5=3;v6=[[parseInt(LvBj-g4-KW1N),parseInt(DU03+g5+KW1N)],[parseInt(d$0S-g4-KW1N),parseInt(Ty4oy+g5+KW1N)],[parseInt(d$0S+g4+KW1N),parseInt(Ty4oy-g5-KW1N)],[parseInt(LvBj+g4+KW1N),parseInt(DU03-g5-KW1N)]]}else if(DU03>Ty4oy&&LvBj<d$0S){this._10b5=4;v6=[[parseInt(LvBj-g4-KW1N),parseInt(DU03-g5-KW1N)],[parseInt(d$0S-g4-KW1N),parseInt(Ty4oy-g5-KW1N)],[parseInt(d$0S+g4+KW1N),parseInt(Ty4oy+g5+KW1N)],[parseInt(LvBj+g4+KW1N),parseInt(DU03+g5+KW1N)]]}else if(DU03>Ty4oy&&LvBj>d$0S){this._10b5=3;v6=[[parseInt(LvBj-g4-KW1N),parseInt(DU03+g5+KW1N)],[parseInt(LvBj+g4+KW1N),parseInt(DU03-g5-KW1N)],[parseInt(d$0S+g4+KW1N),parseInt(Ty4oy-g5-KW1N)],[parseInt(d$0S-g4-KW1N),parseInt(Ty4oy+g5+KW1N)]]}else if(DU03<Ty4oy&&LvBj>d$0S){this._10b5=4;v6=[[parseInt(LvBj-g4-KW1N),parseInt(DU03-g5-KW1N)],[parseInt(LvBj+g4+KW1N),parseInt(DU03+g5+KW1N)],[parseInt(d$0S+g4+KW1N),parseInt(Ty4oy+g5+KW1N)],[parseInt(d$0S-g4-KW1N),parseInt(Ty4oy-g5-KW1N)]]}return v6};this.veG=[];this._3C=function(_6AK3,Tax6$){var ub=this.r8q72(Tax6$);for(var i=0;i<ub.length;i++){this.veG.push(new this.M598(ub[i][0],ub[i][1],ub[(i+1)%ub.length][0],ub[(i+1)%ub.length][1]))}var Dj02m=new this.J$2b5(_6AK3[0],_6AK3[1],parseFloat("0.523112313123"));var p85X7=0;for(var qC=0;qC<this.veG.length;qC++){if(this.veG[qC].qv934(Dj02m))p85X7++}this.veG=[];return p85X7%2!=0};this.F9K76=function(coords,Ife){for(var i=0;i<Ife.length;i++){var TErp=Ife[i];for(var qC=0;qC<TErp.length-1;qC++){var c18=TErp[qC];var Fj0=TErp[qC+1];if(this._3C(coords,[c18,Fj0])){return [c18,Fj0]}}}return null};this.o67Ic=function(c18,Fj0,Jb31){var qV47=[Fj0.x-c18.x,Fj0.y-c18.y];var PG1W=[parseInt(Jb31[0])-c18.x,parseInt(Jb31[1])-c18.y];var jg4=PG1W[0]*qV47[0]+PG1W[1]*qV47[1];if(jg4<=0)return c18;var q96Y3=qV47[0]*qV47[0]+qV47[1]*qV47[1];if(q96Y3<=jg4)return Fj0;return{x:c18.x+qV47[0]*jg4/q96Y3,y:c18.y+qV47[1]*jg4/q96Y3}};this.qiG9=function(e){if(this.zX!=null&&this.maplet&&(px&&e.button==1||!px&&e.button==0)&&(this.bEditable||this.maplet.sS==ts.tu)&&fJ(e.target,this.z9)){this.qo=true;this.maplet.l6=e.target.id;var _R5a_=parseInt(e.target.style.left)+(px?1:0);var c0296=parseInt(e.target.style.top)+(px?1:0);this.l0=((px||bN9I)?e.offsetX:e.layerX)+_R5a_;this.na=((px||bN9I)?e.offsetY:e.layerY)+c0296;bx06f=e.target}};this.Or8=function(e){if(this.zX!=null&&this.maplet&&(this.bEditable||this.maplet.sS==ts.tu)&&this.qo){this.qo=false;var x=parseInt(e.clientX)-parseInt(this.maplet.offsetX)-parseInt(this.maplet.left)-this.l0;var y=parseInt(e.clientY)-parseInt(this.maplet.offsetY)-parseInt(this.maplet.top)-this.na;if(x>0&&y>0){MEvent.trigger(this,"nodedrag",this,new MMarker(new MPoint(this.maplet.toMapCoordinate(x+5,y+5))),(this.jH8y6(this,this.Mc77)).slice(0,2))}this.wQ(false);this.e7$60=false;clearTimeout(this.EQHs);this.EQHs=null}this.ls=false;if(this.maplet&&this.maplet.l6==this.id){this.maplet.l6=null}};this.jH8y6=function(Q2d$3,o5E_){var v6=[];var pts=Q2d$3.pts;for(var i=0;i<pts.length;i++){if((pts[i].mapX==o5E_[0].x&&pts[i].mapY==o5E_[0].y)||(pts[i].mapX==o5E_[1].x&&pts[i].mapY==o5E_[1].y)){v6.push(i)}}return v6};this.x1pJ=function(e){if(bx06f!=null&&(this.bEditable||this.maplet.sS==ts.tu)&&this.qo){if(bx06f!=null){var x=e.clientX-this.maplet.offsetX-this.maplet.left-this.l0;var y=e.clientY-this.maplet.offsetY-this.maplet.top-this.na;this.z9.style.left=(parseInt(x))+"px";this.z9.style.top=(parseInt(y))+"px";if(MEvent.contains(this,"nodedrag_move")>0){var pt=new MPoint(this.maplet.toMapCoordinate(x+5,y+5));pt.initialize(this.maplet);MEvent.trigger(this,"nodedrag_move",this,new MMarker(pt),(this.jH8y6(this,this.Mc77)).slice(0,2))}this.lw=new Date().getTime();this.ls=true;with(u0I){Pa57H.x=x;Pa57H.y=y;if(!yN){m49.x=x;m49.y=y;n5N.x=x;n5N.y=y;yN=nB(this,GrW,LPN_HOVERING_TIME)}}}}};var GrW=function(){with(u0I){if(!this.qo&&yN){clearInterval(yN);yN=null;return}if(m49.x==Pa57H.x&&m49.y==Pa57H.y&&(Pa57H.x!=n5N.x||Pa57H.y!=n5N.y)){n5N.x=Pa57H.x;n5N.y=Pa57H.y;MEvent.trigger(this,"drag_hovering",this,new MMarker(new MPoint(this.maplet.toMapCoordinate(Pa57H.x+5,Pa57H.y+5))),(this.jH8y6(this,this.Mc77)).slice(0,2))}else{m49.x=Pa57H.x;m49.y=Pa57H.y}}};this.appendPoint=function(_U9,S$85,dirmark){if(typeof _U9!="object"||!(_U9 instanceof MPoint)||!_U9)throw new Error("para new_pt is not a valid MPoint object.");if(!_U9.maplet)_U9.initialize(this.maplet);this.pts.push(_U9);if(typeof dirmark!="boolean")dirmark=false;if(typeof S$85!="boolean")S$85=true;if(dirmark){var Tp0=this.options.dirmark;Tp0.pts.push(this.pts.length-2);Tp0.v725[this.pts.length-2]=null}if(S$85)this.update()};this.setDirMark=function(uy,refresh){if(typeof uy!="object")uy={minLevel:MAX_ZOOM_LEVEL-1,maxLevel:MAX_ZOOM_LEVEL,pts:[]};if(typeof uy.minLevel!="number"||uy.minLevel<MIN_ZOOM_LEVEL||uy.minLevel>MAX_ZOOM_LEVEL)uy.minLevel=MAX_ZOOM_LEVEL-1;if(typeof uy.maxLevel!="number"||uy.maxLevel<MIN_ZOOM_LEVEL||uy.maxLevel>MAX_ZOOM_LEVEL)uy.maxLevel=MAX_ZOOM_LEVEL;uy.v725={};if(!I41(uy.pts)){uy.pts=[]}else{for(var i=0;i<uy.pts.length;i++)uy.v725[uy.pts[i]]=null}this.options.dirmark=uy;if(!this.maplet)return;if(typeof refresh!="boolean")refresh=true;if(refresh)this.update()};var H$Xc2=function(r,cc05,_b52T,bS48,bDF9J){return parseInt(r+r*Math.sin(Math.PI/180*(cc05+_b52T))+bS48)+","+parseInt(r+r*Math.cos(Math.PI/180*(cc05+_b52T))+bDF9J)};var x63p=function(size,cc05){size=size*100;cc05=180-cc05;var YW5=size/2;var UbB=H$Xc2(YW5,cc05,0,0,0);var JD4=H$Xc2(YW5,cc05,125,0,0);var PT5=H$Xc2(YW5,cc05,235,0,0);return "M"+UbB+" L"+JD4+","+size/2+","+size/2+","+PT5+","+UbB+"E"};var _lsT=function(bS48,bDF9J,size,cc05){cc05=180-cc05;var YW5=size/2;var UbB=H$Xc2(YW5,cc05,0,bS48,bDF9J);var JD4=H$Xc2(YW5,cc05,125,bS48,bDF9J);var PT5=H$Xc2(YW5,cc05,235,bS48,bDF9J);return "M "+UbB+" L "+JD4+" L "+(size/2+bS48)+" "+(size/2+bDF9J)+" L "+PT5+" L "+UbB+"z"};var JGJ=function(x1,H2h,x2,_tsH){var _lL$=null;var color=this.brush.dmstyle.color;var size=this.brush.dmstyle.size;var opacity=this.brush.dmstyle.transparency;var kg68=this.brush.dmstyle.strokeWidth;var g9079=this.brush.dmstyle.strokeColor;var dQJ0R=this.brush.dmstyle.strokeTransparency;var cc05=Math.floor(G6aY7(x1,H2h,x2,_tsH));var L43=size/2;zh=Math.PI/180*(cc05%360);var bS48=-L43*(1+Math.sin(zh));var bDF9J=-L43*(1-Math.cos(zh));if(px){_lL$=document.createElement("v:shape");with(_lL$.style){position="absolute";left=x2+bS48+"px";top=_tsH+bDF9J+"px";height=width="1px";MozUserSelect="none"}with(_lL$){setAttribute("coordsize","100,100");setAttribute("filled","t");setAttribute("strokecolor",g9079);setAttribute("strokeweight",kg68+"px");setAttribute("fillcolor",color);setAttribute("path",x63p(size,cc05));setAttribute(N152,"linemarker");setAttribute(_Fj3O,"true")}var G91$c=document.createElement("v:fill");G91$c.setAttribute("opacity",opacity/100.0);var uVC=document.createElement("v:stroke");uVC.setAttribute("opacity",dQJ0R/100.0);_lL$.appendChild(G91$c);_lL$.appendChild(uVC);this.zX.appendChild(_lL$)}else{_lL$=document.createElementNS("http://www.w3.org/2000/svg","path");with(_lL$){setAttribute("d",_lsT(bS48+x2,bDF9J+_tsH,size,cc05));setAttribute("fill",color);setAttribute("fill-opacity",opacity/100.0);setAttribute("stroke",g9079);setAttribute("stroke-width",kg68+"px");setAttribute("stroke-opacity",dQJ0R/100);setAttribute(N152,"linemarker");setAttribute(_Fj3O,"true")}this.maplet.e61p4().firstChild.appendChild(_lL$)}K12.push(_lL$)};var vg72C=function(){if(K12.length>0){for(var i=0;i<K12.length;i++){K12[i].onmousedown=null;_removeNode(K12[i]);K12[i]=null}K12=[]}};this.setDirMark(this.options.dirmark,false)};MPolyline.D06=24;var MEllipse=function(gC,sax,say,brush,info){this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"Ellipse";this.gC=gC;this.sax=typeof sax!="undefined"&&!isNaN(sax)?parseInt(sax):300;this.say=typeof say!="undefined"&&!isNaN(say)?parseInt(say):null;this.brush=(typeof brush=="undefined")?new MBrush():brush;this.info=(typeof info=="undefined")?null:info;this.ao=new Array();this.zX=null;this.N688=null;this.Ad=null;this.zY=null;this.N1g10=true;this.data={ix:0,iy:0,ax:0,ay:0,sax:0,say:0};this.kgB=false;this.D571g=false;this.creator=MLayer.USER;this.initialize=function(maplet){this.maplet=maplet;if(this.info){this.ao["click"]=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}this.paint()};this.toString=function(){return 'com.mapbar.maplet.MEllipse'};this.paint=function(){if(!this.N688){this.zX=this.maplet.e61p4();if(!Uby5j){this.N688=document.createElement("v:oval");this.N688.strokecolor=this.brush.color;this.N688.strokeweight=this.brush.stroke+'px';this.N688.filled=this.brush.fill;this.Ad=document.createElement("v:stroke");this.Ad.opacity=(this.brush.transparency/100.0);this.zY=document.createElement("v:fill");this.zY.opacity=((this.brush.bgtransparency)/100);this.zY.color=this.brush.bgcolor;this.N688.appendChild(this.Ad);this.N688.appendChild(this.zY);this.zX.appendChild(this.N688)}else{this.N688=document.createElementNS("http://www.w3.org/2000/svg","ellipse");this.N688.setAttribute("stroke",this.brush.color);this.N688.setAttribute("fill",this.brush.fill?this.brush.bgcolor:'none');this.N688.setAttribute("stroke-width",this.brush.stroke);this.N688.setAttribute("stroke-opacity",this.brush.transparency/100);this.N688.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.zX.firstChild.appendChild(this.N688)}this.N688.id=this.id;pps(this.N688,"oid",this.id);this.N688.style.position="absolute";this.N688.unselectable="on";this.N688.setAttribute(_Fj3O,"true");this.N688.setAttribute(N152,"true");this.ao["ellipse_mouseover"]=MEvent.bindDom(this.N688,"mouseover",this,function(e){if(this.maplet.sS==ts.tz||this.maplet.sS==ts.tA||this.maplet.sS==ts.D57MH)this.maplet.q453("crosshair",this.N688);else if(this.info||MEvent.contains(this,"click"))this.maplet.q453("pointer",this.N688);else this.maplet.q453("default",this.N688);if(e.type=="mouseover")MEvent.trigger(this,"mouseover",this)});this.ao["ellipse_mouseout"]=MEvent.bindDom(this.N688,"mouseout",this,function(){if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("default",this.N688);MEvent.trigger(this,"mouseout",this)});this.ao["ellipse_mousedown"]=MEvent.bindDom(this.N688,"mousedown",this,function(){this.kgB=true;this.D571g=false;if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("move",this.N688)});this.ao["ellipse_mouseup"]=MEvent.bindDom(this.N688,"mouseup",this,function(e){this.kgB=false;this.ao["ellipse_mouseover"](e)});this.ao["ellipse_mousemove"]=MEvent.bindDom(this.N688,"mousemove",this,function(){if(this.kgB&&!this.D571g)this.D571g=true})}this.update()};this.setBrush=function(pH24y){if(!(pH24y instanceof MBrush))return;this.brush=pH24y;if(!Uby5j){if(this.N688){this.N688.strokecolor=pH24y.color;this.N688.strokeweight=pH24y.stroke+'px';this.N688.filled=this.brush.fill;this.Ad.opacity=(pH24y.transparency/100.0);this.zY.opacity=((pH24y.bgtransparency)/100);this.zY.color=pH24y.bgcolor}}else{if(this.N688){this.N688.setAttribute("stroke",pH24y.color);this.N688.setAttribute("fill",this.brush.fill?pH24y.bgcolor:'none');this.N688.setAttribute("stroke-width",pH24y.stroke);this.N688.setAttribute("stroke-opacity",pH24y.transparency/100);this.N688.setAttribute("fill-opacity",pH24y.bgtransparency/100)}}};this.update=function(){if(this.N688){if(!this.gC.maplet)this.gC.initialize(this.maplet);if(this.maplet._67R){if(this.maplet.O71Wl!=this.gC.O71Wl){this.gC.mapX+=this.maplet.tJW3;this.gC.mapY+=this.maplet.R8G;this.gC.O71Wl=this.maplet.O71Wl}}else{this.gC.recalcScreenCoords()}var xR0x=this.gC.mapX;var D740=this.gC.mapY;var QM5Y5=parseInt(this.sax/111111.0/this.maplet.xg*this.maplet.imgWidth/0.8);var nbJ=QM5Y5;if(this.say)nbJ=parseInt(this.say/111111.0/this.maplet.xf*this.maplet.imgHeight);this.data.ix=xR0x-QM5Y5;this.data.iy=D740-nbJ;this.data.ax=xR0x+QM5Y5;this.data.ay=D740+nbJ;this.data.sax=QM5Y5;this.data.say=nbJ;if(!Uby5j){this.N688.style.left=this.data.ix+"px";this.N688.style.top=this.data.iy+"px";this.N688.style.width=QM5Y5*2+"px";this.N688.style.height=nbJ*2+"px"}else{this.N688.setAttribute("cx",xR0x+"px");this.N688.setAttribute("cy",D740+"px");this.N688.setAttribute("rx",QM5Y5+"px");this.N688.setAttribute("ry",nbJ+"px")}}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){for(var l8 in this.ao){if(l8.substring(0,8)=="ellipse_"){if(this.N688)MEvent.removeBuiltInListener(this.N688,l8.substring(8),this.ao[l8])}else{if(this.maplet)MEvent.removeBuiltInListener(this.maplet.map,l8,this.ao[l8])}this.ao[l8]=null;delete this.ao[l8]}if(typeof this.N688=="object"&&this.N688&&this.N688.parentNode){_removeNode(this.N688);this.Ad=null;this.zY=null;this.N688=null}this.zX=null;if(this.maplet){if(this.maplet.u5[this.id]){this.maplet.u5[this.id]=null;delete this.maplet.u5[this.id]}}if(finalize){this.ao=null;this.maplet=null}};this.openInfoWindow=function(e){if(this.maplet!=null){if(this.D571g){if(e.target.id==this.id&&this.maplet.B076){this.maplet.B076=false}if(this.maplet.Su15||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this))return}if(!this.info||(this.maplet.sS!=ts.ty&&this.maplet.sS!=ts.tu))return;var x=this.gC.mapX;var y=this.gC.mapY;if(!this.info.getOverlay())this.info.setOverlay(this);var fg=true;if(typeof e=="undefined"){}else if(e.target.id==this.id&&!this.maplet.B076){MEvent.trigger(this,"click",this);x=e.clientX-this.maplet.offsetX-this.maplet.left;y=e.clientY-this.maplet.offsetY-this.maplet.top}else if(e.target.id==this.id&&this.maplet.B076){this.maplet.B076=false;fg=false}else{fg=false}if(fg)this.maplet.wN(x,y,this.info)}};this.setContextMenu=function(menu){if(!menu instanceof MContextMenu)return;this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.getContextMenu=function(dom){if(!dom)return null;return this.contextmenu}};var MRoundRect=function(_89BB,J7Gj5,arcsize,brush,info){this.id=new Date().getTime()+""+parseInt(Math.random()*10000)+"RRect";this._89BB=_89BB;this.J7Gj5=J7Gj5;this.arcsize=typeof arcsize=="number"?arcsize:0.1;this.width=0;this.height=0;this.brush=(typeof brush=="undefined")?new MBrush():brush;this.info=(typeof info=="undefined")?null:info;this.ao=new Array();this.zX=null;this.rect=null;this.N1g10=true;this.kgB=false;this.D571g=false;this.creator=MLayer.USER;this.initialize=function(maplet){this.maplet=maplet;if(this.info){this.ao["click"]=MEvent.bindDom(this.maplet.map,"click",this,this.openInfoWindow)}this.paint()};this.toString=function(){return 'com.mapbar.maplet.MRoundRect'};this.paint=function(){if(!this.rect){this.zX=this.maplet.e61p4();if(!Uby5j){this.rect=document.createElement("v:roundrect");this.rect.arcsize=this.arcsize;this.Ad=document.createElement("v:stroke");this.zY=document.createElement("v:fill");this.rect.appendChild(this.Ad);this.rect.appendChild(this.zY);this.zX.appendChild(this.rect)}else{this.rect=document.createElementNS("http://www.w3.org/2000/svg","rect");this.zX.firstChild.appendChild(this.rect)}this.oS09();this.rect.id=this.id;pps(this.rect,"oid",this.id);this.rect.style.position="absolute";this.rect.unselectable="on";this.rect.setAttribute(_Fj3O,"true");this.ao["rect_mouseover"]=MEvent.bindDom(this.rect,"mouseover",this,function(){if(this.maplet.sS==ts.tz||this.maplet.sS==ts.tA||this.maplet.sS==ts.D57MH)this.maplet.q453("crosshair",this.rect);else if(this.info||MEvent.contains(this,"click"))this.maplet.q453("pointer",this.rect);else this.maplet.q453("default",this.rect)});this.ao["rect_mouseout"]=MEvent.bindDom(this.rect,"mouseout",this,function(){if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("default",this.rect)});this.ao["rect_mousedown"]=MEvent.bindDom(this.rect,"mousedown",this,function(){this.kgB=true;this.D571g=false;if(this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.D57MH)this.maplet.q453("move",this.rect)});this.ao["rect_mouseup"]=MEvent.bindDom(this.rect,"mouseup",this,function(e){this.kgB=false;this.ao["rect_mouseover"](e)});this.ao["rect_mousemove"]=MEvent.bindDom(this.rect,"mousemove",this,function(){if(this.kgB&&!this.D571g)this.D571g=true})}this.update()};this.update=function(){if(this.rect){if(!this._89BB.maplet)this._89BB.initialize(this.maplet);if(!this.J7Gj5.maplet)this.J7Gj5.initialize(this.maplet);if(this.maplet._67R){if(this.maplet.O71Wl!=this._89BB.O71Wl){this._89BB.mapX+=this.maplet.tJW3;this._89BB.mapY+=this.maplet.R8G;this._89BB.O71Wl=this.maplet.O71Wl}if(this.maplet.O71Wl!=this.J7Gj5.O71Wl){this.J7Gj5.mapX+=this.maplet.tJW3;this.J7Gj5.mapY+=this.maplet.R8G;this.J7Gj5.O71Wl=this.maplet.O71Wl}}else{this._89BB.recalcScreenCoords();this.J7Gj5.recalcScreenCoords()}var x=this._89BB.mapX;var y=this._89BB.mapY;this.width=Math.abs(this.J7Gj5.mapX-x);this.height=Math.abs(this.J7Gj5.mapY-y);if(!Uby5j){this.rect.style.left=x+"px";this.rect.style.top=y+"px";this.rect.style.width=this.width+"px";this.rect.style.height=this.height+"px"}else{this.rect.setAttribute("x",x+"px");this.rect.setAttribute("y",y+"px");this.rect.setAttribute("width",this.width+"px");this.rect.setAttribute("height",this.height+"px");this.rect.setAttribute("ry",this.height*this.arcsize)}}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){for(var l8 in this.ao){if(l8.substring(0,5)=="rect_"){if(this.rect)MEvent.removeBuiltInListener(this.rect,l8.substring(5),this.ao[l8])}else{if(this.maplet)MEvent.removeBuiltInListener(this.maplet.map,l8,this.ao[l8])}this.ao[l8]=null;delete this.ao[l8]}if(typeof this.rect=="object"&&this.rect&&this.rect.parentNode){_removeNode(this.rect);this.rect=null}this.zX=null;if(this.maplet){if(this.maplet.u5[this.id]){this.maplet.u5[this.id]=null;delete this.maplet.u5[this.id]}}if(finalize){this.ao=null;this.maplet=null}};this.openInfoWindow=function(e){if(this.maplet!=null){if(this.D571g){if(e.target.id==this.id&&this.maplet.B076){this.maplet.B076=false}if(this.maplet.Su15||(ContentInfo&&ContentInfo.isVisible()&&avBubble.overlay==this))return}if(!this.info||(this.maplet.sS!=ts.ty&&this.maplet.sS!=ts.tu))return;var x=0;var y=0;if(!this.info.getOverlay())this.info.setOverlay(this);var fg=true;if(typeof e=="undefined"){x=this._89BB.mapX+this.width/2;y=this._89BB.mapY+this.height/2}else if(e.target.id==this.id&&!this.maplet.B076){MEvent.trigger(this,"click",this);x=e.clientX-this.maplet.offsetX-this.maplet.left;y=e.clientY-this.maplet.offsetY-this.maplet.top}else if(e.target.id==this.id&&this.maplet.B076){this.maplet.B076=false;fg=false}else{fg=false}if(fg)this.maplet.wN(x,y,this.info)}};this.getCenterXY=function(){var xR0x=this._89BB.mapX+this.width/2;var D740=this._89BB.mapY+this.height/2;return{x:xR0x,y:D740}};this.setBrush=function(pH24y){if(!(pH24y instanceof MBrush))return;this.brush=pH24y;this.oS09()};this.oS09=function(){if(!Uby5j){if(this.rect&&this.Ad&&this.zY){this.rect.strokecolor=this.brush.color;this.rect.strokeweight=this.brush.stroke+'px';this.rect.filled=this.brush.fill;this.Ad.opacity=(this.brush.transparency/100.0);this.Ad.dashstyle=parseInt(this.brush.style)?"dash":"";this.zY.opacity=((this.brush.bgtransparency)/100);this.zY.color=this.brush.bgcolor}}else{if(this.rect){this.rect.setAttribute("stroke",this.brush.color);this.rect.setAttribute("fill",this.brush.fill?this.brush.bgcolor:'none');this.rect.setAttribute("stroke-width",this.brush.stroke);this.rect.setAttribute("stroke-opacity",this.brush.transparency/100);this.rect.setAttribute("fill-opacity",this.brush.bgtransparency/100);this.rect.setAttribute("style",parseInt(this.brush.style)?"stroke-dasharray:10,15":"")}}};this.setContextMenu=function(menu){if(!menu instanceof MContextMenu)return;this.contextmenu=menu;if(menu&&typeof this.maplet=="object"&&this.maplet){if(!this.contextmenu.maplet){this.contextmenu.initialize(this.maplet)}if(!this.contextmenu.containsOverlay(this)){this.contextmenu.addOverlay(this)}}};this.removeContextMenu=function(){if(typeof this.contextmenu=="object"&&this.contextmenu){this.contextmenu.removeOverlay(this);this.contextmenu=null}};this.getContextMenu=function(dom){if(!dom)return null;return this.contextmenu}};var MLabel=function(xP,xoffset,yoffset,opacity,options){this.label=xP;if(typeof xoffset=="object"&&xoffset)options=xoffset;if(typeof options!="object"||!options)options={};if(typeof xoffset=="object"&&xoffset){if("number,string".indexOf(typeof options.xoffset)==-1)options.xoffset=undefined;if("number,string".indexOf(typeof options.yoffset)==-1)options.yoffset=undefined;if("number,string".indexOf(typeof options.opacity)==-1)options.opacity=undefined}else{options.xoffset=xoffset;options.yoffset=yoffset;options.opacity=opacity}if(typeof options.enableStyle!="boolean")options.enableStyle=true;if(typeof options.visible!="boolean")options.visible=true;var K1Y=false;this.visible=options.visible;this.xoffset=(typeof options.xoffset=="undefined")?null:parseInt(options.xoffset);this.yoffset=(typeof options.yoffset=="undefined")?null:parseInt(options.yoffset);this.opacity=typeof options.opacity!="undefined";this.div=document.createElement("div");if(options.enableStyle)this.div.className="tiplabel";this.div.style.left="-1000px";this.div.style.top="-1000px";this.div.unselectable="on";this.div.style.zIndex=10;this.div.style.position="absolute";if(px&&typeof options.opacity!="undefined"){this.div.style.filter="alpha( opacity = "+parseInt(options.opacity)+" )"}else if(!px&&typeof options.opacity!="undefined"){this.div.style.MozOpacity=parseInt(options.opacity)/100}this.marker=null;this.wz=function(id){this.div.id="mk_label_"+id};this.setContextMenu=function(menu){};this.initialize=function(marker){this.marker=marker};this.update=function(maplet,left,top){if(this.div.parentNode!=maplet.lA.div&&!this.marker.ls){if(typeof this.label=="string"){this.div.innerHTML=this.label}else{this.div.appendChild(this.label)}maplet.lA.appendChild(this.div)}if(this.xoffset==null)this.xoffset=this.marker.icon.width;if(this.yoffset==null)this.yoffset=this.marker.icon.height/2-this.div.offsetHeight/2;if(!K1Y){this.div.style.display=this.visible?"":"none";K1Y=true}this.div.style.left=(parseInt(left)+this.xoffset)+"px";this.div.style.top=(parseInt(top)+this.yoffset)+"px"};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.div){if(!finalize){if(this.div.parentNode)this.div.parentNode.removeChild(this.div)}else{_removeNode(this.div);this.div=null}}if(finalize)this.marker=null};this.toString=function(){return 'com.mapbar.maplet.MLabel'};this.X6899=this.div.style.zIndex;this.setZIndex=function(CV0){if(this.div&&this.div.parentNode&&CV0!=this.div.style.zIndex){this.X6899=this.div.style.zIndex;this.div.style.zIndex=CV0}};this.e4501=function(){if(!this.div)return;if(this.X6899!=this.div.style.zIndex)this.setZIndex(this.X6899)};this.setVisible=function(visible){if(visible!=(this.div.style.display=="none"?false:true)){this.div.style.display=visible?"":"none";this.visible=visible}};this.resetLabel=function(options){if(typeof options!="object"||!options)return;var left=parseInt(this.div.style.left);var top=parseInt(this.div.style.top);if(options.content){this.label=options.content;this.div.innerHTML="";if(typeof options.content=="string"){this.div.innerHTML=this.label}else{this.div.appendChild(this.label)}}if(typeof options.enableStyle=="boolean"){this.div.className=options.enableStyle?"tiplabel":""}if("number,string".indexOf(typeof options.xoffset)!=-1)this.xoffset=parseInt(options.xoffset);else if(typeof options.xoffset=="object"&&options.xoffset==null)this.xoffset=null;if("number,string".indexOf(typeof options.yoffset)!=-1)this.yoffset=parseInt(options.yoffset);else if(typeof options.yoffset=="object"&&options.yoffset==null)this.yoffset=null;if("number,string".indexOf(typeof options.opacity)!=-1){if(px&&typeof options.opacity!="undefined"){this.div.style.filter="alpha( opacity = "+parseInt(options.opacity)+" )"}else if(!px&&typeof options.opacity!="undefined"){this.div.style.MozOpacity=parseInt(options.opacity)/100}}this.update(this.marker.maplet,this.marker.icon.left,this.marker.icon.top)};this.getText=function(){var N7k="";var s=this.div.innerHTML;if(s.indexOf(Maplet.MLABEL_TEXT_FLAG)!=-1){var bc06=new RegExp(Maplet.MLABEL_TEXT_FLAG+"=\"?([^\"\t ]*)","gi");var f7x5=bc06.exec(s);if(f7x5!=null)N7k=f7x5[1]}else if(s!=""){N7k=qGb(s)}else{N7k=s}return N7k}};var MInfoWindow=function(ya,xv,yd,options){this.title=ya;this.content=aP3(xv,true);this.yd=(typeof yd!="undefined"&&"mouseover"==yd.toLowerCase())?"mouseover":"click";this.options=options||{};if(typeof this.options.xoffset!="number")this.options.xoffset=0;if(typeof this.options.yoffset!="number")this.options.yoffset=0;this.a9951={_17:false,width:0,height:0};this.gv=function(x,y){MEvent.trigger(this.getOverlay(),"iw_beforeopen",this.getOverlay(),x,y);if(this.getOverlay().maplet.customInfoWindow)return null;avBubble.overlay=this.getOverlay();var b=gp(this.title,x,y,this.content);this.setTabs(r5A4);return b};var wi5Sn=null;this.setOverlay=function(overlay){wi5Sn=overlay};this.getOverlay=function(){return wi5Sn};this.toString=function(){return 'com.mapbar.maplet.MInfoWindow'};this.setTitle=function(yw,c8a,p5MnJ){this.title=yw;if(ContentInfo){ContentInfo.setTitle(yw);this.a9951._17=false;if(typeof c8a!="boolean")c8a=true;if(typeof p5MnJ!="boolean")p5MnJ=false;if(c8a)MK7p1(p5MnJ)}};this.setContent=function(c,c8a,p5MnJ){this.content=aP3(c,true);if(ContentInfo){ContentInfo.setContent(c);this.a9951._17=false;if(typeof c8a!="boolean")c8a=true;if(typeof p5MnJ!="boolean")p5MnJ=true;if(c8a)MK7p1(p5MnJ)}};this.zoomTo=function(type,w,h){if(type=="zoomin")this.zoomIn(w,h);else if(type=="zoomout")this.zoomOut(w,h)};this.zoomOut=function(w,h){if(ContentInfo&&typeof ContentInfo.onZoomOut=="function"){ContentInfo.onZoomOut(w,h)}};this.zoomIn=function(w,h){if(ContentInfo&&typeof ContentInfo.onZoomIn=="function"){ContentInfo.onZoomIn(w,h)}};this.getBodySize=function(){var size={width:0,height:0};if(ContentInfo){return ContentInfo.Gx$8()}return size};this.setZMBtnVisible=function(visible){if(ContentInfo){ContentInfo.setZMBtnVisible(visible)}else{avBubble.q23Y=visible}};this.getZMBtnVisible=function(){return ContentInfo&&ContentInfo.S59()};var r5A4=[];this.setTabs=function(n0215){if(I41(n0215))r5A4=n0215;if(ContentInfo&&ContentInfo.isVisible()&&(wi5Sn&&avBubble.overlay.id==wi5Sn.id)&&r5A4.length>0){for(var i=0;i<n0215.length;i++){ContentInfo.G0AG5(n0215[i].clone())}this.a9951._17=false;MK7p1()}};this.getTabs=function(){return r5A4};this.clearTabs=function(){r5A4=[];if(ContentInfo&&ContentInfo.isVisible()){ContentInfo.o5D7();if(wi5Sn&&avBubble.overlay.id==wi5Sn.id){this.a9951._17=false;MK7p1()}}};this.setCurrentTab=function(XM26){if(ContentInfo){ContentInfo.setCurrentTab(XM26)}};this.getCurrentTab=function(){if(ContentInfo&&ContentInfo.tabIndex!=-1){return ContentInfo.X6285[ContentInfo.tabIndex]}else{return null}};this.finalize=function(){this.clearTabs();M7e5S(this)}};var ContentInfo=null;var gp=function(title,left,top,f5){hideBubble(maplet);avBubble.calcLatLon();if(ContentInfo==null){ContentInfo=new B99(maplet);ContentInfo.initialize();ContentInfo.onClosed=function(){avBubble.P428=false;avBubble.QK8Ti=false;avBubble.w6019=false;MEvent.trigger(maplet,"iw_hide",avBubble.overlay);maplet.viewOverlay(avBubble.overlay,50,50)};ContentInfo.onZoomOut=function(w,h){MEvent.trigger(avBubble.overlay,"bubble_zoomout",avBubble.overlay);var size={width:avBubble.width,height:avBubble.height};if(avBubble.overlay.info&&avBubble.overlay.info.a9951.width>0)size=avBubble.overlay.info.a9951;if(w){if(w<avBubble.minWidth)w=avBubble.minWidth;size.width=w}if(h){if(h<avBubble.minHeight)h=avBubble.minHeight;size.height=h}ContentInfo.width=size.width;ContentInfo.height=size.height;ContentInfo.a6Ii("zoomin");avBubble._D48=true;var lW7=maplet.viewOverlay(avBubble.overlay,50,50);if(lW7.$0xy==0&&lW7.p40Hg==0)maplet.refresh();avBubble.w6019=false;avBubble.u97="out"};ContentInfo.onZoomIn=function(w,h){var overlay=avBubble.overlay;MEvent.trigger(overlay,"bubble_zoomin",avBubble.overlay);w=U5402(w,null);h=U5402(h,null);var c7=maplet.getMaxBubbleSize();if(w&&w<c7.width)c7.width=w;if(h&&h<c7.height)c7.height=h;var a_q=0;var $91=0;if(typeof overlay=="object"&&overlay){if(overlay.toString().indexOf("MMarker")!=-1){if(overlay.icon){a_q=overlay.icon.height;$91=overlay.icon.width;c7.height-=a_q;c7.width-=$91}}else{a_q=50;c7.height-=a_q}}var MfS=maplet.toScreenCoordinate(avBubble.c9p8);var XXU74=ContentInfo.sQ9_(MfS[0],MfS[1],c7.width,c7.height,"top",true,true,overlay);avBubble.NdG=XXU74.U3_8;avBubble.left=XXU74.BAp9;avBubble.top=XXU74.qQ3o;avBubble._D48=true;ContentInfo.show(XXU74,null);ContentInfo.a6Ii("zoomout");var ix=XXU74.BAp9;var iy=XXU74.qQ3o;var ax=ix+XXU74.width;var ay=iy+XXU74.height;with(XXU74.arrow){if(dir=="left"){ix=ix-$91-XXU74.arrow.width}else if(dir=="right"){ax=ax+$91+XXU74.arrow.width}else if(dir=="top"){iy=iy-a_q-XXU74.arrow.height}else if(dir=="bottom"){ay=ay+a_q+XXU74.arrow.height}}maplet.TyUI({t051X:ix,ga98U:iy,cY1:ax,alLn:ay,bS48:10,bDF9J:10},{$YtXd:true,R79:true,S_2:false});avBubble.w6019=true;avBubble.u97="in"}}else{}avBubble.P428=false;avBubble.QK8Ti=false;ContentInfo.o5D7();var size={width:0,height:0};if(avBubble.overlay.info.a9951._17){size.width=avBubble.overlay.info.a9951.width;size.height=avBubble.overlay.info.a9951.height;ContentInfo.setTitle(title);ContentInfo.setContent(f5)}else{size=ContentInfo.J4420(title,f5);if(size.width==0){size={width:avBubble.width,height:avBubble.height}}else{if(size.width<avBubble.minWidth)size.width=avBubble.minWidth;if(size.height<avBubble.minHeight)size.height=avBubble.minHeight;var GcR87=maplet.getMaxBubbleSize();if(size.width>GcR87.width)size.width=GcR87.width;if(size.height>GcR87.height)size.height=GcR87.height}avBubble.overlay.info.a9951.width=size.width;avBubble.overlay.info.a9951.height=size.height;avBubble.overlay.info.a9951._17=true}var XXU74=ContentInfo.sQ9_(left,top,size.width,size.height,avBubble.tipInitPlace,avBubble.P428,avBubble.QK8Ti,avBubble.overlay);avBubble.NdG=XXU74.U3_8;avBubble.left=XXU74.BAp9;avBubble.top=XXU74.qQ3o;avBubble.head=title;avBubble.body=f5;ContentInfo.show(XXU74,avBubble.q23Y,true,avBubble.overlay.info.options.xoffset,avBubble.overlay.info.options.yoffset);if(maplet.fa){ContentInfo.setVisible(false);avBubble.__19E=true}var $91=0;var a_q=0;if(XXU74.TwQ){avBubble.c9p8=avBubble.overlay.pt.getPid();if(avBubble.overlay.icon){$91=avBubble.overlay.icon.width;a_q=avBubble.overlay.icon.height}}else{avBubble.c9p8=maplet.toMapCoordinate(left,top)}if(avBubble.q23Y!=null)avBubble.q23Y=null;var ix=XXU74.BAp9;var iy=XXU74.qQ3o;var ax=ix+XXU74.width;var ay=iy+XXU74.height;with(XXU74.arrow){if(dir=="left"){ix=ix-$91-XXU74.arrow.width}else if(dir=="right"){ax=ax+$91+XXU74.arrow.width}else if(dir=="top"){iy=iy-a_q-XXU74.arrow.height}else if(dir=="bottom"){ay=ay+a_q+XXU74.arrow.height}}maplet.TyUI({t051X:ix,ga98U:iy,cY1:ax,alLn:ay,bS48:10,bDF9J:10});MEvent.trigger(avBubble.overlay,"iw_afteropen",avBubble.overlay);return ContentInfo.dom};function MK7p1(p5MnJ){if(!ContentInfo||!ContentInfo.isVisible())return;if(typeof p5MnJ!="boolean")p5MnJ=false;var MfS=maplet.toScreenCoordinate(avBubble.c9p8);var r=ContentInfo.getRect(false,false);if(p5MnJ){var size=ContentInfo.J4420(avBubble.overlay.info.title,avBubble.overlay.info.content);if(size.width==0){size={width:r.width,height:r.height}}else{if(size.width<avBubble.minWidth)size.width=avBubble.minWidth;if(size.height<avBubble.minHeight)size.height=avBubble.minHeight;var GcR87=maplet.getMaxBubbleSize();if(size.width>GcR87.width)size.width=GcR87.width;if(size.height>GcR87.height)size.height=GcR87.height}avBubble.overlay.info.a9951.width=size.width;avBubble.overlay.info.a9951.height=size.height;r.width=size.width;r.height=size.height}var XXU74=ContentInfo.sQ9_(MfS[0],MfS[1],r.width,r.height,avBubble.NdG,avBubble.P428,avBubble.QK8Ti,avBubble.overlay);ContentInfo.show(XXU74,avBubble.q23Y,true,avBubble.overlay.info.options.xoffset,avBubble.overlay.info.options.yoffset);r=ContentInfo.getRect();if(!avBubble.w6019){avBubble.overlay.info.a9951.width=r.width;avBubble.overlay.info.a9951.height=r.height}var $91=0;var a_q=0;if(XXU74.TwQ&&avBubble.overlay.icon){$91=avBubble.overlay.icon.width;a_q=avBubble.overlay.icon.height}var ix=r.min.x;var iy=r.min.y;var ax=r.max.x;var ay=r.max.y;with(XXU74.arrow){if(dir=="left"){ix=ix-$91}else if(dir=="right"){ax=ax+$91}else if(dir=="top"){iy=iy-a_q}else if(dir=="bottom"){ay=ay+a_q}}maplet.fa=false;maplet.TyUI({t051X:ix,ga98U:iy,cY1:ax,alLn:ay,bS48:10,bDF9J:10})};function hideBubble(maplet){if(!ContentInfo)return;if(ContentInfo.isVisible()){ContentInfo.setVisible(false);MEvent.trigger(maplet,"iw_hide",avBubble.overlay)}if(typeof maplet!="undefined"&&maplet.t1B_!=null){maplet.t1B_=null;maplet.refresh()}else if(document["mapbar-maplet"]!="undefined"&&document["mapbar-maplet"].t1B_!=null){document["mapbar-maplet"].t1B_=null;document["mapbar-maplet"].refresh()}ContentInfo.a6Ii("zoomin")};var Bubble=function(){this.xR="";this.q23Y=false;this.left=0;this.top=0;this.head=new String();this.body=new String();this.width=260;this.height=240;this.overlay=null;this.arrow_tip_xoffset=27;this.arrow_tip_yoffset=3;this.xoffset=0;this.c9p8="";this.tipInitPlace="top";this.NdG="auto";this.P428=false;this.QK8Ti=false;this.FqM0=true;this.__19E=false;this._Q8ia="";this.v6yO="";this._D48=false;this.u97="";this.minWidth=100;this.minHeight=60;this.Dgfk4=true;this.w6019=false;this.B9_e=function(head){this.head=head};this.d$7=function(body){this.body=body};this.gl=function(){};this.calcLatLon=function(){this.xR=maplet.toMapCoordinate(this.left,this.top)};this.syncContentInfoPosition=function(){if(ContentInfo){this.left=ContentInfo.q3;this.top=ContentInfo.zt}};this.mFc=function(){if(ContentInfo){if(!px)ContentInfo.I72(false);if(this.c9p8&&(this.__19E||ContentInfo.isVisible())){if(this.__19E)this.__19E=false;if(this.FqM0){var MfS=maplet.toScreenCoordinate(this.c9p8);avBubble.P428=true;var XXU74=ContentInfo.sQ9_(MfS[0],MfS[1],ContentInfo.width,ContentInfo.height,avBubble.NdG,avBubble.P428,this.QK8Ti,avBubble.overlay,false,false);this.NdG=XXU74.U3_8;ContentInfo.show(XXU74,null,this._D48,avBubble.overlay.info.options.xoffset,avBubble.overlay.info.options.yoffset);if(this._D48)this._D48=false;if(this.u97!=""&&this.overlay){MEvent.trigger(this.overlay,"bubble_zoomend",this.u97=="in"?"out":"in");if(this.overlay.info)MEvent.trigger(maplet,"iw_zoomend",this.overlay.info,this.u97=="in"?"zoomin":"zoomout");if(this.u97=="in"){this.P428=true;this.QK8Ti=true}else{this.P428=false;this.QK8Ti=false}this.u97=""}}else{this.FqM0=true}}}}};var avBubble=new Bubble();var MInfoWindowTab=function(label,content,focus){var e20y3=label;var k03=content;var Xed7=null;var H23=0;var t5x9r=true;this._u909=typeof focus!="boolean"?false:focus;this.K70=-1;this.V8l=[];this.setVisible=function(visible){t5x9r=visible};this.M2r=function(){return t5x9r};this.V1M=function(index){H23=index};this.getIndex=function(){return H23};this.setLabel=function(label){e20y3=label};this.getLabel=function(){return e20y3};this.setContent=function(content){k03=content};this.getContent=function(){return k03};this.toString=function(){return "com.mapbar.maplet.MInfoWindowTab"};this.Y7UQ=function(dom){Xed7=dom};this.DBr6=function(){return Xed7};this.clone=function(){return new MInfoWindowTab(this.getLabel(),this.getContent(),this._u909)};this.d_3N7=function(){Xed7=null;t5x9r=false;K70=-1}};MInfoWindowTab.G1mj=function(uy){return typeof uy=="object"&&uy&&typeof uy.toString=="function"&&uy.toString().indexOf("MInfoWindowTab")!=-1};var B99=function(maplet){var q43q0=maplet;this.x=0;this.y=0;this.width=0;this.height=0;this.content="";this.dom=null;this.y6d=null;this.o38Ea=null;this.UgwL6=null;this.Ng44t=null;this.X24=null;this.vtXb=null;this.fAEd=null;this.R38=null;this.G0063=null;this.M2aE5=[];this.DEs=null;this.Tm6Jq=null;this.K0877="";this.X6285=[];this.tabIndex=-1;this.w$3G=0;this.TE83k=0;this.Qj4w_=0;this.U4k=0;this.GF5px=0;this.Lh9=null;this.onZoomOut=null;this.onZoomIn=null;this.onClosed=null;this.r38=null;this._ic=null;this.M9Eum=null;this.L08={type:"zoomin",q9:null};this.OS8=0;this.YVi4=0;this.initialize=function(){this.dom=document.createElement("TABLE");this.vL2xp();this.dom.cellSpacing=0;this.dom.cellPadding=0;this.dom.border=0;this.dom.style.cssText=this.GCT3("TIP_TABLE");this.dom.setAttribute(_56,true);var x1LM=this.dom.insertRow(-1);var p050=x1LM.insertCell(-1);p050.vAlign="top";p050.style.cssText=this.GCT3("TITLE_CONTAINER_TD");this.y6d=this.E0RY$();p050.appendChild(this.y6d);p050=this.dom.insertRow(-1).insertCell(-1);p050.style.cssText=this.GCT3("TAB_TD");this.X24=this.F965();this.X24.style.cssText=this.GCT3("TAB_CONTAINER");p050.appendChild(this.X24);this.X24.style.display="none";this.dom.rows[1].style.display="none";x1LM=this.dom.insertRow(-1);p050=x1LM.insertCell(-1);p050.vAlign="top";p050.style.cssText=this.GCT3("CONTENT_TD");this.G0063=this.Yx9();p050.appendChild(this.G0063);this.qb24();var parentNode=q43q0?q43q0.sF:document.body;parentNode.appendChild(this.dom);parentNode.appendChild(this.J34());for(var i=0;i<this.M2aE5.length;i++){parentNode.appendChild(this.M2aE5[i])}parentNode.appendChild(this.m335())};this.m335=function(){this.Tm6Jq=document.createElement("DIV");this.Tm6Jq.style.cssText=this.GCT3("TIP_BORDER");return this.Tm6Jq};this.J34=function(){this.DEs=document.createElement("DIV");this.DEs.style.cssText=this.GCT3("ARROW_DIV");return this.DEs};this.Yx9=function(){var dom=document.createElement("DIV");dom.style.cssText=this.GCT3("CONTENT_DIV");return dom};this.qb24=function(){if(this.dom){var p3ot=this.GCT3("SHADOW_AMOUNT");for(var i=0;i<p3ot;i++){var shadow=document.createElement("DIV");shadow.id="_iw_shadow_"+i;shadow.style.cssText=this.GCT3("SHADOW_DIV");shadow.setAttribute(_Fj3O,"true");if(window.attachEvent)shadow.style.filter="alpha(opacity="+(this.GCT3("SHADOW_OPACITY")[i]*100)+");";else shadow.style.opacity=this.GCT3("SHADOW_OPACITY")[i];shadow.style.zIndex=this.GCT3("TIP_DEFAULT_INFO").zIndex-(i+1);shadow.onmousedown=function(){return false};this.M2aE5.push(shadow)}}};this.F965=function(){var ul=document.createElement("UL");this.fAEd=document.createElement("LI");this.fAEd.style.cssText=this.GCT3("TAB_NAV_L");this.vtXb=document.createElement("LI");this.vtXb.style.cssText=this.GCT3("TAB_SPACER");this.R38=document.createElement("LI");this.R38.style.cssText=this.GCT3("TAB_NAV_R");ul.appendChild(this.fAEd);ul.appendChild(this.vtXb);ul.appendChild(this.R38);return ul};this.E0RY$=function(){var kB5Y=this.GCT3("TITLE_INFO");var OG_=document.createElement("TABLE");OG_.width="100%";OG_.cellSpacing=0;OG_.cellPadding=0;OG_.border=0;OG_.style.cssText=this.GCT3("TITLE_TABLE");var x1LM=OG_.insertRow(-1);this.o38Ea=x1LM.insertCell(-1);this.o38Ea.vAlign="top";this.o38Ea.style.cssText=this.GCT3("TITLE_TD");var p050=x1LM.insertCell(-1);p050.style.cssText=this.GCT3("TITLE_SPACER");p050.innerHTML="&nbsp;";this.UgwL6=x1LM.insertCell(-1);this.UgwL6.vAlign="top";this.UgwL6.style.cssText=this.GCT3("RT_BTN_TD");this.UgwL6.innerHTML=this.GCT3("ZOOMIN_IMG");this.UgwL6.style.width="0px";this.Li8_();this.Ng44t=x1LM.insertCell(-1);this.Ng44t.vAlign="top";this.Ng44t.style.cssText=this.GCT3("RT_BTN_TD");this.Ng44t.innerHTML=this.GCT3("CLOSE_IMG");this.r38=MEvent.bindDom(this.Ng44t,"click",this,this.y02);return OG_};this.Gx$8=function(){return{width:this.Tm6Jq.offsetWidth,height:this.Tm6Jq.offsetHeight}};this.getRect=function(jf8F3,bArrow){if(typeof jf8F3!="boolean")jf8F3=true;if(typeof bArrow!="boolean")bArrow=true;var dom=jf8F3?this.Tm6Jq:this.dom;var ix=U5402(this.dom.style.left);var iy=U5402(this.dom.style.top);var ax=ix+this.dom.offsetWidth;var ay=iy+this.dom.offsetHeight;if(bArrow){if(this.K0877=="LEFT"){ix=U5402(this.DEs.style.left)}else if(this.K0877=="RIGHT"){ax+=this.DEs.offsetWidth}else if(this.K0877=="TOP"){iy=U5402(this.DEs.style.top)}else if(this.K0877=="BOTTOM"){ay+=this.DEs.offsetHeight}}return{min:{x:ix,y:iy},max:{x:ax,y:ay},width:ax-ix,height:ay-iy}};this.J4420=function(title,content){if(!this.dom)this.initialize();var _x1=-100000;var XXU74={BAp9:_x1,qQ3o:_x1,q0m9:_x1,r65d:_x1,width:avBubble.minWidth,height:avBubble.minHeight,arrow:{dir:"left"}};this.show(XXU74,null,false);this.setTitle(title);this.setContent(content);this.I72(true);var h=0;var w=0;var c=this.G0063.firstChild;if(c&&c.offsetWidth&&this.G0063.childNodes.length==1&&(_getStyle(c,"width")!="auto"||c.tagName=="IMG")){w=c.offsetWidth+U5402(_getStyle(c,"marginLeft","margin-left"))+U5402(_getStyle(c,"marginRight","margin-right"));h=c.offsetHeight+U5402(_getStyle(c,"marginTop","margin-top"))+U5402(_getStyle(c,"marginBottom","margin-bottom"));if(px){if(!x00Vr){w=w+U5402(_getStyle(this.G0063,"paddingLeft","padding-left"))*2;h=h+U5402(_getStyle(this.G0063,"paddingTop","padding-top"))*2}else{h+=1}}this.G0063.style.width=w+"px";this.G0063.style.height=h+"px";this.dom.style.width=this.G0063.offsetWidth+U5402(this.dom.style.borderWidth)*2+"px";h=this.dom.offsetHeight;w=this.dom.offsetWidth}this.I72(false);this.setVisible(false);return{width:w,height:h}};this.sQ9_=function(x,y,width,height,U3_8,XH3,eu5m,overlay,R79,$YtXd){if(typeof width!="number")width=this.GCT3("TIP_DEFAULT_INFO").width;if(typeof height!="number")height=this.GCT3("TIP_DEFAULT_INFO").height;if(typeof U3_8!="string")U3_8="auto";if(typeof XH3!="boolean")XH3=false;if(typeof eu5m!="boolean")eu5m=false;if(typeof R79!="boolean")R79=true;if(typeof $YtXd!="boolean")$YtXd=true;var BAp9=0;var qQ3o=0;var q0m9=0;var r65d=0;var direction="right";var oF4ka=0;var N450R=0;var TwQ=false;var t9O=false;if(q43q0){var sT=q43q0.width;var n4T=q43q0.height;var uQ6=this.GCT3("ARROW_INFO");var dkY39=width+uQ6.t2Kb;var ln009=height+uQ6.A6F81;var eof6_=width/2;var U7209=height/2;var offsetX=0;var offsetY=0;if(typeof overlay=="object"&&overlay){var s=overlay.toString();TwQ=s.indexOf("MMarker")!=-1;t9O=s.indexOf("MPolyline")!=-1}if(TwQ&&overlay.icon){offsetX=overlay.icon.width/2;offsetY=overlay.icon.height/2;x=x-overlay.icon.anchorX+offsetX;y=y-overlay.icon.anchorY+offsetY}if(eu5m){qQ3o=y-U7209;BAp9=x-eof6_}else{if(y-U7209<=0)qQ3o=5;else if(y+U7209>n4T)qQ3o=n4T-height-5;else qQ3o=y-U7209;if(x-eof6_<=0)BAp9=5;else if(x+eof6_>sT)BAp9=sT-width-5;else BAp9=x-eof6_}var tE3=false;var G122Q=false;var aS940=false;var _4i0=false;var jntER={min:{x:0,y:0},max:{x:0,y:0}};var J9uc7=q43q0.getControlRect();var NWOb2=q43q0.getOverviewRect();var bHGc8=x>=dkY39&&y>=uQ6.CSs7&&y+uQ6.CSs7<=n4T;if(bHGc8){var ax=x-offsetX-uQ6.t2Kb;var zB=ax-width;if(!isNaN(parseInt(this.dom.style.borderRightWidth)))zB+=parseInt(this.dom.style.borderRightWidth);jntER={min:{x:zB,y:qQ3o},max:{x:zB+dkY39,y:qQ3o+ln009}};if(R79)bHGc8=!_isRectint(jntER,J9uc7);if($YtXd&&bHGc8)bHGc8=!_isRectint(jntER,NWOb2)}var S833r=y>=ln009&&x>=uQ6.lB5&&x<=sT-uQ6.lB5;if(S833r){var ay=y-offsetY-uQ6.A6F81;var zF=ay-height;if(!isNaN(parseInt(this.dom.style.borderBottomWidth)))zF+=parseInt(this.dom.style.borderBottomWidth);jntER={min:{x:BAp9,y:zF},max:{x:BAp9+dkY39,y:zF+ln009}};if(R79)S833r=!_isRectint(jntER,J9uc7);if($YtXd&&S833r)S833r=!_isRectint(jntER,NWOb2)}var nx90=sT-x>=dkY39&&y>=uQ6.CSs7&&y+uQ6.CSs7<=n4T;if(nx90){var ax=x+offsetX;var zB=ax+uQ6.t2Kb;if(!isNaN(parseInt(this.dom.style.borderLeftWidth)))zB-=parseInt(this.dom.style.borderLeftWidth);jntER={min:{x:zB,y:qQ3o},max:{x:zB+dkY39,y:qQ3o+ln009}};if(R79)nx90=!_isRectint(jntER,J9uc7);if($YtXd&&nx90)nx90=!_isRectint(jntER,NWOb2)}var qp304=n4T-y>=ln009&&x>=uQ6.lB5&&x<=sT-uQ6.lB5;if(qp304){var ay=y+offsetY;var zF=ay+uQ6.A6F81;if(!isNaN(parseInt(this.dom.style.borderTopWidth)))zF-=parseInt(this.dom.style.borderTopWidth);jntER={min:{x:BAp9,y:zF},max:{x:BAp9+dkY39,y:zF+ln009}};if(R79)qp304=!_isRectint(jntER,J9uc7);if($YtXd&&qp304)qp304=!_isRectint(jntER,NWOb2)}if(U3_8!="auto"){if(XH3){if(U3_8=="left")tE3=true;else if(U3_8=="top")G122Q=true;else if(U3_8=="right")aS940=true;else if(U3_8=="bottom")_4i0=true}else{if(U3_8=="left"&&bHGc8)tE3=true;else if(U3_8=="top"&&S833r)G122Q=true;else if(U3_8=="right"&&nx90)aS940=true;else if(U3_8=="bottom"&&qp304)_4i0=true;else U3_8="auto"}}if(U3_8=="auto"){tE3=bHGc8;G122Q=S833r;aS940=nx90;_4i0=qp304}var WB3J3="";if(tE3){WB3J3="left";q0m9=x-offsetX-uQ6.t2Kb;r65d=y-uQ6.CSs7/2;BAp9=q0m9-width;if(!isNaN(parseInt(this.dom.style.borderRightWidth)))BAp9+=parseInt(this.dom.style.borderRightWidth);if(r65d<qQ3o+5)qQ3o=r65d-5;else if(r65d+uQ6.CSs7>=qQ3o+height-5)qQ3o=r65d-height+uQ6.CSs7+5}else if(aS940){WB3J3="right";direction="left";q0m9=x+offsetX;r65d=y-uQ6.CSs7/2;BAp9=q0m9+uQ6.t2Kb;if(!isNaN(parseInt(this.dom.style.borderLeftWidth)))BAp9-=parseInt(this.dom.style.borderLeftWidth);if(r65d<qQ3o+5)qQ3o=r65d-5;else if(r65d+uQ6.CSs7>=qQ3o+height-5)qQ3o=r65d-height+uQ6.CSs7+5}else if(G122Q||(!aS940&&!G122Q&&!tE3&&!_4i0)){WB3J3="top";direction="bottom";q0m9=x-uQ6.lB5/2;r65d=y-offsetY-uQ6.A6F81;qQ3o=r65d-height;if((!aS940&&!G122Q&&!tE3&&!_4i0)){if(BAp9==5||(BAp9==sT-width-5)){BAp9=x-eof6_}}if(!isNaN(parseInt(this.dom.style.borderBottomWidth)))qQ3o+=parseInt(this.dom.style.borderBottomWidth);if(q0m9<BAp9+5)BAp9=q0m9-5;else if(q0m9+uQ6.lB5>=BAp9+width-5)BAp9=q0m9-width+uQ6.lB5+5}else if(_4i0){WB3J3="bottom";direction="top";q0m9=x-uQ6.lB5/2;r65d=y+offsetY;qQ3o=r65d+uQ6.A6F81;if(!isNaN(parseInt(this.dom.style.borderTopWidth)))qQ3o-=parseInt(this.dom.style.borderTopWidth);if(q0m9<BAp9+5)BAp9=q0m9-5;else if(q0m9+uQ6.lB5>=BAp9+width-5)BAp9=q0m9-width+uQ6.lB5+5}if(WB3J3=="left"||WB3J3=="right"){oF4ka=uQ6.t2Kb;N450R=uQ6.CSs7}else{oF4ka=uQ6.lB5;N450R=uQ6.A6F81}}return{BAp9:BAp9,qQ3o:qQ3o,q0m9:q0m9,r65d:r65d,width:width,height:height,U3_8:WB3J3,arrow:{dir:direction,width:oF4ka,height:N450R},TwQ:TwQ,t9O:t9O}};this.show=function(XXU74,Ivr,Qt6a0,xoffset,yoffset){this.x=XXU74.BAp9;this.y=XXU74.qQ3o;this.width=XXU74.width;this.height=XXU74.height;if(!this.dom)this.initialize();this.OS8=(typeof xoffset!="number")?0:xoffset;this.YVi4=(typeof yoffset!="number")?0:yoffset;this.dom.style.left=this.x+(XXU74.U3_8=="top"||XXU74.U3_8=="bottom"?this.OS8:0)+"px";this.dom.style.top=this.y+(XXU74.U3_8=="left"||XXU74.U3_8=="right"?this.YVi4:0)+"px";this.dom.style.width=this.width+"px";this.dom.style.height=this.height+"px";this.G0063.style.width="1px";this.G0063.style.height="1px";if(!bN9I)this.G0063.style.overflow="hidden";this.setVisible(true);if(typeof Ivr=="boolean")this.setZMBtnVisible(Ivr);this.s0W(XXU74.q0m9,XXU74.r65d,XXU74.arrow.dir);this.Qc5(Qt6a0);if(!bN9I)this.G0063.style.overflow="auto"};this.s0W=function(x,y,direction){direction=direction.toUpperCase();this.K0877=direction;var o9o="";var uQ6=this.GCT3("ARROW_INFO");o9o=this.GCT3("ARROW_"+direction+"_CHILD");var width=uQ6.t2Kb;var height=uQ6.CSs7;if(direction=="TOP"||direction=="BOTTOM"){width=uQ6.lB5;height=uQ6.A6F81}this.DEs.innerHTML=o9o;this.DEs.style.left=x+(direction=="TOP"||direction=="BOTTOM"?this.OS8:0)+"px";this.DEs.style.top=y+(direction=="RIGHT"||direction=="LEFT"?this.YVi4:0)+"px";this.DEs.style.width=width+"px";this.DEs.style.height=height+"px";this.DEs.style.display=""};this.u3p=function(){this.DEs.style.display="none"};this.Qc5=function(Qt6a0){if(!this.isVisible())return;var th=this.y6d.offsetHeight;if(!isNaN(parseInt(this.y6d.style.marginTop)))th+=parseInt(this.y6d.style.marginTop);if(!isNaN(parseInt(this.y6d.style.marginBottom)))th+=parseInt(this.y6d.style.marginBottom);var h=this.dom.offsetHeight-th-this.w$3G;if(x00Vr||HxT||Hg6||RoY5){if(!isNaN(parseInt(this.G0063.style.paddingTop)))h-=U5402(this.G0063.style.paddingTop);if(!isNaN(parseInt(this.G0063.style.paddingBottom)))h-=U5402(this.G0063.style.paddingBottom)}if(!isNaN(parseInt(this.dom.style.borderTopWidth)))h-=parseInt(this.dom.style.borderTopWidth);if(!isNaN(parseInt(this.dom.style.borderBottomWidth)))h-=parseInt(this.dom.style.borderBottomWidth);var w=this.dom.offsetWidth;if(x00Vr||Hg6||RoY5||HxT){if(!isNaN(parseInt(this.G0063.style.paddingLeft)))w-=parseInt(this.G0063.style.paddingLeft);if(!isNaN(parseInt(this.G0063.style.paddingRight)))w-=parseInt(this.G0063.style.paddingRight)}w=w-U5402(this.dom.style.borderWidth)*2;this.G0063.style.height=h+"px";this.G0063.style.width=w+"px";if(this.G0063.scrollWidth>this.G0063.offsetWidth){if(!isNaN(parseInt(this.dom.style.borderLeftWidth)))w-=parseInt(this.dom.style.borderLeftWidth);if(!isNaN(parseInt(this.dom.style.borderRightWidth)))w-=parseInt(this.dom.style.borderRightWidth);this.G0063.style.width=w+"px"}if(typeof Qt6a0!="boolean")Qt6a0=true;if(this.X6285.length>0&&Qt6a0){this.rkLuo();this.F7t();var y6_tx=this.tabIndex;this.tabIndex=-1;if(y6_tx!=-1){if(!this.X6285[y6_tx].M2r())this.setCurrentTab(0);else this.setCurrentTab(y6_tx)}}var $13We=this.K0877=="TOP"||this.K0877=="BOTTOM"?this.OS8:0;var E077=this.K0877=="RIGHT"||this.K0877=="LEFT"?this.YVi4:0;for(var i=0;i<this.M2aE5.length;i++){var shadow=this.M2aE5[i];shadow.style.left=(this.x+3+((i)*3))+$13We+"px";shadow.style.top=(this.y+3+((i)*3))+E077+"px";shadow.style.width=this.width+"px";shadow.style.height=this.height+"px";shadow.style.display=""}this.Tm6Jq.style.width=this.width+2+"px";this.Tm6Jq.style.height=this.height+2+"px";this.Tm6Jq.style.left=this.x-1+$13We+"px";this.Tm6Jq.style.top=this.y-1+E077+"px";if(l4_lc){q43q0.sF.moveTo(1,0);q43q0.sF.moveTo(0,0)}};this.bT9J=function(){return this.dom};this.G0AG5=function(HIsG){if(!this.bT9J())return;if(this.X6285.length>=this.GCT3("TAB_AMOUNT"))return false;if(MInfoWindowTab.G1mj(HIsG)){if(this.X6285.length==0){var n0215=[];if(this.content!=""){n0215.push(new MInfoWindowTab(this.GCT3("TAB_DEFAULT_LABEL"),this.content,!HIsG._u909));this.G0063.innerHTML=""}if(n0215.length==0&&!HIsG._u909)HIsG._u909=true;n0215.push(HIsG);this.s7$2B(n0215)}else{this.n367J(HIsG,-1)}}};this.o5D7=function(){if(!this.bT9J())return;if(this.X6285.length>0){var n0215=this.X6285;for(var i=n0215.length-1;i>=0;i--){this.cba(i,false)}this.X6285=[]}};this.JM1=function(){this.tabIndex=-1;this.GF5px=0;this.Lh9=null};this.cba=function(index,lc2){if(!this.bT9J())return;if(this.X24&&this.X6285.length>index){if(typeof lc2!="boolean")lc2=true;var P86R=[];var cba=null;var $X3=this.tabIndex;this.tabIndex=-1;var yrHa8=0;for(var i=0;i<this.X6285.length;i++){if(i!=index){var kRL40=this.X6285[i];var y6_tx=kRL40.getIndex();P86R.push(kRL40);kRL40.V1M(P86R.length-1);var dom=kRL40.DBr6();if(dom)dom.setAttribute("tabIndex",kRL40.getIndex());if(y6_tx==$X3)yrHa8=kRL40.getIndex()}else{cba=this.X6285[i]}}if(cba){this.X6285=P86R;var Xy628=cba.DBr6();if(cba.V8l.length>0){for(var i=0;i<cba.V8l.length;i++){var item=cba.V8l[i];MEvent.removeBuiltInListener(Xy628,item.event,item.q9)}}if(Xy628){_removeNode(Xy628)}}this.rkLuo();this.F7t();if(this.X6285.length>yrHa8&&!this.X6285[yrHa8].M2r())yrHa8=0;if(lc2)this.setCurrentTab(yrHa8);if(this.X6285.length==0){this.pJ8()}}};this.pJ8=function(){this.w$3G=0;this.dom.rows[1].style.display="none";this.JM1();if(this.content)this.setContent(this.content);this.Qc5()};this.n367J=function($w6,Q_o60){if(!MInfoWindowTab.G1mj($w6)){return false}var p3ot=this.X6285.length;var C42p=this.vtXb;if(!MInfoWindowTab.G1mj(Q_o60)||!Q_o60.DBr6()){Q_o60=null}if(Q_o60){C42p=Q_o60.DBr6();var i1253=this.tabIndex==Q_o60.getIndex();var cA_=[];for(var i=0;i<this.X6285.length;i++){var item=this.X6285[i];if(item==Q_o60){cA_.push($w6);$w6.V1M(cA_.length-1)}cA_.push(item);item.V1M(cA_.length-1);var Xy628=item.DBr6();if(Xy628)Xy628.setAttribute("tabIndex",item.getIndex())}if(i1253)this.tabIndex=Q_o60.getIndex();this.X6285=cA_}else{this.X6285.push($w6);$w6.V1M(this.X6285.length-1)}var Xy628=this.sg_($w6,C42p);if(isNaN(parseInt(this.X24.style.height))){this.X24.style.height=parseInt(this.X24.parentNode.clientHeight)+"px"}if($w6._u909)this.setCurrentTab($w6.getIndex());this.F7t()};this.vL2xp=function(){MEvent.bindDom(this.dom,'contextmenu',this,function(e){QD199(e);if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;if(q43q0.xc)q43q0.xc.hide()})};this.sg_=function(HIsG,C42p){var Xy628=document.createElement("LI");Xy628.innerHTML=HIsG.getLabel();Xy628.style.cssText=this.GCT3("TAB_TEXT_BLUR");Xy628.setAttribute("tabIndex",HIsG.getIndex());HIsG.Y7UQ(Xy628);this.X24.insertBefore(Xy628,C42p);HIsG.V8l.push({event:"click",q9:MEvent.bindDom(Xy628,"click",this,this.N9O59)});if(this.X6285.length==1){if(this.TE83k==0){this.TE83k=Xy628.clientHeight;if(parseInt(Xy628.style.paddingTop))this.TE83k-=parseInt(Xy628.style.paddingTop);if(parseInt(Xy628.style.paddingBottom))this.TE83k-=parseInt(Xy628.style.paddingBottom)}if(this.Qj4w_==0){this.Qj4w_=Xy628.clientHeight}}return Xy628};this.F7t=function(){var n0215=this.X6285;this.u5FI(true);this.hF2V(true);var o41hc=this.fAEd.firstChild.offsetWidth;var wwJ72=this.R38.firstChild.offsetWidth;var m214=null;var HIsG=null;for(var i=n0215.length-1;i>=0;i--){HIsG=n0215[i];if(HIsG.M2r()){var Xy628=HIsG.DBr6();if(Xy628){var R5q=Xy628.clientWidth;if(Xy628.offsetTop>=Xy628.offsetHeight*2-5){p2736=0}else{var p2736=this.P7uJ(true);if(Xy628.offsetTop==0)p2736+=R5q;else if(Xy628.offsetLeft!=0)p2736=0}if(R5q>=p2736){if(p2736<=20){this.uk2(HIsG,false);p2736=0}else{p2736=p2736-parseInt(Xy628.style.paddingLeft)-parseInt(Xy628.style.paddingRight);Xy628.style.width=p2736+"px";m214=HIsG}}else{m214=HIsG}if(p2736!=0)break}}}this.u5FI(false);this.hF2V(false);if(n0215.length>0){this.u5FI(!n0215[0].M2r());this.hF2V(!n0215[n0215.length-1].M2r())}if(m214&&m214.DBr6()){this.Lh9=m214;var dom=m214.DBr6();var width=dom.clientWidth;if(!isNaN(parseInt(dom.style.paddingLeft)))width-=parseInt(dom.style.paddingLeft);if(!isNaN(parseInt(dom.style.paddingRight)))width-=parseInt(dom.style.paddingRight);if(!this.tkl()){width+=o41hc}if(!this.KKS7()){width+=wwJ72}if(this.tabIndex==m214.getIndex())width-=2;dom.style.width=width+"px"}for(var i=0;i<n0215.length;i++){HIsG=n0215[i];if(HIsG.M2r()){HIsG.K70=this.GF5px;if(HIsG.DBr6()){HIsG.DBr6().style.height=this.TE83k+"px"}}}this.$6_t4()};this.uk2=function(HIsG,visible){var Xy628=HIsG.DBr6();if(Xy628){if(visible){Xy628.style.cssText=this.GCT3("TAB_TEXT_BLUR")}else{Xy628.style.width="0px";Xy628.style.padding="0px"}HIsG.setVisible(visible)}};this.rkLuo=function(){var n0215=this.X6285;for(var i=0;i<n0215.length;i++){this.uk2(n0215[i],true)}};this.hF2V=function(visible){if(!this.M9Eum)this.M9Eum=MEvent.bindDom(this.R38,"click",this,this.o747);if(visible){this.R38.innerHTML=this.GCT3("TAB_NAV_R_CHILD");this.R38.style.cursor="pointer";this.R38.style.width=this.GCT3("TAB_NAV_INFO").width+"px"}else{this.R38.innerHTML="";this.R38.style.cursor="";this.R38.style.width="0px"}};this.u5FI=function(visible){if(!this._ic)this._ic=MEvent.bindDom(this.fAEd,"click",this,this.u18P);if(visible){this.fAEd.innerHTML=this.GCT3("TAB_NAV_L_CHILD");this.fAEd.style.cursor="pointer";this.fAEd.style.width=this.GCT3("TAB_NAV_INFO").width+"px"}else{this.fAEd.innerHTML="";this.fAEd.style.cursor="";this.fAEd.style.width="0px"}};this.$6_t4=function(){var p2736=this.P7uJ(false);if(p2736<0)p2736=0;this.vtXb.style.width=p2736+"px";this.vtXb.style.height=this.Qj4w_+"px"};this.tkl=function(){if(this.fAEd.firstChild)return this.fAEd.firstChild.offsetWidth>0;else return false};this.KKS7=function(){if(this.R38.firstChild)return this.R38.firstChild.offsetWidth>0;else return false};this.P7uJ=function(){var width=0;if(this.X24){if(this.X6285.length>0){var n0215=this.X6285;var HIsG=null;var Xy628=null;for(var i=n0215.length-1;i>=0;i--){HIsG=n0215[i];Xy628=HIsG.DBr6();if(Xy628&&Xy628.offsetTop==this.fAEd.offsetTop){break}}if(Xy628){if(HIsG.getIndex()==0&&Xy628.offsetTop!=this.fAEd.offsetTop)Xy628=this.fAEd;width=this.X24.parentNode.offsetWidth-Xy628.offsetLeft-Xy628.offsetWidth-this.R38.offsetWidth}}}return width};this.s7$2B=function(n0215){if(this.X24&&n0215.length>0){if(this.dom.rows[1].style.display=="none"){this.dom.rows[1].style.display=""}if(this.X24.style.display=="none"){this.X24.style.display=""}for(var i=0;i<n0215.length;i++){this.n367J(n0215[i])}this.$y96();var height=this.dom.rows[1].clientHeight;if(!isNaN(parseInt(this.dom.rows[1].style.paddingTop)))height-=parseInt(this.dom.rows[1].style.paddingTop);if(!isNaN(parseInt(this.dom.rows[1].style.paddingBottom)))height-=parseInt(this.dom.rows[1].style.paddingBottom);this.dom.rows[1].style.height=height+"px";this.w$3G=height;this.Qc5()}};this.$y96=function(){if(this.U4k==0){var Xy628=this.X6285[0].DBr6();var borderWidth=this.tabIndex==0?parseInt(Xy628.style.borderTopWidth):parseInt(Xy628.style.borderBottomWidth);if(isNaN(borderWidth))borderWidth=0;this.U4k=Xy628.offsetHeight-parseInt(Xy628.style.paddingTop)-borderWidth}this.fAEd.style.height=this.U4k+"px";this.fAEd.style.lineHeight=this.U4k+"px";this.R38.style.height=this.U4k+"px";this.R38.style.lineHeight=this.U4k+"px"};this.t$yC=function(HIsG){if(!HIsG.M2r())return;var dom=HIsG.DBr6();if(dom){var cx03={width:dom.style.width,height:dom.style.height};dom.style.cssText=this.GCT3("TAB_TEXT_BLUR");dom.style.width=cx03.width;dom.style.height=cx03.height;this.tabIndex=-1}};this.B1a$f=function(HIsG){var dom=HIsG.DBr6();if(dom){var cx03={width:dom.style.width,height:dom.style.height};dom.style.cssText=this.GCT3("TAB_TEXT_FOCUS");dom.style.width=cx03.width;dom.style.height=cx03.height;this.tabIndex=HIsG.getIndex();var content=HIsG.getContent();if(typeof content=="string"){this.G0063.innerHTML=content}else if(typeof content=="object"&&typeof content.tagName!="undefined"){this.G0063.innerHTML="";this.G0063.appendChild(content)}}};this.setCurrentTab=function(index){var n0215=this.X6285;if(this.tabIndex==index||n0215.length<=0||index<0||index>=n0215.length)return;if(this.tabIndex!=-1)this.t$yC(this.X6285[this.tabIndex]);var gS6=n0215[index];if(!gS6.M2r()){if(gS6.K70!=-1){this.GF5px=gS6.K70;for(var i=0;i<n0215.length;i++){var HIsG=n0215[i];if(HIsG.K70==gS6.K70){this.uk2(HIsG,true)}else{this.uk2(HIsG,false)}}this.F7t()}else{while(!gS6.M2r()){this.o747(null)}}}if(gS6.M2r()){this.B1a$f(gS6)}};this.u18P=function(e){if(!this.tkl())return;this.GF5px--;var n0215=this.X6285;var gS6=null;if(this.tabIndex!=-1)this.t$yC(this.X6285[this.tabIndex]);for(var i=n0215.length-1;i>=0;i--){var HIsG=n0215[i];if(HIsG.K70==this.GF5px){this.uk2(HIsG,true);gS6=HIsG}else{this.uk2(HIsG,false)}}this.F7t();this.setCurrentTab(gS6.getIndex())};this.o747=function(e){if(!this.KKS7())return;this.GF5px++;var n0215=this.X6285;var gS6=null;if(this.tabIndex!=-1)this.t$yC(this.X6285[this.tabIndex]);for(var i=0;i<n0215.length;i++){var HIsG=n0215[i];if(HIsG.getIndex()<=this.Lh9.getIndex()){if(HIsG.M2r())this.uk2(HIsG,false)}else{if(!HIsG.M2r()){if(!gS6)gS6=HIsG;this.uk2(HIsG,true)}}}this.F7t();if(gS6)this.setCurrentTab(gS6.getIndex())};this.y02=function(e){e=ny(e);if(e.target.tagName=="IMG"){this.setVisible(false);if(this.onClosed)this.onClosed()}};this.setVisible=function(visible){if(!this.dom)return;if(this.isVisible()==visible)return;this.dom.style.display=visible?"":"none";for(var i=0;i<this.M2aE5.length;i++){this.M2aE5[i].style.display=visible?"":"none"}if(!visible)this.u3p();this.Tm6Jq.style.display=visible?"":"none"};this.isVisible=function(){return this.dom&&this.dom.style.display!="none"};this.setZMBtnVisible=function(visible){if(this.S59()==visible)return;if(visible)this.UgwL6.style.width=this.GCT3("RT_BTN_TD_INFO").width+"px";else this.UgwL6.style.width="0px"};this.S59=function(){return this.UgwL6&&parseInt(this.UgwL6.style.width)!=0};this.N9O59=function(e){var index=e.target.getAttribute("tabIndex");if(index!=null)this.setCurrentTab(parseInt(index))};this.a6Ii=function(type){if(this.UgwL6&&this.L08.type!=type){this.L08.type=type;if(this.L08.type=="zoomin"){this.UgwL6.innerHTML=this.GCT3("ZOOMIN_IMG")}else{this.UgwL6.innerHTML=this.GCT3("ZOOMOUT_IMG")}this.Li8_()}};this.Li8_=function(){if(this.L08.q9)MEvent.removeBuiltInListener(this.UgwL6,"click",this.L08.q9);if(this.L08.type=="zoomin"){this.L08.q9=MEvent.bindDom(this.UgwL6,"click",this,this.w2r)}else if(this.L08.type=="zoomout"){this.L08.q9=MEvent.bindDom(this.UgwL6,"click",this,this.Jk7)}};this.w2r=function(e){e=ny(e);if(e.target.tagName=="IMG"){if(this.onZoomIn)this.onZoomIn()}};this.Jk7=function(e){e=ny(e);if(e.target.tagName=="IMG"){if(this.onZoomOut)this.onZoomOut()}};this.setTitle=function(title){if(this.o38Ea){this.o38Ea.innerHTML=title}};this.setContent=function(content){this.content=content;if(this.G0063){if(MEvent.contains(q43q0,"iw_setcontent")>0)MEvent.trigger(q43q0,"iw_setcontent",this.G0063);var v7Gb7=this.G0063.parentNode;_removeNode(this.G0063);this.G0063=this.Yx9();v7Gb7.appendChild(this.G0063);if(typeof content=="string")this.G0063.innerHTML=content;else if(typeof content=="object"&&typeof content.tagName!="undefined"){this.G0063.innerHTML="";this.G0063.appendChild(content)}if(this.X6285.length>0)this.X6285[0].setContent(content)}};this.e6x04=function(w,h){if(!this.bT9J())return;this.width=w;this.height=h;if(this.dom){this.dom.style.width=w+"px";this.dom.style.height=h+"px";this.Qc5()}};this.moveTo=function(x,y){if(!this.bT9J())return;this.x=x;this.y=y;this.dom.style.left=x+"px";this.dom.style.top=y+"px";for(var i=0;i<this.M2aE5.length;i++){var shadow=this.M2aE5[i];shadow.style.left=(this.x+3+((i)*3))+"px";shadow.style.top=(this.y+3+((i)*3))+"px"}};this.I72=function(H080){if(this.isVisible()){if((this.G0063.style.overflow=="hidden"?true:false)!=H080){this.G0063.style.overflow=H080?"hidden":"auto"}}};this.GCT3=function(name){return B99.oj_.TE4_2(name)};this.j6L0d=function(name,value){B99.oj_.CTI3(name,value)};this.finalize=function(){if(this._ic)MEvent.removeBuiltInListener(this.fAEd,"click",this._ic);if(this.M9Eum)MEvent.removeBuiltInListener(this.R38,"click",this.M9Eum);if(this.r38)MEvent.removeBuiltInListener(this.Ng44t,"click",this.r38);this.o5D7();_removeNode(this.dom);for(var i=0;i<this.M2aE5.length;i++){_removeNode(this.M2aE5[i])}_removeNode(this.Tm6Jq);_removeNode(this.DEs);M7e5S(this);B99.oj_.finalize()}};B99.oj_=new function(){var w6573=[];var i639=false;if(navigator.userAgent.indexOf(";")>=0){if(!window.XMLHttpRequest)i639=true}w6573["TIP_DEFAULT_INFO"]={width:300,height:300,f2_04:false,zIndex:100};w6573["COLOR"]="#81807f";w6573["TIP_TABLE_BORDER_COLOR"]="#0e347f";w6573["IMAGE_RESOURCE"]=CTLIMG_RESOURCE[0].url;w6573["IMAGE_RESOURCE_INFO"]={width:CTLIMG_RESOURCE[0].w,height:CTLIMG_RESOURCE[0].h};w6573["BLANK_IMG_SRC"]=strImgsvrUrl+"images/newbubbleimg/mbblank.gif";w6573["TIP_TABLE"]="position:absolute;border:2px solid "+w6573["TIP_TABLE_BORDER_COLOR"]+";background-color:#FFFFFF;display:none;spacing:10px;table-layout:fixed;overflow:hidden;z-index:"+w6573["TIP_DEFAULT_INFO"].zIndex+";";w6573["TIP_BORDER"]="position:absolute;background:white;z-index:99;";w6573["TITLE_CONTAINER_TD"]="";w6573["TITLE_TABLE"]="table-layout:fixed;margin-bottom:5px;margin-top:4px;";w6573["TITLE_TD"]="overflow:hidden;padding-left:4px;padding-top:2px;font-weight:bold;font-size:14px;";w6573["TITLE_SPACER"]="width:10px;-moz-user-select:none;-moz-user-focus:none;";var Lj9=function(w,h,x,y,_Vbk){if(typeof _Vbk!="string")_Vbk="";var s="<div style=\"position:absolute;width:"+w+"px;height:"+h+"px;overflow:hidden;-moz-user-select:none;-moz-user-focus:none;"+_Vbk+"\">";if(i639){s+="<img src=\""+w6573["BLANK_IMG_SRC"]+"\" style=\"position:absolute;left:"+x+"px;top:"+y+"px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+w6573["IMAGE_RESOURCE"]+",sizingMethod=scale);width:"+w6573["IMAGE_RESOURCE_INFO"].width+"px;height:"+w6573["IMAGE_RESOURCE_INFO"].height+"px;\">"}else{s+="<img src=\""+w6573["IMAGE_RESOURCE"]+"\" style=\"position:absolute;left:"+x+"px;top:"+y+"px;\">"}s+="</div>";return s};w6573["RT_BTN_TD_INFO"]={width:18};w6573["RT_BTN_TD"]="width:"+w6573["RT_BTN_TD_INFO"].width+"px";w6573["RT_BTN_IMG_INFO"]={width:12,height:12};w6573["CLOSE_IMG"]=Lj9(w6573["RT_BTN_IMG_INFO"].width,w6573["RT_BTN_IMG_INFO"].height,-64,-51,"cursor:pointer;");w6573["ZOOMIN_IMG"]=Lj9(w6573["RT_BTN_IMG_INFO"].width,w6573["RT_BTN_IMG_INFO"].height,-42,-51,"cursor:pointer;");w6573["ZOOMOUT_IMG"]=Lj9(w6573["RT_BTN_IMG_INFO"].width,w6573["RT_BTN_IMG_INFO"].height,-53,-51,"cursor:pointer;");w6573["SHADOW_COLOR"]=w6573["COLOR"];w6573["SHADOW_AMOUNT"]=2;w6573["SHADOW_OPACITY"]=[0.5,0.3];w6573["SHADOW_DIV"]="position:absolute;background-color:"+w6573["SHADOW_COLOR"]+";display:none;";w6573["TAB_AMOUNT"]=5;w6573["TAB_DEFAULT_LABEL"]="\u4e3b\u8981";w6573["TAB_TD"]="-moz-user-select:none;-moz-user-focus:none;";w6573["TAB_CONTAINER"]="list-style-type:none;margin:0px;padding:0px;overflow:hidden;";w6573["TAB_LINE"]="1px solid "+w6573["COLOR"]+";";w6573["TAB_TEXT_COMMON"]="float:left;cursor:pointer;white-space:nowrap;overflow:hidden;outline:none;font-size:12px;padding-bottom:4px;";w6573["TAB_TEXT_FOCUS"]=w6573["TAB_TEXT_COMMON"]+"border-top:"+w6573["TAB_LINE"]+";border-left:"+w6573["TAB_LINE"]+";border-right:"+w6573["TAB_LINE"]+";padding-top:5px;padding-left:4px;padding-right:4px;";w6573["TAB_TEXT_BLUR"]=w6573["TAB_TEXT_COMMON"]+"border-bottom:"+w6573["TAB_LINE"]+"padding-top:5px;padding-left:5px;padding-right:5px;";w6573["TAB_SPACER"]="float:left;border-bottom:"+w6573["TAB_LINE"];w6573["TAB_NAV_INFO"]={width:10,height:10};w6573["TAB_NAV_LR_COMMON"]="float:left;padding-top:5px;padding-left:4px;padding-right:4px;border-bottom:"+w6573["TAB_LINE"]+";";w6573["TAB_NAV_L"]=w6573["TAB_NAV_LR_COMMON"];w6573["TAB_NAV_R"]=w6573["TAB_NAV_LR_COMMON"]+"float:right;";w6573["TAB_NAV_L_CHILD"]=Lj9(w6573["TAB_NAV_INFO"].width,w6573["TAB_NAV_INFO"].height,-66,-160);w6573["TAB_NAV_R_CHILD"]=Lj9(w6573["TAB_NAV_INFO"].width,w6573["TAB_NAV_INFO"].height,-66,-148);w6573["CONTENT_TD"]="";w6573["CONTENT_DIV"]="position:relative;padding:5px;width:100%;height:100%;overflow:auto;word-break: break-all;";w6573["ARROW_INFO"]={t2Kb:15,CSs7:23,lB5:23,A6F81:15,zIndex:w6573["TIP_DEFAULT_INFO"].zIndex+1};w6573["ARROW_DIV"]="position:absolute;top:0px;left:0px;width:"+w6573["ARROW_INFO"].width+"px;height:"+w6573["ARROW_INFO"].height+"px;display:none;z-index:"+w6573["ARROW_INFO"].zIndex+";-moz-user-select:none;-moz-user-focus:none;";w6573["ARROW_TOP_CHILD"]=Lj9(w6573["ARROW_INFO"].lB5,w6573["ARROW_INFO"].A6F81,-43,-177);w6573["ARROW_BOTTOM_CHILD"]=Lj9(w6573["ARROW_INFO"].lB5,w6573["ARROW_INFO"].A6F81,-43,-192);w6573["ARROW_LEFT_CHILD"]=Lj9(w6573["ARROW_INFO"].t2Kb,w6573["ARROW_INFO"].CSs7,-61,-124);w6573["ARROW_RIGHT_CHILD"]=Lj9(w6573["ARROW_INFO"].t2Kb,w6573["ARROW_INFO"].CSs7,-25,-178);this.CTI3=function(name,value){if(typeof w6573[name]!="undefined")w6573[name]=value};this.TE4_2=function(name){return w6573[name]};this.finalize=function(){M7e5S(w6573);w6573=null}};var MPanel=function(options){this.initialize=function(maplet){this.maplet=maplet;this.paint()};this.setLocation=function(options,paint){if(typeof paint!="boolean")paint=true;this.location=options||{};with(this.location){if(typeof pt!="object"||!(pt instanceof MPoint)||!pt)this.location.pt=null;if(typeof type!="string"||!type||(type=="latlon"&&!pt))this.location.type="xy";if(typeof x!="number")this.location.x=0;if(typeof y!="number")this.location.y=0;if(type=="latlon"&&pt&&!pt.maplet&&this.maplet)pt.initialize(this.maplet)}this.options.location=this.location;if(paint)this.paint()};this.setContent=function(c){if(typeof c!="undefined"&&c){if(typeof c=="string"){this.dom.innerHTML=c}else if(typeof c=="object"){this.dom.appendChild(c)}}else{c=null;this.dom.innerHTML=""}this.options.content=c};this.setMouseWheel=function(enable){if(typeof enable!="boolean")enable=true;if(this.dom)this.dom.setAttribute(_56,!enable);this.options.mousewheel=enable};this.setZoomHide=function(hide){if(typeof hide!="boolean")hide=false;this.options.zoomhide=hide};this.setCreator=function(f45J_){if(typeof f45J_!="number"||(f45J_!=MPanel.USER&&f45J_!=MPanel.SYSTEM))f45J_=MPanel.USER;this.options.creator=f45J_};this.setPin=function(p,paint){if(typeof p!="boolean")p=false;if(typeof paint!="boolean")paint=true;this.options.pin=p;if(!p&&typeof this.location!="undefined"&&this.location.pt){this.location.type="xy";this.location.pt=null}if(paint)this.paint()};this.setContainer=function(c){if(typeof c!="object"||!c)c=null;this.options.container=c};this.setZIndex=function(i){if(typeof i!="number")i=this.options.pin?200:2;this.dom.style.zIndex=i;this.options.zindex=i};this.paint=function(){if(!this.dom||!this.maplet)return;if(this.options.container){if(this.dom.parentNode!=this.options.container)this.options.container.appendChild(this.dom)}else{if(this.options.pin){if(this.dom.parentNode!=this.maplet.sF.div)this.maplet.sF.div.appendChild(this.dom)}else{if(this.dom.parentNode!=this.maplet.panel)this.maplet.panel.appendChild(this.dom)}}with(this.location){if(this.options.pin||type=="latlon"){if(typeof pt=="undefined"||!pt)pt=new MPoint(this.maplet.toMapCoordinate(x,y));if(!pt.maplet){pt.initialize(this.maplet)}else if(this.options.pin){if(this.maplet._67R){if(this.maplet.O71Wl!=pt.O71Wl){pt.mapX+=this.maplet.tJW3;pt.mapY+=this.maplet.R8G;pt.O71Wl=this.maplet.O71Wl}}else{pt.recalcScreenCoords()}}x=pt.mapX;y=pt.mapY}this.dom.style.left=x+"px";this.dom.style.top=y+"px"}};this.show=function(){this.setVisible(true);this.LN$4.t93=false};this.hide=function(){this.setVisible(false);this.LN$4.t93=true};this.setVisible=function(visible){if(!this.dom)return;if(this.dom.style.display!=(visible?"":"none"))this.dom.style.display=visible?"":"none"};this.isVisible=function(){return this.dom.style.display==""};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.dom){if(!finalize){if(this.dom.parentNode)this.dom.parentNode.removeChild(this.dom)}else{_removeNode(this.dom);this.dom=null}}this.maplet=null};this.clone=function(){return new MPanel({pin:this.options.pin,parent:this.options.parent,zindex:this.options.zindex,content:this.options.content,location:this.location,mousewheel:this.options.mousewheel,zoomhide:this.options.zoomhide,creator:this.options.creator})};this.toString=function(){return 'com.mapbar.maplet.MPanel'};this.id="panel"+MPanel.JJNV;MPanel.JJNV++;this.maplet=null;this.dom=document.createElement("DIV");this.dom.style.position="absolute";this.LN$4={t93:false};this.options=options||{};with(this.options){this.setPin(typeof pin!="undefined"?pin:undefined,false);this.setContainer(typeof container!="undefined"?container:undefined);this.setZIndex(typeof zindex!="undefined"?zindex:undefined);this.setContent(typeof content!="undefined"?content:undefined);this.setLocation(typeof location!="undefined"?location:undefined,false);this.setMouseWheel(typeof mousewheel!="undefined"?mousewheel:undefined);this.setZoomHide(typeof zoomhide!="undefined"?zoomhide:undefined);this.setCreator(typeof creator!="undefined"?creator:undefined)}};MPanel.enableDragMap=function(dom,enable,D3$L){if(typeof enable!="boolean")enable=true;if(enable)pps(dom,_Fj3O,"true",D3$L);else o110(dom,_Fj3O)};MPanel.USER=1;MPanel.SYSTEM=2;MPanel.JJNV=0;var MLayer=function(options){this.initialize=function(maplet){this.maplet=maplet;this.paint()};this.setServerPath=function(path){if(typeof path!="string"||!path)path="";this.options.serverPath=path};this.setZIndex=function(i){if(typeof i!="number")i=0;this.dom.style.zIndex=i;this.options.zindex=i;if(this.maplet){this.maplet.V$R(this)}};this.setImgType=function(type){if(typeof type!="string"||!type)type="png";this.options.imgType=type.toLowerCase()};this.setDataType=function(type){if(typeof type!="string"||!type)type="js";this.options.dataType=type};this.setDataPattern=function($31_){if(typeof $31_!="string"||!$31_)$31_="data"+MLayer.DPLACEHOLDER;this.options.dataPattern=$31_};this.setImgWidth=function(w){if(typeof w!="number"||w<=0)w=5;this.options.imgWidth=w;this.vhm8=Math.ceil(w/2)};this.setImgHeight=function(h){if(typeof h!="number"||h<=0)h=5;this.options.imgHeight=h;this.TELU=Math.ceil(h/2)};this.setLevelRange=function(min,max,refresh){if(typeof min!="number"||min<MIN_ZOOM_LEVEL||min>MAX_ZOOM_LEVEL)min=MIN_ZOOM_LEVEL;if(typeof max!="number"||max<MIN_ZOOM_LEVEL||max>MAX_ZOOM_LEVEL)max=MAX_ZOOM_LEVEL;this.options.minLevel=min;this.options.maxLevel=max;if(typeof refresh!="boolean")refresh=true;if(refresh)this.update()};this.setNeedData=function(u149v,V14){if(typeof u149v!="boolean")u149v=false;if(typeof V14!="boolean")V14=true;var E$2=this.options.needData;this.options.needData=u149v;if(V14&&this.options.needData!=E$2){if(E$2){this.clearData()}else{$_5j.apply(this)}}};this.setCreator=function(f45J_){if(typeof f45J_!="JK8qq"||(f45J_!=MLayer.USER&&f45J_!=MLayer.SYSTEM))f45J_=MLayer.USER;this.options.creator=f45J_};this.setImgUrlPreprocessor=function(OM0){OM0=OM0||{};if(typeof OM0.fun!="function"||!OM0.fun)OM0.fun=null;if(typeof OM0.thisObj!="object"||!OM0.thisObj)OM0.thisObj=null;this.options.imgUrlPreprocessor=OM0};this.setDataUrlPreprocessor=function(OM0){OM0=OM0||{};if(typeof OM0.fun!="function"||!OM0.fun)OM0.fun=null;if(typeof OM0.thisObj!="object"||!OM0.thisObj)OM0.thisObj=null;this.options.dataUrlPreprocessor=OM0};this.setFireEvent=function(X6L0_){if(typeof X6L0_!="number")X6L0_=MLayer.ALL;this.options.events=X6L0_};this.hhN59=function(mouseover){mouseover=mouseover||{};if(typeof mouseover.fun!="function"||!mouseover.fun)mouseover.fun=null;if(typeof mouseover.thisObj!="object"||!mouseover.thisObj)mouseover.thisObj=null;this.options.mouseover=mouseover};this.Yn1dC=function(mouseout){mouseout=mouseout||{};if(typeof mouseout.fun!="function"||!mouseout.fun)mouseout.fun=null;if(typeof mouseout.thisObj!="object"||!mouseout.thisObj)mouseout.thisObj=null;this.options.mouseout=mouseout};this.C28j7=function(click){click=click||{};if(typeof click.fun!="function"||!click.fun)click.fun=null;if(typeof click.thisObj!="object"||!click.thisObj)click.thisObj=null;this.options.click=click};this.setDataLoadMode=function(mode){if(typeof mode!="number"||(mode!=MLayer.DL_INITIATIVE&&mode!=MLayer.DL_PASSIVE))mode=MLayer.DL_INITIATIVE;this.options.dataLoadMode=mode};this.o7AS=function(id,uy){var layerData=this.maplet.layerData[id];if(typeof layerData=="object"&&layerData&&I41(uy)&&uy.length>0){this.data[id]=uy;var p1=layerData.x;var p3=layerData.y;for(var i=0;i<uy.length;i++){var item=uy[i];item.grid=id;var zB=p1+item.r.i.x;var zF=p3+item.r.i.y;item.rect={min:{x:zB,y:zF},max:{x:zB+item.r.a.x,y:zF+item.r.a.y}};rWL.apply(this,[item])}uy=null}};this.d666=function(){return this.options.dataPattern.replace(MLayer.DPLACEHOLDER,"")};this.setServerPathType=function(type){if(typeof type!="number"||(type!=MLayer.PT_NORMAL&&type!=MLayer.PT_COMBINER))type=MLayer.PT_NORMAL;this.options.serverPathType=type};this.setCombinerParas=function(pfy){if(typeof pfy!="string")pfy="";this.options.combinerParas=pfy};this.enableNPS=function(enable){if(typeof enable!="boolean")enable=false;this.options.nps=enable};this.getFilename=function(sYCT8,grid){var e1tK="";if(this.maplet){if(typeof grid=="string")grid=this.maplet.layerData[grid];if(typeof grid=="object"&&grid){e1tK=sI[this.maplet.AG]+"/"+(this.options.nps&&this.maplet.AG>=14?grid.dirx+"/":"")+grid.dirname+"/"+grid.xyname+"."+(sYCT8?this.options.imgType:this.options.dataType)}}return e1tK};this.enableSafeLevel=function(enable){if(typeof enable!="boolean")enable=false;this.options.safeLevel=enable};this.setTip=function(tip,refresh){tip=tip||{};if(typeof tip.mode!="number"||(tip.mode&MLayer.TM_ALWAYS!=MLayer.TM_ALWAYS&&tip.mode&MLayer.TM_MOUSEOVER!=MLayer.TM_MOUSEOVER))tip.mode=MLayer.TM_NEVER;if(typeof tip.otiLevel!="number"||tip.otiLevel<MIN_ZOOM_LEVEL||tip.otiLevel>MAX_ZOOM_LEVEL)tip.otiLevel=MIN_ZOOM_LEVEL;if(typeof tip.otaLevel!="number"||tip.otaLevel<MIN_ZOOM_LEVEL||tip.otaLevel>MAX_ZOOM_LEVEL)tip.otaLevel=MAX_ZOOM_LEVEL;if(typeof tip.atiLevel!="number"||tip.atiLevel<MIN_ZOOM_LEVEL||tip.atiLevel>MAX_ZOOM_LEVEL)tip.atiLevel=MIN_ZOOM_LEVEL;if(typeof tip.ataLevel!="number"||tip.ataLevel<MIN_ZOOM_LEVEL||tip.ataLevel>MAX_ZOOM_LEVEL)tip.ataLevel=MAX_ZOOM_LEVEL;this.options.tip=tip;if(typeof refresh!="boolean")refresh=true;if(refresh)this.refreshTip()};this.refreshTip=function(){for(var i in this.data)b5C2.apply(this,[this.data[i]])};var b5C2=function(grid){if(typeof grid!="object"||!grid)return;for(var i=0;i<grid.length;i++)rWL.apply(this,[grid[i]])};var rWL=function(data){if(typeof data!="object"||!data||!data.n)return;var b=Yl_8.apply(this,[true,true]);var q1o=D75V.apply(this,[data]);if(b&&!data.tip&&q1o){this.wR(data)}else if(data.tip&&(!b||!q1o)){H1MT6.apply(this,[data])}};this.setNeedImg=function(u149v,V14){if(typeof u149v!="boolean")u149v=true;if(typeof V14!="boolean")V14=true;var E$2=this.options.needImg;this.options.needImg=u149v;if(V14&&this.options.needImg!=E$2){if(E$2){this.clearImgs()}else{$_5j.apply(this)}}};this.inZoomRange=function(AB){if(AB>=this.options.minLevel&&AB<=this.options.maxLevel)return true;else return false};this.paint=function(){if(!this.dom||!this.maplet)return;if(!this.maplet.Mv24)this.maplet.D4oF();if(this.dom.parentNode!=this.maplet.Mv24){this.resize(this.maplet.width,this.maplet.height);this.maplet.Mv24.appendChild(this.dom)}};var njl86=function(data,iY89){if(typeof data.n205F=="undefined")data.n205F=iY89;else data.n205F=iY89};var T$3=function(data){return typeof data.n205F=="undefined"||data.n205F};var j971A=function(){for(var i in this.data)njl86.apply(this,[this.data[i],false])};var M95=function(){for(var i in this.data){if(!T$3.apply(this,[this.data[i]]))M92.apply(this,[i])}};var yw3O=function(img,jF28){img.setAttribute($E8,jF28?"yes":"no")};var P6o2=function(){for(var i in this.syT)yw3O.apply(this,[this.syT[i],false])};var o823=function(img){return img.getAttribute($E8)=="yes"};var AVwM=function(){for(var i in this.syT){if(!o823.apply(this,[this.syT[i]]))j0XY.apply(this,[i])}};var j0XY=function(id){if(typeof this.syT[id]=="object"){var img=this.syT[id];img.onload=null;img.onerror=null;_removeNode(img);img=null;delete this.syT[id]}};var M92=function(id){if(typeof this.data[id]=="object"){if(this.syT[id]&&this.syT[id].getAttribute(MLayer.U74)){this.syT[id].removeAttribute(MLayer.U74)}for(var i=0;i<this.data[id].length;i++){H1MT6.apply(this,[this.data[id][i]])}if(cvj&&cvj.grid==id){wuC.apply(this);cvj=null}this.data[id]=null;delete this.data[id]}};var H1MT6=function(data){if(!this.maplet||!data||!data.tip)return;this.maplet.removePanel(data.tip,true);data.tip=null;if(mA866[data.p])delete mA866[data.p]};this.update=function(){if(!this.dom||!this.maplet)return;if(!this.inZoomRange(this.maplet.AG)){this.clear();return}$_5j.apply(this)};this.refresh=function(){if(!this.dom||!this.maplet)return;this.clear();$_5j.apply(this)};var $_5j=function(){if(!this.isVisible()||!this.inZoomRange(this.maplet.AG))return;j971A.apply(this);P6o2.apply(this);for(var i in this.maplet.layerData){var item=this.maplet.layerData[i];if(item.x+this.maplet.imgWidth<0||item.x>this.maplet.width||item.y+this.maplet.imgHeight<0||(item.y+(this.options.safeLevel?w8[this.maplet.AG]:0))>this.maplet.height)continue;if(this.options.needImg){var img=this.syT[i];if(typeof img!="object"||!img){img=document.createElement("IMG");img.style.position="absolute";img.setAttribute("unselectable","on");img.style.MozUserSelect="none";img.setAttribute(_Fj3O,"true");img.setAttribute(_X6IT,"yes");img.onerror=function(thisObj,id){return function(){Vc554.apply(thisObj,[id])}}(this,i);img.onload=function(thisObj,id){return function(){eOj.apply(thisObj,[id])}}(this,i);this.syT[i]=img}yw3O.apply(this,[img,true]);img.style.left=item.x+"px";img.style.top=item.y+(this.options.safeLevel?w8[this.maplet.AG]:0)+"px";if(!img.src&&img.tagName!="DIV"){var src="";var filename=this.getFilename(true,item);if(this.options.imgUrlPreprocessor.fun){src=this.options.imgUrlPreprocessor.fun.apply(this.options.imgUrlPreprocessor.thisObj,[item]);if(!src)continue}else if(this.options.serverPathType==MLayer.PT_COMBINER){src+=K917.apply(this,[this.options.serverPath,item.Xn1,item.yNj39]);src+=(this.options.serverPath.indexOf("?")!=-1?"&":"?")+"n="+this.options.combinerParas;src+="&p="+filename;src+="&g="+item.grid}else{src=K917.apply(this,[this.options.serverPath,item.Xn1,item.yNj39])+filename}img.src=src}else{O1m8.apply(this,[i])}}else{O1m8.apply(this,[i])}}AVwM.apply(this);M95.apply(this)};var K917=function(path,Xn1,yNj39){var pp2$="img.mapbar.com";if(strImgsvrUrl.substring(7,21)==pp2$){return path.replace(pp2$,"img"+this.maplet.b284(Xn1,yNj39)+".mapbar.com")}else{return path}};var Vc554=function(id){j0XY.apply(this,[id])};var eOj=function(id){var img=this.syT[id];if(typeof img!="undefined"&&img){if(img.width<=1||img.height<=1){j0XY.apply(this,[id]);return}img.onerror=null;img.onload=null;if(i639&&this.options.imgType=="png"){var d=document.createElement("DIV");d.style.position="absolute";d.style.width=this.maplet.imgWidth+"px";d.style.height=this.maplet.imgHeight+"px";d.style.left=img.style.left;d.style.top=img.style.top;d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+img.src+",sizingMethod=scale);";d.style.MozUserSelect="none";d.setAttribute("unselectable","on");d.setAttribute(_Fj3O,"true");d.setAttribute(_X6IT,"yes");yw3O.apply(this,[d,true]);this.dom.appendChild(d);j0XY.apply(this,[id]);this.syT[id]=d}else{this.dom.appendChild(img)}O1m8.apply(this,[id])}};this.refreshDataXY=function(){if(!this.options.needData)return;for(var id in this.data){var uy=this.data[id];for(var i=0;i<uy.length;i++){var item=uy[i];var zB=this.maplet.layerData[id].x+item.r.i.x;var zF=this.maplet.layerData[id].y+item.r.i.y;item.rect.min.x=zB;item.rect.min.y=zF;item.rect.max.x=zB+item.r.a.x;item.rect.max.y=zF+item.r.a.y}}};var O1m8=function(id){if(!this.options.needData)return;var img=this.syT[id];if(!this.options.needImg||(typeof img=="object"&&img&&((typeof img.src!="undefined"&&img.src!=sX)||(i639&&this.options.imgType=="png")))){if(!this.data[id]&&typeof this.maplet.layerData[id]=="object"){if(this.options.dataLoadMode==MLayer.DL_PASSIVE)return;if(img){if(img.getAttribute(MLayer.U74))return;else img.setAttribute(MLayer.U74,true)}var item=this.maplet.layerData[id];var src="";var filename=this.getFilename(false,item);if(this.options.dataUrlPreprocessor.fun){src=this.options.dataUrlPreprocessor.fun.apply(this.options.dataUrlPreprocessor.thisObj,[item]);if(!src)return}else{src=K917.apply(this,[this.options.serverPath,item.Xn1,item.yNj39])+filename}new SwF6(src,$99,false,true,this,undefined,[id]).e0b()}else{var uy=this.data[id];var layerData=this.maplet.layerData[id];if(typeof uy=="undefined"||!uy||typeof layerData=="undefined"||!layerData)return;njl86.apply(this,[uy,true]);var p1=layerData.x;var p3=layerData.y;for(var i=0;i<uy.length;i++){var item=uy[i];item.rect.min.x=p1+item.r.i.x;item.rect.min.y=p3+item.r.i.y;item.rect.max.x=item.rect.min.x+item.r.a.x;item.rect.max.y=item.rect.min.y+item.r.a.y;rWL.apply(this,[item])}}}};var $99=function(id,uH0){if(typeof this.maplet=="object"&&this.maplet&&typeof this.maplet.layerData=="object"&&this.maplet.layerData){if(typeof this.maplet.layerData[id]=="undefined"||!this.maplet.layerData[id])return;var layerData=this.maplet.layerData[id];var dY5=this.options.dataPattern.replace(MLayer.DPLACEHOLDER,layerData.dirname+"_"+layerData.xyname);var uy=eval("typeof "+dY5+"==\"undefined\"?null:"+dY5);this.o7AS(id,uy)}_removeNode(aa(uH0))};this.getDataByXY=function(id,x,y,B366){if(typeof B366!="boolean")B366=false;if(this.data[id]){var pt={x:x,y:y};for(var i=0;i<this.data[id].length;i++){if(_isInsideRect(pt,this.data[id][i].rect)){var d=this.data[id][i];if(B366){if(d.c.length>0){var r=d.rect;var p1=this.maplet.layerData[id].x;var p3=this.maplet.layerData[id].y;for(var HB3=0;HB3<d.c.length;HB3++){var c=d.c[HB3];var ix=p1+c.i.x;var iy=p3+c.i.y;var SS0D={min:{x:ix,y:iy},max:{x:ix+c.a.x,y:iy+c.a.y}};if(_isInsideRect(pt,SS0D)){d=this.data[id][c.f]}}}}return d}}}return null};this.i70Y=function(id,x,y){if(!this.isVisible())return null;var d=this.getDataByXY(id,x,y,E4d69.apply(this,[true,true]));var JIM=true;if(this.options.mouseout.fun)wuC.apply(this,[d]);if(this.options.mouseover.fun&&d){JIM=K820.apply(this,[d])}if(d&&JIM){this.maplet.q453("pointer",this.maplet.panel)}cvj=d;if(this.options.mouseover.fun)return null;if(d&&E4d69.apply(this,[true,true])&&!Yl_8.apply(this,[true,true])&&d.n){this.wR(d)}else{this.We28O()}return d};var K820=function(d){var S99g=true;if(this.options.mouseover.fun){if(!cvj||cvj!=d){S99g=this.options.mouseover.fun.apply(this.options.mouseover.thisObj,[d]);e957=S99g}else{S99g=e957}}return S99g};var wuC=function(d){if(this.options.mouseout.fun&&cvj&&(cvj!=d||!d)){this.options.mouseout.fun.apply(this.options.mouseout.thisObj,[cvj])}};var E4d69=function(jO05,Y2i2){with(this.options.tip){return(!jO05||(mode&MLayer.TM_MOUSEOVER)==MLayer.TM_MOUSEOVER)&&(!Y2i2||(this.maplet.AG>=otiLevel&&this.maplet.AG<=otaLevel))}};var Yl_8=function(jO05,Y2i2){if(this.options.dataLoadMode!=MLayer.DL_INITIATIVE)return;with(this.options.tip){return(!jO05||(mode&MLayer.TM_ALWAYS)==MLayer.TM_ALWAYS)&&(!Y2i2||(this.maplet.AG>=atiLevel&&this.maplet.AG<=ataLevel))}};this.wR=function(data){if(E4d69.apply(this,[true,true])&&!Yl_8.apply(this,[true,true])){if(!vL42){this.maplet.addPanel(MLayer.TIPANEL);vL42=aa(MLayer.TIPID)}if(isI5!=data||(isI5==data&&!MLayer.TIPANEL.isVisible())){isI5=data;vL42.innerHTML=data.n;MLayer.TIPANEL.dom.style.visibility="hidden";MLayer.TIPANEL.show();var _jo9L=l0g.apply(this,[data]);MLayer.TIPANEL.setLocation({type:"xy",x:_jo9L.x,y:_jo9L.y});MLayer.TIPANEL.dom.style.visibility="visible"}}else if(Yl_8.apply(this,[true,true])&&data&&data.n){if(data.p&&mA866[data.p])return;mA866[data.p]=true;data.tip=MLayer.TIPANEL2.clone();data.tip.setContainer(this.maplet.Mv24.div);var n=data.n;if(n.length>8){n=data.n.substring(0,8)+"...";data.tip.dom.title=data.n}data.tip.setContent(data.tip.options.content.replace(MLayer.TPLACEHOLDER,n));data.tip.dom.firstChild.setAttribute(_Fj3O,"true");data.tip.dom.style.visibility="hidden";this.maplet.addPanel(data.tip);var _jo9L=l0g.apply(this,[data]);data.tip.setLocation({type:"xy",x:_jo9L.x,y:_jo9L.y});data.tip.dom.style.visibility="visible"}};this.We28O=function(){if(MLayer.TIPANEL.maplet&&isI5){isI5=null;MLayer.TIPANEL.hide()}};var D75V=function(data){return _isRectint(data.rect,{min:{x:0,y:0},max:{x:this.maplet.width,y:this.maplet.height}})};var l0g=function(data,size){var tip=MLayer.TIPANEL.dom;if(Yl_8.apply(this,[true,true]))tip=data.tip.dom;var _jo9L={x:0,y:0};var ix=data.rect.min.x;var iy=data.rect.min.y;var ax=data.rect.max.x;var ay=data.rect.max.y;var L14J8=tip.offsetWidth;var th=tip.offsetHeight;if(E4d69.apply(this,[true,true])){if(ax+2+L14J8<=this.maplet.width-5){_jo9L.x=ax+2;_jo9L.y=iy+(ay-iy)/2-th/2}else{_jo9L.x=ix-L14J8-2;_jo9L.y=iy+(ay-iy)/2-th/2}}else{_jo9L.x=ax+2;_jo9L.y=iy+(ay-iy)/2-th/2}return _jo9L};this.click=function(id,x,y){var S99g={center2map:true,firevent:false,data:null};if(this.isVisible()&&(this.options.click.fun||this.options.events&MLayer.CLICK==MLayer.CLICK)){S99g.data=this.getDataByXY(id,x,y,true);if(S99g.data){if(this.options.click.fun){var uw52=this.options.click.fun.apply(this.options.click.thisObj,[S99g.data]);S99g.center2map=uw52.center2map;S99g.firevent=uw52.firevent}else{S99g.firevent=true}}}return S99g};this.clearImgs=function(){for(var i in this.syT){j0XY.apply(this,[i])}};this.clearData=function(){for(var i in this.data){M92.apply(this,[i])}};this.clear=function(){this.clearImgs();this.clearData();if(!this.dom)return;this.dom.innerHTML=""};this.getImgCount=function(sw61){var c=0;if(this.isVisible()&&this.maplet&&this.inZoomRange(this.maplet.AG))for(var i in this.syT)c++;return c};this.resize=function(w,h){if(!this.dom)return;if(U5402(this.dom.style.width,0)!=w)this.dom.style.width=(w-1)+"px";if(U5402(this.dom.style.height,0)!=h)this.dom.style.height=(h-2)+"px"};this.show=function(){var E$2=this.isVisible();this.setVisible(true);if(!E$2)$_5j.apply(this)};this.hide=function(){var E$2=this.isVisible();this.setVisible(false);if(E$2)this.clear()};this.setVisible=function(visible){if(!this.dom)return;if(this.dom.style.display!=(visible?"":"Vh96"))this.dom.style.display=visible?"":"none"};this.isVisible=function(){return this.dom&&this.dom.parentNode==this.maplet.Mv24.div&&this.dom.style.display!="none"};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;this.clear();if(this.dom){if(!finalize){if(this.dom.parentNode)this.dom.parentNode.removeChild(this.dom)}else{_removeNode(this.dom);this.dom=null}}if(this.options.imgUrlPreprocessor.thisObj)this.options.imgUrlPreprocessor.thisObj=null;if(this.options.dataUrlPreprocessor.thisObj)this.options.dataUrlPreprocessor.thisObj=null;if(this.options.mouseover.thisObj)this.options.mouseover.thisObj=null;if(this.options.mouseout.thisObj)this.options.mouseout.thisObj=null;if(this.options.click.thisObj)this.options.click.thisObj=null;this.maplet=null};this.toString=function(){return 'com.mapbar.maplet.MLayer'};this.id=new Date().getTime()+"_layer";this.maplet=null;this.dom=document.createElement("DIV");this.dom.style.position="absolute";this.syT={};this.data={};this.vhm8=0;this.TELU=0;var $E8="_using";var isI5=null;var vL42=null;var mA866={};var cvj=null;var e957=false;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined);this.setZIndex(typeof zindex!="undefined"?zindex:undefined);this.setImgType(typeof imgType!="undefined"?imgType:undefined);this.setDataType(typeof dataType!="undefined"?dataType:undefined);this.setDataPattern(typeof dataPattern!="undefined"?dataPattern:undefined);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined),false);this.setImgWidth(typeof imgWidth!="undefined"?imgWidth:undefined);this.setImgHeight(typeof imgHeight!="undefined"?imgHeight:undefined);this.setNeedData(typeof needData!="undefined"?needData:undefined,false);this.setNeedImg(typeof needImg!="undefined"?needImg:undefined,false);this.setCreator(typeof creator!="undefined"?creator:undefined);this.setImgUrlPreprocessor(typeof imgUrlPreprocessor!="undefined"?imgUrlPreprocessor:undefined);this.setDataUrlPreprocessor(typeof dataUrlPreprocessor!="undefined"?dataUrlPreprocessor:undefined);this.setFireEvent(typeof events!="undefined"?events:undefined);this.setTip(typeof tip!="undefined"?tip:undefined,false);this.hhN59(typeof mouseover!="undefined"?mouseover:undefined);this.Yn1dC(typeof mouseout!="undefined"?mouseout:undefined);this.C28j7(typeof click!="undefined"?click:undefined);this.setDataLoadMode(typeof dataLoadMode!="undefined"?dataLoadMode:undefined);this.setServerPathType(typeof serverPathType!="undefined"?serverPathType:undefined);this.setCombinerParas(typeof combinerParas!="undefined"?combinerParas:undefined);this.enableNPS(typeof nps!="undefined"?nps:undefined);this.enableSafeLevel(typeof safeLevel!="undefined"?safeLevel:undefined)}};MLayer.USER=1;MLayer.SYSTEM=2;MLayer.DPLACEHOLDER="[xyname]";MLayer.NONE=0;MLayer.CLICK=1;MLayer.MOUSEMOVE=2;MLayer.ALL=255;MLayer.TM_NEVER=1;MLayer.TM_ALWAYS=2;MLayer.TM_MOUSEOVER=4;MLayer.TIPID="_map_layertip";MLayer.TIPANEL=new MPanel({pin:true,location:{type:"xy"},content:"<div id='"+MLayer.TIPID+"' style='border:1px solid gray;background:white;padding:1px 3px;padding:2px 3px 0\a;font-size:13px;line-height:17px;color:gray;' onmouseover='MLayer.setTipVisible(false);'></div>",creator:MPanel.SYSTEM});MLayer.TPLACEHOLDER="[TPLACEHOLDER]";MLayer.TIPANEL2=new MPanel({pin:true,location:{type:"xy",x:0,y:0},content:"<div style='border:1px solid gray;background:white;padding:1px 3px;padding:2px 3px 0\a;font-size:12px;color:gray;white-space:nowrap;' unselectable='on'>"+MLayer.TPLACEHOLDER+"</div>",creator:MPanel.SYSTEM});MLayer.setTipVisible=function(visible){if(MLayer.TIPANEL.maplet)MLayer.TIPANEL.setVisible(visible)};MLayer.U74="_loadingdata";MLayer.DL_INITIATIVE=1;MLayer.DL_PASSIVE=2;MLayer.PT_NORMAL=1;MLayer.PT_COMBINER=2;var MTraffic=function(options){this.initialize=function(maplet){this.maplet=maplet;this.layer=new MLayer({serverPath:this.options.serverPath,zindex:-1,imgType:this.options.imgType,needData:false,minLevel:this.options.minLevel,maxLevel:this.options.maxLevel,creator:MLayer.SYSTEM,imgUrlPreprocessor:{fun:H1_5,thisObj:this},K67I:""});this.maplet.addLayer(this.layer);this.refresh();$00=nB(this,c3U99,this.options.interval)};var H1_5=function(data){if(JRf4w)return this.options.serverPath+JRf4w+(this.maplet.AG-1)+"/o"+data.grid+"."+this.options.imgType;else return ""};this.refresh=function(){if(!this.layer||!this.layer.inZoomRange(this.maplet.AG))return;this.layer.clear();m_320=true;c3U99.apply(this)};var c3U99=function(){P7k4.apply(this)};var P7k4=function(){var url=k04.apply(this);url+=(url.indexOf("?")!=-1?"&":"?")+"_"+new Date().getTime()+"=";new SwF6(url,A76,false,true,this).e0b()};var k04=function(){return this.options.magicPath.replace("[city]",this.options.city)};var A76=function(){if(!this.layer.maplet)return;var d=eval(MTraffic.MAGIC_RESULT_NAME);if(typeof d!="string"||!d)return;if(!JRf4w||d!=JRf4w||m_320){JRf4w=eval(MTraffic.MAGIC_RESULT_NAME);m_320=false;this.layer.clear();this.layer.update();MEvent.trigger(this.layer.maplet,"traffic_update",{magicPath:JRf4w})}};this.getTimestamp=function(){var S99g=null;if(JRf4w){var TTf=JRf4w.split("/");if(TTf.length>8){S99g=new Date(TTf[4],U5402(TTf[5][0]=="0"?TTf[5][1]:TTf[5])-1,TTf[6],TTf[7],TTf[8].replace(TTf[4]+TTf[5]+TTf[6]+TTf[7],""),0)}}return S99g};this.getTimestampDir=function(){var S99g="";if(JRf4w){var TTf=JRf4w.split("/");if(TTf.length>9){S99g=TTf.slice(4,9).join("/")}}return S99g};this.setServerPath=function(path){if(typeof path!="string"||!path)path="http://lukuang.mapbar.com/";this.options.serverPath=path};this.setImgType=function(type){if(typeof type!="string"||!type)type="png";this.options.imgType=type.toLowerCase()};this.setMagicPath=function(path){if(typeof path!="string"||!path)path="http://lukuang.mapbar.com/[city]/traffic/images/traffic.js";this.options.magicPath=path};this.setLevelRange=function(min,max){if(typeof min!="number"||min<TRAFFIC_MIN_LEVEL||min>TRAFFIC_MAX_LEVEL)min=TRAFFIC_MIN_LEVEL;if(typeof max!="number"||max<TRAFFIC_MIN_LEVEL||max>TRAFFIC_MAX_LEVEL)max=TRAFFIC_MAX_LEVEL;this.options.minLevel=min;this.options.maxLevel=max};this.setInterval=function(i){if(typeof i!="number"||i<TRAFFIC_REFRESH_INTERVAL)i=TRAFFIC_REFRESH_INTERVAL;this.options.interval=i*1000;if($00){window.clearInterval($00);$00=nB(this,c3U99,this.options.interval)}};this.setCity=function(city,refresh){if(typeof city!="string"||!city)city="beijing";this.options.city=city;if(typeof refresh!="boolean")refresh=true;if(refresh){m_320=true;c3U99.apply(this)}};this.show=function(){if(this.layer)this.layer.show()};this.hide=function(){if(this.layer)this.layer.hide()};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if($00)window.clearTimeout($00);$00=null;if(this.maplet)this.maplet.removeLayer(this.layer,finalize);this.maplet=null};this.toString=function(){return 'com.mapbar.maplet.MTraffic'};this.id=new Date().getTime()+"_traffic";this.maplet=null;this.layer=null;var $00=null;var JRf4w=null;var m_320=true;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined));this.setInterval(typeof interval!="undefined"?interval:undefined);this.setCity(typeof city!="undefined"?city:undefined,false);this.setMagicPath(typeof magicPath!="undefined"?magicPath:undefined);this.setImgType(typeof imgType!="undefined"?imgType:undefined)}};MTraffic.MAGIC_RESULT_NAME="__mapbar_magic_id";var MPOILayer=function(options){this.initialize=function(maplet){this.maplet=maplet;this.layer=new MLayer({serverPath:this.options.serverPath,zindex:-2,needImg:false,needData:true,minLevel:this.options.minLevel,maxLevel:this.options.maxLevel,creator:MLayer.SYSTEM,dataLoadMode:this.options.loadMode,mouseover:{fun:mouseover,thisObj:this},mouseout:{fun:mouseout,thisObj:this},click:{fun:click,thisObj:this},dataPattern:'basepoi'+MLayer.DPLACEHOLDER});this.maplet.addLayer(this.layer)};var mouseover=function(data){var S99g=pWO73.apply(this,[data]);if(S99g&&MEvent.contains(this.maplet,"poi_mouseover")>0){MEvent.trigger(this.maplet,"poi_mouseover",Y$4$.apply(this,[data]))}return S99g};var mouseout=function(data){if(pWO73.apply(this,[data])&&MEvent.contains(this.maplet,"poi_mouseout")>0){MEvent.trigger(this.maplet,"poi_mouseout",Y$4$.apply(this,[data]))}};var click=function(data){var S99g={center2map:!pWO73.apply(this,[data]),firevent:false};if(!S99g.center2map&&MEvent.contains(this.maplet,"poi_click")>0){MEvent.trigger(this.maplet,"poi_click",Y$4$.apply(this,[data]))}return S99g};var pWO73=function(data){if(typeof data=="object"&&data&&typeof data.d=="string"&&data.d)var pt=n16B5.apply(this,[data.d.substring(0,1)]);return((this.options.dataTypes&pt)==MPOILayer.DT_POI)||((this.options.dataTypes&pt)==MPOILayer.DT_BUSTOP)||((this.options.dataTypes&pt)==MPOILayer.DT_SUBWAY)};var Y$4$=function(data){if(typeof data=="object"&&data&&typeof data.d=="string"&&data.d)var U1f$7=data.d;var pt=n16B5.apply(this,[U1f$7.substring(0,1)]);if(U1f$7.length>=2)U1f$7=U1f$7.substring(2);return{type:pt,pid:data.p,area:data.l,data:U1f$7,name:data.n,rect:data.rect}};var n16B5=function(s){var i=U5402(s);if(i==MPOILayer.DT_POI)return MPOILayer.DT_POI;else if(i==MPOILayer.DT_BUSTOP)return MPOILayer.DT_BUSTOP;else if(i==MPOILayer.DT_SUBWAY)return MPOILayer.DT_SUBWAY;else return MPOILayer.DT_NONE};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.maplet&&this.layer){this.maplet.removeLayer(this.layer,finalize);this.layer=null;this.maplet=null}};this.setServerPath=function(path,V14){if(typeof path!="string"||!path)path=MPOILayer.INITIATIVE_URL;if(path==MPOILayer.INITIATIVE_URL||path==MPOILayer.PASSIVE_URL){if(this.options.loadMode&MLayer.DL_INITIATIVE==MLayer.DL_INITIATIVE)path=MPOILayer.INITIATIVE_URL;else path=MPOILayer.PASSIVE_URL}this.options.serverPath=path;if(this.layer)this.layer.setServerPath(path,V14)};this.setLevelRange=function(min,max,V14){if(typeof min!="number"||min<TRAFFIC_MIN_LEVEL||min>TRAFFIC_MAX_LEVEL)min=TRAFFIC_MIN_LEVEL;if(typeof max!="number"||max<TRAFFIC_MIN_LEVEL||max>TRAFFIC_MAX_LEVEL)max=TRAFFIC_MAX_LEVEL;this.options.minLevel=min;this.options.maxLevel=max;if(this.layer)this.layer.setLevelRange(min,max,V14)};this.setDataTypes=function(U5u8v,V14){if(typeof U5u8v!="number"||(U5u8v&MPOILayer.DT_POI!=MPOILayer.DT_POI&&U5u8v&MPOILayer.DT_SUBWAY!=MPOILayer.DT_SUBWAY&&U5u8v&MPOILayer.DT_BUSTOP!=MPOILayer.DT_BUSTOP))U5u8v=MPOILayer.DT_ALL;this.options.dataTypes=U5u8v};this.setLoadMode=function(mode,V14){if(typeof mode!="number"||(mode!=MLayer.DL_INITIATIVE&&mode!=MLayer.DL_PASSIVE))mode=MLayer.DL_INITIATIVE;this.options.loadMode=mode;this.setServerPath(this.options.serverPath,V14)};this.maplet=null;this.layer=null;this.options=options||{};with(this.options){this.setServerPath(typeof serverPath!="undefined"?serverPath:undefined,false);this.setLevelRange((typeof minLevel!="undefined"?minLevel:undefined),(typeof maxLevel!="undefined"?maxLevel:undefined),false);this.setDataTypes((typeof dataTypes!="undefined"?dataTypes:undefined),false);this.setLoadMode(typeof loadMode!="undefined"?loadMode:undefined,false)}};MPOILayer.DT_NONE=0;MPOILayer.DT_POI=1;MPOILayer.DT_BUSTOP=2;MPOILayer.DT_SUBWAY=4;MPOILayer.DT_ALL=255;MPOILayer.INITIATIVE_URL="http://img.mapbar.com/maplite/mapbank/maplayer/basepoi/";MPOILayer.PASSIVE_URL="http://192.168.0.241:8084/servlet/mg";function WD1x3(maplet){this.maplet=maplet;document["mapbar-overview"]=this;this.yl="mapbar";var _KwQ=0;var CFD9=0;var r5S=0;var XL4=0;this.c3=oo;this.fg=true;this.panel=document.createElement("div");this.panel.unselectable="on";this.panel.style.position="absolute";this.panel.style.zIndex=999;this.panel.style.backgroundColor="white";this.panel.style.border="1px solid #A6A5A1";this.panel.setAttribute(_56,true);this.panel.style.overflow="hidden";this.panel.style.display="none";this.fC=document.createElement("div");this.fC.id="mapbar-overview-canvas";this.fC.unselectable="on";this.fC.style.position="absolute";this.fC.style.visibility="visible";this.fC.style.zIndex=0;this.fC.style.top=(uU-2)+"px";this.fC.style.left=(px)?"5px":"7px";this.fC.style.backgroundColor=MapBackgroundColor;this.fC.style.border="2px solid #0E347F";this.fC.style.overflow="hidden";this.fC.selected=false;this.panel.appendChild(this.fC);this.z3=document.createElement("div");this.z3.id="mapbar-overview-viewport";this.z3.unselectable="on";this.fC.appendChild(this.z3);this.z1=document.createElement("div");this.z1.id="mapbar-overview-viewframe";this.z1.unselectable="on";this.fC.appendChild(this.z1);this.z2=document.createElement("div");this.z2.id="mapbar-overview-viewpad_ctrl";this.z2.unselectable="on";this.z2.style.MozUserSelect="none";this.fC.appendChild(this.z2);this.z2.style.cursor="move";this.z2.selected=false;this.ao=new Array();this.cW=0;this.S7$CQ=[2,4,8,6];this.shadow=document.createElement("div");this.shadow.unselectable="on";this.shadow.style.position="absolute";this.shadow.style.zIndex=998;this.shadow.setAttribute(_56,true);this.shadow.style.display="none";var Bo99S=null;var eC85W=null;this.w0D=new fD("OvwImgs",0,0,0,0,true,0,'',this.fC);this.show=function(){this.fg=true};this.hide=function(){this.fg=false};this.nF=function(){if(this.fg){if(this.c3)return U5402(this.shadow.style.top);else return XL4}else{return 0}};this.Q15=function(){if(this.fg){if(this.c3)return U5402(this.shadow.style.left);else return r5S}else{return 0}};this.nz=function(){if(this.fg){if(this.c3)return U5402(this.shadow.offsetHeight);else return U5402(this.img.offsetHeight)}else{return 0}};this.w0=function(e){QD199(e);if(this.cW!=0)return;if(e.target.id==this.z2.id||A083==this.z2.id){A083=this.z2.id;this.z2.selected=true;this.downX=(px)?event.clientX:e.clientX;this.downY=(px)?event.clientY:e.clientY;this.xa=this.downX;this.xb=this.downY}else if(fJ(e.target,this.fC)||A083==this.fC.id){A083=this.fC.id;this.fC.selected=true;this.downX=(px)?event.clientX:e.clientX;this.downY=(px)?event.clientY:e.clientY;this.xa=this.downX;this.xb=this.downY}if(A083){this.ao["doc_mousemove"]=MEvent.bindDom(document,"mousemove",this,this.f9);this.ao["doc_mouseup"]=MEvent.bindDom(document,"mouseup",this,this.l1);if(px)this.ao["losecapture"]=MEvent.bindDom(document.body,"losecapture",this,this.l1);else this.ao["blur"]=MEvent.bindDom(window,"blur",this,this.l1)}};this.f9=function(e){if(A083==this.z2.id&&this.z2.selected){this.moveX=(px)?event.clientX:e.clientX;this.moveY=(px)?event.clientY:e.clientY;var lI=(this.moveX-this.downX);var lK=(this.moveY-this.downY);this.downX=this.moveX;this.downY=this.moveY;if(this.z2.style.top){this.z2.style.top=(parseInt(this.z2.style.top)+lK)+"px";this.z2.style.left=(parseInt(this.z2.style.left)+lI)+"px"}}else if(A083==this.fC.id&&this.fC.selected){this.moveX=(px)?event.clientX:e.clientX;this.moveY=(px)?event.clientY:e.clientY;var lI=(this.moveX-this.downX);var lK=(this.moveY-this.downY);this.downX=this.moveX;this.downY=this.moveY;this.w0D.style.top=(parseInt(this.w0D.style.top)+lK)+"px";this.w0D.style.left=(parseInt(this.w0D.style.left)+lI)+"px";if(this.z3.style.top){this.z3.style.top=(parseInt(this.z3.style.top)+lK)+"px";this.z3.style.left=(parseInt(this.z3.style.left)+lI)+"px";this.z1.style.top=(parseInt(this.z1.style.top)+lK)+"px";this.z1.style.left=(parseInt(this.z1.style.left)+lI)+"px"}}if(!Bo99S&&this.z2.offsetWidth<this.fC.offsetWidth){if(px)document.body.setCapture();Bo99S=nB(this,Es42g,100);eC85W=nB(this,zL,100)}};this.l1=function(e){if(this.maplet.sS!=ts.D57MH&&this.maplet.sS!=ts.tz&&this.maplet.sS!=ts.tA&&this.maplet.sS!=ts.tv)QD199(e);if(Bo99S){this.maplet.hideBubble();window.clearInterval(Bo99S);Bo99S=null;window.clearInterval(eC85W);eC85W=null;if(px)document.body.releaseCapture()}if(this.ao["doc_mousemove"]){MEvent.removeBuiltInListener(document,"mousemove",this.ao["doc_mousemove"]);this.ao["doc_mousemove"]=null;MEvent.removeBuiltInListener(document,"mouseup",this.ao["doc_mouseup"]);this.ao["doc_mouseup"]=null;if(px){MEvent.removeBuiltInListener(document.body,"losecapture",this.ao["losecapture"]);this.ao["losecapture"]=null}else{MEvent.removeBuiltInListener(window,"blur",this.ao["blur"]);this.ao["blur"]=null}}if(this.z2.selected){A083=null;this.z2.selected=false;var moveX=(px)?event.clientX:e.clientX;var moveY=(px)?event.clientY:e.clientY;if(typeof moveX=="undefined")moveX=this.moveX;if(typeof moveY=="undefined")moveY=this.moveY;var lI=(moveX-this.xa-U5402(this.w0D.style.left));var lK=(moveY-this.xb-U5402(this.w0D.style.top));var lf=-lK*this.xf/this.maplet.imgHeight;var li=lI*this.xg/this.maplet.imgWidth;this.gK=this.maplet.gx+lf;this.gL=this.maplet.gA+li;this.cW=1;var l=U5402(this.z2.style.left);if(l<-this.z2.offsetWidth)l=-this.z2.offsetWidth;else if(l>=this.fC.offsetWidth)l=this.fC.offsetWidth;var yw=parseInt(this.z2.style.top);if(yw<-this.z2.offsetHeight)yw=-this.z2.offsetHeight;else if(yw>=this.fC.offsetHeight)yw=this.fC.offsetHeight;this.z2.style.left=l+"px";this.z2.style.top=yw+"px";this.vh=getTimeout(this,this.vO,20)}else if(this.fC.selected){A083=null;this.fC.selected=false;var moveX=(px)?event.clientX:e.clientX;var moveY=(px)?event.clientY:e.clientY;var lI=-(moveX-this.xa);var lK=-(moveY-this.xb);var lf=-lK*this.xf/this.maplet.imgHeight;var li=lI*this.xg/this.maplet.imgWidth;this.gK=this.maplet.gx+lf;this.gL=this.maplet.gA+li;this.cW=2;var l=U5402(this.z3.style.left);if(l<-this.z3.offsetWidth)l=-this.z3.offsetWidth;else if(l>=this.fC.offsetWidth)l=this.fC.offsetWidth;var yw=U5402(this.z3.style.top);if(yw<-this.z3.offsetHeight)yw=-this.z3.offsetHeight;else if(yw>=this.fC.offsetHeight)yw=this.fC.offsetHeight;this.z3.style.left=l+"px";this.z3.style.top=yw+"px";this.z1.style.left=l+"px";this.z1.style.top=yw+"px";this.vh=getTimeout(this,this.vO,20)}};var oOi=function(e){QD199(e)};this.vO=function(){if(this.vh){clearTimeout(this.vh);this.vh=null}if(!this.z3.style.top||!this.z2.style.top){this.maplet.setCenter(this.gK,this.gL,true);this.cW=0;return}var lK=parseInt(this.z2.style.top)-parseInt(this.z3.style.top);var lI=parseInt(this.z2.style.left)-parseInt(this.z3.style.left);var gN=Math.round(lI);var gO=Math.round(lK);if((Math.abs(lI)+Math.abs(lK))>=10){var gN=Math.round(lI*10.0/(Math.abs(lI)+Math.abs(lK)));var gO=Math.round(lK*10.0/(Math.abs(lI)+Math.abs(lK)))}if(this.cW==2){if((Math.abs(lI)+Math.abs(lK))==0){this.maplet.setCenter(this.gK,this.gL,true);this.cW=0}else{this.z3.style.top=(parseInt(this.z3.style.top)+gO)+"px";this.z3.style.left=(parseInt(this.z3.style.left)+gN)+"px";this.z1.style.top=(parseInt(this.z1.style.top)+gO)+"px";this.z1.style.left=(parseInt(this.z1.style.left)+gN)+"px";this.vh=getTimeout(this,this.vO,20)}}else if(this.cW==1){gN=-gN;gO=-gO;if((Math.abs(lI)+Math.abs(lK))==0){this.maplet.setCenter(this.gK,this.gL,true);this.cW=0}else{for(var i in this.pU){if(typeof this.pU[i]=="object"&&(this.pU[i]!=null)){this.pU[i].style.top=(parseInt(this.pU[i].style.top)+gO)+"px";this.pU[i].style.left=(parseInt(this.pU[i].style.left)+gN)+"px"}}this.z2.style.top=(parseInt(this.z2.style.top)+gO)+"px";this.z2.style.left=(parseInt(this.z2.style.left)+gN)+"px";this.vh=getTimeout(this,this.vO,20)}}};this.pU=new Array();this.yN=null;this.c4=false;this.cl=false;this.sa=new Array();this.nH=function(){if(this.fg&&this.c3)return OVER_WIN_WIDTH;else return uS};this.addListener=function(uy){this.sa[uy.id]=uy};this.removeListener=function(uy){this.sa[uy.id]=null};this.uq=function(){for(var pf in this.sa){if(this.sa[pf]&&this.sa[pf].onresize){this.sa[pf].onresize()}}this.maplet.onresize()};this.g1=function(){for(var pf in this.sa){if(this.sa[pf]){this.sa[pf]=null}this.sa=null}this.clearImgs();this.pU=null;for(var l8 in this.ao){try{if(this.ao[l8]!=null){MEvent.removeBuiltInListener(this.fC,l8,this.ao[l8]);this.ao[l8]=null}}catch(e){}this.ao=null}this.img.overview=null;this.img.onclick=null;this.img.onmousedown=null;this.img.onmouseup=null;this.img.ondblclick=null;this.z2.w0=null;this.z2.f9=null;if(this.panel.parentNode!=null){_removeNode(this.panel)}this.maplet=null;_removeNode(this.img);_removeNode(this.shadow);M7e5S(this)};this.onresize=function(){this.Qc5();this.uq()};this.close=function(){if(this.cl)return;if(typeof this.img=="undefined"){this.c3=oo=false;return}else if(this.img.style.display=="none"&&this.c3){this.c3=oo=false}O6Y5.apply(this);this.cl=true;this.yN=getTimeout(this,k5k,10);this.c4=false;this.uq()};this.open=function(){if(typeof this.img=="undefined"){this.c3=oo=true;return}if(this.c4)return;O6Y5.apply(this);this.c4=true;this.yN=getTimeout(this,n6YPt,10);this.cl=false};this.qa=function(container){var An=(px)?0:2;this.img=document.createElement("div");this.img.unselectable="on";this.img.style.position="absolute";this.img.style.zIndex=1000;this.img.overview=this;this.img.style.cursor=(px)?"hand":"pointer";this.img.style.overflow="hidden";this.img.style.display="none";this.H63fP=document.createElement("img");this.H63fP.unselectable="on";this.H63fP.style.position="absolute";this.H63fP.src=CTLIMG_RESOURCE[0].url;this.H63fP.style.width=CTLIMG_RESOURCE[0].w+"px";this.H63fP.style.height=CTLIMG_RESOURCE[0].h+"px";this.H63fP.D7o="no";if(px)this.img.style.filter="alpha(opacity=0)";else this.img.style.opacity="0";this.img.onmousedown=function(e){QD199(e||window.event)};this.img.onmouseup=function(e){this.overview.l1(e);QD199(e||window.event)};this.img.ondblclick=function(e){QD199(e||window.event)};this.img.onclick=function(e){QD199(e||window.event);if(this.overview.c3){this.overview.close()}else{this.overview.open()}};container.appendChild(this.img);this.img.appendChild(this.H63fP);container.appendChild(this.panel);container.appendChild(this.shadow);this.ao["mousedown"]=MEvent.bindDom(this.fC,"mousedown",this,this.w0);this.ao["mouseup"]=MEvent.bindDom(this.fC,"dblclick",this,oOi);this.onresize();if(!this.fg)return;if(oo){this.open()}else{this.close()}};this.clearImgs=function(){for(var i in this.pU)j0XY.apply(this,[i])};var j0XY=function(id){try{if(this.pU[id]!=null){_removeNode(this.pU[id]);this.pU[id].onmousedown=null;this.pU[id].onerror=null;this.pU[id].onload=null;this.pU[id]=null;delete this.pU[id]}}catch(e){}};var AVwM=function(){for(var i in this.pU){if(this.pU[i]&&!this.pU[i].c2)j0XY.apply(this,[i])}};this.paint=function(C3bSv){C3bSv&&this.clearImgs();if(!this.c3||!this.fg)return;this.width=OVER_WIN_WIDTH-10;this.height=OVER_WIN_HEIGHT-10;this.gx=this.maplet.gx;this.gA=this.maplet.gA;this.AG=Math.max(Math.max(0,MIN_ZOOM_LEVEL-2),uW[this.maplet.AG]);this.imgWidth=this.maplet.imgWidth;this.imgHeight=this.maplet.imgHeight;this.xK=this.maplet.h23;if(this.yl!=this.maplet.yl){this.yl=this.maplet.yl;this.clearImgs()}var yk=this.yl;this.z4=Math.ceil((this.width)/(this.imgWidth)/2);this.z5=Math.ceil((this.height)/(this.imgHeight)/2);this.xg=sj[this.AG];this.xf=qP[this.AG];this.sR=sI[this.AG]+"/";this.gD=Math.floor((this.maplet.gA)/this.xg);this.gE=Math.floor((this.maplet.gx)/this.xf);if(this.gD<0)this.gD+=1;this.mapX=this.width/2-Math.round(((this.gA*wp)%(this.xg*wp))*this.imgWidth/(this.xg*wp));if(this.gx>=0){this.mapY=this.height/2-this.imgHeight+Math.round(((this.gx*wp)%(this.xf*wp))*this.imgHeight/(this.xf*wp))}else{this.mapY=this.height/2+Math.round(((this.gx*wp)%(this.xf*wp))*this.imgHeight/(this.xf*wp))}var nL=nM[this.AG];this.sZ=0;this.s1=0;this.tf1=this.width;this.tg=this.height;this.s2=parseInt(this.gD);this.s3=parseInt(this.gE);this.th=parseInt(this.gD);this.ti=parseInt(this.gE);var s8=(360/sj[this.AG]);this.gk=1.0;this.wT=0.0;for(var i in this.pU){if(this.pU[i]!=null){this.pU[i].c2=false}}for(ix=-this.z4-1;ix<=this.z4;ix++){for(iy=-this.z5-1;iy<=this.z5;iy++){try{var pM=this.maplet.gaSe+this.sR;var qy=parseInt(this.gD+ix);var qA=parseInt(this.gE+iy);qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var dirx=parseInt(Math.floor((qy)/nL));var diry=parseInt(Math.floor((qA)/nL));{if(dirx<0)dirx+=1;if(diry<0)diry+=1}var Xn1=(qy)-dirx*nL;var yNj39=(qA)-diry*nL;pM+=dirx+"_"+diry+"/";pM+=Xn1+"_"+yNj39+"."+this.xK;var p1=(ix*this.imgWidth)+parseInt(this.mapX);var p3=(-(iy*this.imgHeight)+parseInt(this.mapY));var p4=p3;if(this.yl!="aerial"&&this.yl.indexOf("aerial")<0){p3=p3+w8[this.AG]}if(p1<-this.imgWidth||p1>this.width||p3>this.height||p3<-this.imgHeight)continue;if(this.sZ<(p1+this.imgWidth)){this.sZ=(p1+this.imgWidth);this.s2=parseInt(this.gD)+parseInt(ix)}if(this.s1<(p3+this.imgHeight)){this.s1=(p3+this.imgHeight);this.ti=parseInt(this.gE)+parseInt(iy)}if(this.tf1>p1){this.tf1=p1;this.th=parseInt(this.gD)+parseInt(ix)}if(this.tg>p3){this.tg=p3;this.s3=parseInt(this.gE)+parseInt(iy)}var xY="__ov_ctrl_"+((this.AG).toString(16)+(this.gD+ix).toString(16)+'l'+(this.gE+iy).toString(16)).toLowerCase();if(pM&&pM.indexOf("NaN")<0){if(this.pU[xY]==null){this.pU[xY]=new Image();this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute";this.pU[xY].onmousedown=function(){return false};this.pU[xY].D7o="no";this.pU[xY].src=pM}var p2=(p1+this.imgWidth/2-this.width/2)*this.gk-(p3+this.imgHeight/2-this.height/2)*this.wT+this.width/2;var p5=(p1+this.imgWidth/2-this.width/2)*this.wT+(p3+this.imgHeight/2-this.height/2)*this.gk+this.height/2;this.pU[xY].style.top=parseInt(p5-this.imgHeight/2)+"px";this.pU[xY].style.left=parseInt(p2-this.imgWidth/2)+"px";this.pU[xY].c2=true}pM=null;xY=null}catch(e){}}}for(var i in this.pU){var img=this.pU[i];if(img&&img.c2&&img.parentNode!=this.w0D)this.w0D.appendChild(img)}AVwM.apply(this);oDYQ7.apply(this);this.w0D.style.top=this.w0D.style.left="0px"};var oDYQ7=function(){var Ae=parseInt(this.maplet.width*this.maplet.xg/this.xg);var zZ=parseInt(this.maplet.height*this.maplet.xf/this.xf);if(Ae>this.width&&zZ>this.height){KJ6y.apply(this,[false])}else{this.z3.style.left=parseInt(this.width-Ae)/2+"px";this.z3.style.top=parseInt(this.height-zZ)/2+"px";this.z3.style.width=(Ae)+"px";this.z3.style.height=(zZ)+"px";this.z1.style.left=parseInt(this.width-Ae)/2+"px";this.z1.style.top=parseInt(this.height-zZ)/2+"px";this.z1.style.width=(Ae)+"px";this.z1.style.height=(zZ)+"px";this.z2.style.left=parseInt(this.width-Ae)/2+"px";this.z2.style.top=parseInt(this.height-zZ)/2+"px";this.z2.style.width=(Ae)+"px";this.z2.style.height=(zZ)+"px";KJ6y.apply(this,[true])}};var KJ6y=function(visible){this.z3.style.visibility=visible?"visible":"hidden";this.z1.style.visibility=visible?"visible":"hidden";this.z2.style.visibility=visible?"visible":"hidden"};this.getRect=function(){var r={min:{x:0,y:0},max:{x:0,y:0}};if(typeof this.img!="undefined"){var fgni=(this.panel.style.display!="none");var w$q8=(this.img.style.display!="none");if(fgni||w$q8){var d=this.c3?this.shadow:this.img;r={min:{x:d.offsetLeft,y:d.offsetTop},max:{x:0,y:0}};r.max.x=r.min.x+d.offsetWidth;r.max.y=r.min.y+d.offsetHeight}}return r};var k5k=function(){var fgni=(this.panel.style.display!="none");if(this.fg)this.img.style.display="";this.uq();O6Y5.apply(this);KJ6y.apply(this,[false]);this.shadow.style.display="none";if(this.fg||fgni){with(this.panel.style){if(px){filter="alpha(opacity=100)"}else{opacity="1"}}}if(this.fg){with(this.H63fP.style){left="-26px";top="-124px"}}with(this.img.style){if(px){filter="alpha(opacity=0)"}else{opacity="0"}}var yw=0,d=10;var p={b:0,c:1};var Jb31={b:0,c:1};function _85d2(){if(yw<d){yw++;if(px){this.panel.style.filter="alpha(opacity="+(100-A5PN1(yw,p.b,p.c,d)*100)+")";if(this.fg)this.img.style.filter="alpha(opacity="+A5PN1(yw,Jb31.b,Jb31.c,d)*100+")";else this.img.style.filter="alpha(opacity="+(100-A5PN1(yw,Jb31.b,Jb31.c,d)*100)+")"}else{this.panel.style.opacity=1-A5PN1(yw,p.b,p.c,d);if(this.fg)this.img.style.opacity=A5PN1(yw,Jb31.b,Jb31.c,d);else this.img.style.opacity=1-A5PN1(yw,Jb31.b,Jb31.c,d)}this.yN=getTimeout(this,_85d2,100)}else{this.panel.style.display="none";this.img.style.display=this.fg?"":"none";this.cl=false;this.c3=false;this.uq()}};_85d2.apply(this)};var n6YPt=function(){if(this.panel.style.display!="none")return;O6Y5.apply(this);KJ6y.apply(this,[false]);with(this.panel.style){display=this.fg?"":"none";if(px){filter="alpha(opacity=0)"}else{opacity="0"}}with(this.img.style){display=this.fg?"":"none";if(px){filter="alpha(opacity=0)"}else{opacity="0"}}with(this.H63fP.style){top="-125px";left="-42px"}var yw=0,d=10;var p={b:0,c:1};var Jb31={b:0,c:1};function _85d2(){if(yw<d){yw++;if(px){this.panel.style.filter="alpha(opacity="+A5PN1(yw,p.b,p.c,d)*100+")";this.img.style.filter="alpha(opacity="+A5PN1(yw,Jb31.b,Jb31.c,d)*100+")"}else{this.panel.style.opacity=A5PN1(yw,p.b,p.c,d);this.img.style.opacity=A5PN1(yw,Jb31.b,Jb31.c,d)}this.yN=getTimeout(this,_85d2,100)}else{if(px){this.panel.style.filter=null}else{this.shadow.style.opacity=1}this.shadow.style.display=this.fg?"":"none";this.c4=false;this.c3=true;this.uq();this.paint()}};_85d2.apply(this)};var O6Y5=function(){if(this.yN){window.clearTimeout(this.yN);this.yN=null}};var A5PN1=function(yw,b,c,d){if(yw==0)return b;if(yw==d)return b+c;if((yw/=d/2)<1)return c/2*Math.pow(2,10*(yw-1))+b;return c/2*(-Math.pow(2,-10* --yw)+2)+b};this.lIE2=function(location){location=location||{};if(typeof location.type!="number"&&!(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM||location.type==Maplet.RIGHT_TOP||location.type==Maplet.LEFT_BOTTOM))location.type=Maplet.RIGHT_BOTTOM;if(typeof location.marginx!="number")location.marginx=6;if(typeof location.marginy!="number")location.marginy=6;return location};this.setLocation=function(location){this.location=this.lIE2(location);;this.Qc5()};this.resizeTo=function(w,h){if(typeof w!="number"){w=150}else{if(w<100)w=100;else if(w>210)w=210}if(typeof h!="number"){h=140}else{if(h<100)h=100;else if(h>210)h=210}OVER_WIN_WIDTH=w;OVER_WIN_HEIGHT=h;this.onresize();this.paint()};var T4S=function(){with(this.location){if(type==Maplet.LEFT_TOP){_KwQ=marginx;CFD9=marginy;r5S=_KwQ+WD1x3.NS6+4;XL4=CFD9+WD1x3.We78S+4}else if(type==Maplet.LEFT_BOTTOM){_KwQ=marginx;CFD9=this.maplet.height-OVER_WIN_HEIGHT-marginy;r5S=_KwQ+WD1x3.NS6+4;XL4=CFD9+OVER_WIN_HEIGHT-uS-WD1x3.We78S-1}else if(type==Maplet.RIGHT_TOP){_KwQ=this.maplet.width-OVER_WIN_WIDTH-marginx;CFD9=marginy;r5S=_KwQ+OVER_WIN_WIDTH-uS-WD1x3.NS6-2;XL4=CFD9+WD1x3.We78S+4}else if(type==Maplet.RIGHT_BOTTOM){_KwQ=this.maplet.width-OVER_WIN_WIDTH-marginx;CFD9=this.maplet.height-OVER_WIN_HEIGHT-marginy;r5S=_KwQ+OVER_WIN_WIDTH-uS-WD1x3.NS6-2;XL4=CFD9+OVER_WIN_HEIGHT-uS-WD1x3.We78S-1}}};this.Qc5=function(){T4S.apply(this);with(this.panel.style){width=OVER_WIN_WIDTH+"px";height=OVER_WIN_HEIGHT+"px";left=_KwQ+"px";top=CFD9+"px"}with(this.shadow.style){width=OVER_WIN_WIDTH+WD1x3.d6A+"px";height=OVER_WIN_HEIGHT+WD1x3.d6A+"px";left=_KwQ-WD1x3.d6A/2+"px";top=CFD9-WD1x3.d6A/2+"px"}with(this.fC.style){width=OVER_WIN_WIDTH-WD1x3.NS6*2-U5402(borderWidth)*2+"px";height=OVER_WIN_HEIGHT-WD1x3.We78S*2-U5402(borderWidth)*2+"px";left=WD1x3.NS6+"px";top=WD1x3.We78S+"px"}with(this.w0D.style){width=this.fC.style.width;height=this.fC.style.height;top=left="0px"}with(this.img.style){width=uS+"px";height=uS+"px";left=r5S+"px";top=XL4+"px"}with(this.H63fP.style){if(this.c3){top="-125px";left="-42px"}else{left="-26px";top="-124px"}}this.shadow.innerHTML="";if(i639){for(var i=0;i<this.S7$CQ.length;i++){var s6$=document.createElement("div");s6$.unselectable="on";s6$.style.position="absolute";s6$.style.zIndex=i;s6$.style.backgroundColor="black";s6$.setAttribute(_56,true);s6$.style.left=i*2+"px";s6$.style.top=i*2+"px";s6$.style.width=(OVER_WIN_WIDTH+(this.S7$CQ.length-i)*4+2)+"px";s6$.style.height=(OVER_WIN_HEIGHT+(this.S7$CQ.length-i)*4+2)+"px";if(px)s6$.style.filter="alpha(opacity="+this.S7$CQ[i]+")";else s6$.style.opacity=this.S7$CQ[i]/100;this.shadow.appendChild(s6$)}}else{var x=WD1x3.d6A/2-WD1x3.Y0p;var y=x;var w=WD1x3.G01;var h=WD1x3.G01;var s=["<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-28px;top:-103px;\"></div>"];x+=WD1x3.G01;w=OVER_WIN_WIDTH-WD1x3.G01+1;h=WD1x3.Y0p;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:0px;top:-226px;\"></div>");x+=w;w=WD1x3.G01;h=w;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-38px;top:-103px;\"></div>");x=OVER_WIN_WIDTH+WD1x3.G01+WD1x3.Y0p;y+=WD1x3.G01;h=OVER_WIN_HEIGHT-WD1x3.G01+1;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-81px;top:0px;\"></div>");x=x-WD1x3.Y0p-1;y+=h;w=WD1x3.G01;h=w;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-38px;top:-113px;\"></div>");x=WD1x3.d6A/2-WD1x3.Y0p+WD1x3.G01;y+=WD1x3.Y0p+1;w=OVER_WIN_WIDTH-WD1x3.G01+1;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:0px;top:-229px;\"></div>");x=WD1x3.d6A/2-WD1x3.Y0p;y=y-WD1x3.Y0p-1;w=WD1x3.G01;h=w;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-28px;top:-113px;\"></div>");y=WD1x3.d6A/2-WD1x3.Y0p+WD1x3.G01;h=OVER_WIN_HEIGHT-WD1x3.G01+1;w=WD1x3.Y0p;s.push("<div style=\"position:absolute;left:"+x+"px;top:"+y+"px;width:"+w+"px;height:"+h+"px;overflow:hidden;\"><img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-78px;top:0px;\"></div>");this.shadow.innerHTML=s.join("")}};var Es42g=function(){var rt=w2a6.apply(this);var vj=0,vk=0;if(rt.min.x<0)vj=5;if(rt.min.y<0)vk=5;if(rt.max.x>U5402(this.fC.style.width))vj=-5;if(rt.max.y>U5402(this.fC.style.height))vk=-5;if((vj!=0||vk!=0)){this.panTo(vj,vk)}};var w2a6=function(){var r={min:{x:this.z2.offsetLeft,y:this.z2.offsetTop},max:{x:0,y:0}};r.max.x=r.min.x+this.z2.offsetWidth;r.max.y=r.min.y+this.z2.offsetHeight;return r};this.panTo=function(x,y){this.w0D.style.top=U5402(this.w0D.style.top)+y+"px";this.w0D.style.left=U5402(this.w0D.style.left)+x+"px"};var zL=function(){if(this.fs||this.c0)return;var sP=parseInt(this.w0D.style.left);var sQ=parseInt(this.w0D.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0||(sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){this.fs=true;zA.apply(this)}};var zA=function(){if(this.fs==false)return;var sP=parseInt(this.w0D.style.left);var sQ=parseInt(this.w0D.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0){if(this.c0==true)return;this.c0=true;var qy=0;var p1=0;if((sP+this.tf1)>=0){this.th--;this.tf1-=parseInt(this.imgWidth);qy=this.th;p1=this.tf1}if((sP+this.sZ-this.width)<=0){this.s2++;p1=this.sZ;this.sZ+=parseInt(this.imgWidth);qy=this.s2}var ix=qy;var nL=nM[this.AG];var s8=parseInt(360/sj[this.AG]);qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var yk=this.yl;for(var iy=this.ti;iy<=this.s3;iy++){var qA=iy;var p3=(-(iy-this.ti+1)*this.imgHeight)+this.s1;aA.apply(this,[p1,p3,qy,qA,ix,iy,yk])}this.c0=false}if((sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){if(this.c0==true)return;this.c0=true;var qA=0;var p3=0;if((sQ+this.tg)>=0){this.s3++;this.tg-=parseInt(this.imgHeight);qA=this.s3;p3=this.tg}if((sQ+this.s1-this.height)<=0){this.ti--;p3=this.s1;this.s1+=parseInt(this.imgHeight);qA=this.ti}var iy=qA;var nL=nM[this.AG];var s8=parseInt(360/sj[this.AG]);var yk=this.yl;for(var ix=this.th;ix<=this.s2;ix++){var qy=ix;qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var p1=((ix-this.th)*this.imgWidth)+this.tf1;aA.apply(this,[p1,p3,qy,qA,ix,iy,yk])}this.c0=false}this.fs=false};var aA=function(p1,p3,qy,qA,ix,iy,yk){var nL=nM[this.AG];var dirx=parseInt(Math.floor((qy)/nL));var diry=parseInt(Math.floor((qA)/nL));if(dirx<0)dirx+=1;if(diry<0)diry+=1;var Xn1=(qy)-dirx*nL;var yNj39=(qA)-diry*nL;var pM=this.maplet.gaSe+this.sR;var xY="__ov_ctrl_"+((this.AG).toString(16)+ix.toString(16)+'l'+iy.toString(16)).toLowerCase();pM+=dirx+"_"+diry+"/";pM+=Xn1+"_"+yNj39+"."+this.xK;if(pM&&pM.indexOf("NaN")<0){if(this.pU[xY]==null){this.pU[xY]=new Image();this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute";this.pU[xY].onmousedown=function(){return false};this.pU[xY].D7o="no";this.pU[xY].src=pM}var p2=(p1+this.imgWidth/2-this.width/2)*this.gk-(p3+this.imgHeight/2-this.height/2)*this.wT+this.width/2;var p5=(p1+this.imgWidth/2-this.width/2)*this.wT+(p3+this.imgHeight/2-this.height/2)*this.gk+this.height/2;this.pU[xY].style.top=parseInt(p5-this.imgHeight/2)+"px";this.pU[xY].style.left=parseInt(p2-this.imgWidth/2)+"px";this.pU[xY].c2=true;this.w0D.div.appendChild(this.pU[xY]);xY=null}pM=null};this.location=this.lIE2(OVER_LOCATION)};WD1x3.NS6=2;WD1x3.We78S=2;WD1x3.Y0p=3;WD1x3.d6A=16;WD1x3.G01=7;function MStandardControl(x6,left,top,fi){this.x6=(typeof x6=="undefined")?"mapbar":x6;this.left=(typeof left=="undefined")?0:parseInt(left);this.top=(typeof top=="undefined")?0:parseInt(top);this.fi=(typeof fi=="undefined")?0:parseInt(fi);this.id=new Date().getTime()+parseInt(Math.random()*1000);this.nR=null;this.initialize=function(maplet){this.maplet=maplet;if(this.maplet.gc[this.id]==null){if(!this.fi&&this.maplet.height<300){if(bsc)this.fi=1}this.maplet.gc[this.id]=this;this.nR=new gb(typeof this.x6!="object"?null:this.x6);this.nR.initialize(this.maplet);if(this.maplet.controlCanvas==null)this.maplet.controlCanvas=this.nR}};this.remove=function(){this.maplet=null;if(this.nR){if(this.nR==this.maplet.controlCanvas)this.maplet.controlCanvas=null;this.nR.g1();this.nR=null}M7e5S(this)};this.toString=function(){return 'com.mapbar.maplet.MStandardControl'}};function MLookupControl(ya,left,top){this.ya=(typeof ya=="undefined")?tX("%u62CD%uCB0F%uD02B%uF3C7"):ya;this.left=(typeof left=="undefined")?0:parseInt(left);this.top=(typeof top=="undefined")?0:parseInt(top);this.id=new Date().getTime()+parseInt(Math.random()*1000);this.onresize=function(maplet){if(this.maplet.overview.nF()<=37){this.tY.style.left=(this.maplet.width-132+this.left-this.maplet.overview.nH())+"px"}else{this.tY.style.left=(this.maplet.width-132+this.left)+"px"}};this.initialize=function(maplet){this.maplet=maplet;if(this.maplet.gc[this.id]==null){this.maplet.gc[this.id]=this;this.tY=document.createElement("div");this.tY.style.position="absolute";this.onresize(this.maplet);this.tY.style.top=(10+this.top)+"px";this.tY.style.zIndex=10;this.tY.style.visibility="visible";this.tU=document.createElement("img");this.tU.unselectable="on";this.tU.src=strImgsvrUrl+"images/lookup.png";this.tU.alt=this.ya;this.tU.style.cursor="hand";this.tU.style.cursor="pointer";this.tU.panel=this;this.tU.maplet=this.maplet;this.tU.onclick=function(){this.maplet.setMode("lookup");MEvent.trigger(this.panel,"onclick")};this.tY.appendChild(this.tU);this.maplet.panel.appendChild(this.tY)}};this.remove=function(){this.maplet=null;if(this.tY!=null&&this.tY.parentNode!=null){this.tY.parentNode.removeChild(this.tY);this.tY=null;this.tU.maplet=null;this.tU.onclick=null;this.tU=null}};this.toString=function(){return 'com.mapbar.maplet.MLookupControl'}};var MContextMenuItem=function(title,fy){this.ao=[];this.title=title;this.callback=(typeof fy=="undefined")?null:fy;this.t6=document.createElement("tr");this.tW=document.createElement("td");this.tW.className="contextmenuitem";this.tW.innerHTML="&nbsp;"+title;this.t6.appendChild(this.tW);this.uK=function(e){this.panel.hide();if(typeof this.callback=="function"&&this.callback){this.callback.apply(null,[this,this.panel,this.panel.overlay])}else if(typeof this.callback=="string"&&this.callback){eval(this.callback)}else{MEvent.trigger(this,"select",this,this.panel,this.panel.overlay)}};this.uG=function(e){this.t6.style.backgroundColor="#d2e1ff"};this.uJ=function(e){this.t6.style.backgroundColor="#FFFFFF"};this.paint=function(panel){this.panel=panel;this.panel.t8.appendChild(this.t6)};this.toString=function(){return "com.mapbar.maplet.MContextMenuItem"};this.ao["click"]=MEvent.bindDom(this.t6,"click",this,this.uK);this.ao["mouseover"]=MEvent.bindDom(this.t6,"mouseover",this,this.uG);this.ao["mouseout"]=MEvent.bindDom(this.t6,"mouseout",this,this.uJ);this.remove=function(){if(this.panel)this.panel=null;for(var l8 in this.ao){MEvent.removeBuiltInListener(this.t6,l8,this.ao[l8]);delete this.ao[l8]}this.ao=null;if(this.t6){if(this.t6.parentNode)_removeNode(this.t6);this.t6=null}if(typeof this.callback=="function"&&this.callback)this.callback=null}};var MContextMenu=function(){this.overlay=null;this.u5={};this.D8$27="";this.qt=new Array();this.id=new Date().getTime()+parseInt(Math.random()*1000);this.tY=document.createElement("div");this.tY.className="mapcontextmenu";this.t7=document.createElement("table");this.t7.className="contextmenutable";this.t8=document.createElement("tbody");this.t7.appendChild(this.t8);this.tY.appendChild(this.t7);this.initialize=function(maplet){this.maplet=maplet;this.maplet.sF.appendChild(this.tY)};this.ffp5=function(id){this.D8$27=id};this.C7eTH=function(_UV){this.overlay=_UV};this.addOverlay=function(_UV){this.u5[_UV.id]=_UV};this.removeOverlay=function(_UV){if(this.u5[_UV.id]){if(this.overlay==this.u5[_UV.id])this.hide();this.u5[_UV.id]=null;delete this.u5[_UV.id]}};this.getOverlaySize=function(){var c=0;for(var i in this.u5)c++;return c};this.containsOverlay=function(_UV){return typeof this.u5[_UV.id]!="undefined"&&this.u5[_UV.id]};this.update=function(){for(var i in this.t8.childNodes){if(typeof this.t8.childNodes[i]=="object"){if(this.t8.childNodes[i].panel!=null)this.t8.childNodes[i].panel=null;this.t8.removeChild(this.t8.childNodes[i])}}for(var qC=0;qC<this.qt.length;qC++){this.qt[qC].paint(this)}};this.addItem=function(item,pn){if(typeof pn=="undefined"){this.qt[this.qt.length]=item}else{pn=parseInt(pn);this.qt.splice(pn,0,item)}this.update()};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(this.getOverlaySize()>0){for(var i in this.u5)this.u5[i].removeContextMenu()}if(typeof this.maplet=="object"&&this.maplet){if(this==this.maplet.xc)this.maplet.xc=null;this.maplet=null}if(typeof finalize!="boolean")finalize=false;if(finalize){this.clear();_removeNode(this.tY);this.tY=null;this.qt=null}};this.removeItem=function(pn){if(pn<this.qt.length)this.qt[pn].remove();this.qt.splice(pn,1);this.update()};this.clear=function(){for(var i=0;i<this.qt.length;i++){this.qt[i].remove()}this.qt=new Array();this.update()};this.show=function(x,y){this.tY.style.left=parseInt(x)+"px";this.tY.style.top=parseInt(y)+"px";this.tY.style.visibility="visible"};this.hide=function(){this.tY.style.visibility="hidden"};this.toString=function(){return "com.mapbar.maplet.MContextMenu"}};var MSnapshotBox=function(i9F8,style){if(!(i9F8 instanceof Maplet)&&!i9F8)throw new Error("parameter para_maplet is invalid Maplet object.");var x6=(typeof style!="string"||!style)?"":style+"/";var b2hot=SNAPSHOT_SERVER;var EA52=SNAPSHOT_SERVER+"get";var maplet=i9F8;var Id_b=new Date().getTime();var ao=[];var $49="MSnapshotSizeTip"+Id_b;var sS9=$49+"_td";var krn9='<table cellpadding="2" cellspacing="0" style="background-color:#0E347F;color:#ff0;font-size:14px;font-family:Arial;-moz-user-select:none;-khtml-user-select:none;user-select:none;" onselectstart="return false;"><tr><td id="'+sS9+'"></td></tr></table>';var NVg=new fD($49,0,0,0,0,false,24,krn9,maplet.panel);NVg.div.style.width="auto";NVg.div.style.height="auto";var w66d="MSnapshotBox"+Id_b;var bi185='<table width="100%" height="100%" style="border:2px solid #0E347F;-moz-user-select:none;-khtml-user-select:none;user-select:none;" onselectstart="return false;" cellpadding="0" cellspacing="0"><tr><td style="background-color:#FFFFFF;filter:alpha(opacity=30);opacity:0.3;"></td></tr></table>';var f1XG8=new fD(w66d,0,0,0,0,false,24,bi185,maplet.panel);f1XG8.div.style.overflow="hidden";var sX4=117;var H$7m=23;var dOh="MSnapshotBar"+Id_b;var LE02="MSnapshotBtn_preview_"+Id_b;var k99="MSnapshotBtn_download_"+Id_b;var nF72="MSnapshotBtn_cancel_"+Id_b;var kj4i$="";kj4i$='<font id="'+LE02+'" class="snapshotTextBtn">\u9884\u89c8</font><font id="'+k99+'" class="snapshotTextBtn">\u4fdd\u5b58</font><font id="'+nF72+'" class="snapshotTextBtn" style="border-right: 1px solid #0E347F;">\u53d6\u6d88</font>';var n8805=new fD(dOh,0,0,0,0,false,24,kj4i$,maplet.panel);n8805.style.lineHeight=H$7m+"px";var _55e="mapbar_snapshot_iframe";var iframe=null;var RKr9="mapbar_snapshot_frm";var l079=null;var wkr=0;var A42X4={x:0,y:0,width:0,height:0,rect:{min:{x:0,y:0},max:{x:0,y:0}},center:""};this.e3r1y=false;this.l3r=false;this.show=function(){if(ao.length==0){ao.push(MEvent.bindDom(document.getElementById(dOh),"mousedown",this,hmn4x));ao.push(MEvent.bindDom(document.getElementById(LE02),"click",this,JUC8P));ao.push(MEvent.bindDom(document.getElementById(k99),"click",this,_2a3));ao.push(MEvent.bindDom(document.getElementById(nF72),"click",this,this.hide))}B68N9();this.hide();f1XG8.show();NVg.show()};this.hide=function(){var l8=C160(this.hide);if(typeof l8!="undefined"&&l8){if(l8.type=="click"){var target=typeof l8.target!="undefined"?l8.target:l8.srcElement;var id=target.id;if(id==nF72)MEvent.trigger(maplet,"snapshot_done","cancel");else if(id==LE02)MEvent.trigger(maplet,"snapshot_done","preview");else if(id==k99)MEvent.trigger(maplet,"snapshot_done","download")}}D68QO();$W6();Gj33y()};var D68QO=function(){f1XG8.hide();f1XG8.resize(0,0)};var $W6=function(){NVg.hide();NVg.moveTo(-1000,-1000)};var Gj33y=function(){n8805.hide();n8805.resize(0,0)};this.moveTo=function(x,y){f1XG8.moveTo(x,y);var $8f6=y-NVg.div.firstChild.clientHeight-2;NVg.moveTo(x,$8f6);if(y-NVg.div.offsetHeight<0){NVg.moveTo(x+3,$8f6+NVg.div.offsetHeight+5)}};this.resize=function(w,h){w=w<0?0:w;h=h<0?0:h;f1XG8.resize(w,h);this.S91m7(w+" x "+h)};this.S91m7=function(text){document.getElementById(sS9).innerHTML=text};this.isVisible=function(){return document.getElementById(w66d).style.visibility!="hidden"?true:false};this.p026W=function(){this.e3r1y=true;_bY$H();var x=A42X4.x+A42X4.width-sX4-2;var y=A42X4.y+A42X4.height;if(y+H$7m>maplet.height)y-=H$7m+(px?4:3);n8805.resize(sX4,H$7m);n8805.moveTo(x,y);n8805.show();maplet.q453("pointer",document.getElementById(LE02));maplet.q453("pointer",document.getElementById(k99));maplet.q453("pointer",document.getElementById(nF72));MEvent.trigger(maplet,"snapshot_select",{x:A42X4.x,y:A42X4.y,width:A42X4.width,height:A42X4.height})};this.snapshot=function(options){if(typeof options!="object")options={};if(typeof options.mode!="string"||(options.mode!="fullscreen"&&options.mode!="custom"))options.mode=SNAPSHOT_OPTIONS.mode;if(typeof options.x=="undefined"||isNaN(options.x))options.x=0;if(typeof options.y=="undefined"||isNaN(options.y))options.y=0;if(typeof options.width=="undefined"||isNaN(options.width))options.width=maplet.width;if(typeof options.height=="undefined"||isNaN(options.height))options.height=maplet.height;if(typeof options.zoom=="undefined"||isNaN(options.zoom))options.zoom=maplet.getZoomLevel();if(typeof options.format!="string")options.format=SNAPSHOT_OPTIONS.format;if(typeof options.depth=="undefined"||isNaN(options.depth))options.depth=SNAPSHOT_OPTIONS.depth;if(options.processMode!="string"&&(options.processMode!="event"&&options.processMode!="download"))options.processMode=SNAPSHOT_OPTIONS.processMode;_bY$H.apply(this,[options]);V9d1.apply(this,[options])};var V9d1=function(options){var s034={};s034.center=cy6.apply(this,[A42X4.center]);s034.point="";s034.TErp="";s034.area="";s034.width=A42X4.width;s034.height=A42X4.height;s034.zoom=typeof options.zoom=="undefined"?maplet.getZoomLevel():options.zoom;s034.format=typeof options.format=="undefined"?SNAPSHOT_OPTIONS.format:options.format;s034.depth=typeof options.depth=="undefined"?SNAPSHOT_OPTIONS.depth:options.depth;s034.processMode=typeof options.processMode=="undefined"?SNAPSHOT_OPTIONS.processMode:options.processMode;s034.N688="";s034.B37L="";s034.traffic=false;s034.L3X7="";s034.O33="";var rh0e=getMarkers();if(rh0e.length>0){s034.point=[];for(var i=0;i<rh0e.length;i++){var n1H2l=rh0e[i];s034.point.push(cy6.apply(this,[n1H2l.marker.pt.getPid()])+","+n1H2l.text+","+n1H2l.K093+","+n1H2l.Da1R+",,,"+n1H2l.src+","+n1H2l.bS48+","+n1H2l.bDF9J)}s034.point=s034.point.join("|")}var vw=getPolylines();if(vw.length>0){s034.TErp=[];s034.area=[];for(var i=0;i<vw.length;i++){var Jl582=[];var pts=vw[i].pts;for(var HB3=0;HB3<pts.length;HB3++){Jl582.push(cy6.apply(this,[pts[HB3].getPid()]))}var brush=vw[i].brush;if(vw[i].brush.fill){s034.area.push(Jl582.join(",")+";"+sWQ(brush.bgcolor)+";"+(parseFloat(brush.bgtransparency)/100)+";"+sWQ(brush.color)+";"+brush.stroke+";"+brush.style+";"+(parseFloat(brush.transparency)/100))}else{s034.TErp.push(Jl582.join(",")+";"+sWQ(brush.color)+";"+brush.stroke+";"+brush.style+";"+(parseFloat(brush.transparency)/100))}}if(s034.TErp.length>0)s034.TErp=s034.TErp.join("|");else s034.TErp="";if(s034.area.length>0)s034.area=s034.area.join("|");else s034.area=""}var N688=maplet.getEllipse();if(N688.length>0){s034.N688=[];for(var i=0;i<N688.length;i++){var item=N688[i];var brush=item.brush;s034.N688.push(cy6.apply(this,[item.gC.getPid()])+","+item.sax+","+U5402(item.say,"")+","+sWQ(brush.bgcolor)+","+(parseFloat(brush.bgtransparency)/100)+","+sWQ(brush.color)+","+brush.stroke+","+brush.style+","+(parseFloat(brush.transparency)/100))}if(s034.N688.length>0)s034.N688=s034.N688.join("|");else s034.N688=""}var t67n=getRoundRect();if(t67n.length>0){s034.B37L=[];for(var i=0;i<t67n.length;i++){var item=t67n[i];var brush=item.B37L.brush;s034.B37L.push(cy6.apply(this,[item.B37L._89BB.getPid()])+","+cy6.apply(this,[item.B37L.J7Gj5.getPid()])+","+item.xDv6+","+item.Q0e8H+","+sWQ(brush.bgcolor)+","+(parseFloat(brush.bgtransparency)/100)+","+sWQ(brush.color)+","+brush.stroke+","+brush.style+","+(parseFloat(brush.transparency)/100))}if(s034.B37L.length>0)s034.B37L=s034.B37L.join("|");else s034.B37L=""}if(maplet.traffic&&maplet.traffic.layer.getImgCount()){s034.traffic=true;s034.L3X7=maplet.traffic.options.city;s034.O33=maplet.traffic.getTimestampDir()}j5s.apply(this,[s034])};var cy6=function(_H0Sb){return _H0Sb.indexOf(",")!=-1?_H0Sb.replace(",","_"):_H0Sb};var M3A=function(){if(wkr>=3)return;var taskId=l079["taskId"].value;if(typeof _snapshot_result=="object"&&_snapshot_result){if(_snapshot_result.url!="inexistence"){switch(_snapshot_result.processMode){case "event":case "preview":MEvent.trigger(maplet,"snapshot",_snapshot_result.url);break;default:break}return}}window.setTimeout(function(thisObj){return function(){wkr++;new SwF6(EA52+"?taskId="+taskId,function(){M3A.apply(thisObj)}).e0b()}}.apply(this,[this]),1000)};var sWQ=function(color){if(color.substring(0,3).toLowerCase()=="rgb"){return color.replace(new RegExp(",","g"),"@")}return color};var JUC8P=function(){this.hide();var options={};options.processMode="preview";V9d1.apply(this,[options])};var _2a3=function(){this.hide();var options={};options.processMode="download";V9d1.apply(this,[options])};var hmn4x=function(e){QD199(e)};var getMarkers=function(){var v6=[];var D50_8=maplet.getMarkers();if(D50_8.length>0){for(var i=0;i<D50_8.length;i++){if(!D50_8[i].icon)continue;if(!D50_8[i].icon.isVisible())continue;var YTW=D50_8[i];var icon=YTW.icon;var gwK1=0,uI3=0,qDl=0,x63=0;var Vi057=0,pbL30=0;Vi057=gwK1=parseInt(icon.div.style.left);pbL30=uI3=parseInt(icon.div.style.top);qDl=icon.div.clientWidth;x63=icon.div.clientHeight;var K753$="",V5j52="",t7y="";if(D50_8[i].label){var T713=YTW.label;K753$=T713.getText();V5j52=parseInt(T713.div.style.left);t7y=parseInt(T713.div.style.top);var _MN7=T713.div.clientWidth;var f6X5w=T713.div.clientHeight;if(V5j52<gwK1)gwK1=V5j52;if(t7y<uI3)uI3=t7y;if((V5j52+_MN7)>(gwK1+qDl))qDl=V5j52+_MN7;if((t7y+f6X5w)>(uI3+x63))x63=t7y+f6X5w}if(_isRectint(A42X4.rect,{min:{x:gwK1,y:uI3},max:{x:gwK1+qDl,y:uI3+x63}})){v6.push({x:Vi057,y:pbL30,bS48:D50_8[i].icon.anchorX,bDF9J:D50_8[i].icon.anchorY,src:icon.getImgUrl(),text:K753$,K093:D50_8[i].label?D50_8[i].label.xoffset:0,Da1R:D50_8[i].label?D50_8[i].label.yoffset:0,marker:D50_8[i]})}}}return v6};var getPolylines=function(){var v6=[];var vw=maplet.getPolylines();if(vw.length>0){for(var i=0;i<vw.length;i++){var pts=vw[i].pts;var iY89=false;for(var HB3=0;HB3<pts.length;HB3++){var D59$x=pts[HB3].mapX;var D59$y=pts[HB3].mapY;if(_isInsideRect({x:D59$x,y:D59$y},A42X4.rect)){iY89=true;break}if(HB3>0){var D59$w36G=pts[HB3-1].mapX;var D59$mrqR1=pts[HB3-1].mapY;var y40N={start:{x:A42X4.rect.max.x,y:A42X4.rect.max.y},end:{x:A42X4.rect.max.x,y:A42X4.rect.min.y}};var jl3={start:{x:D59$w36G,y:D59$mrqR1},end:{x:D59$x,y:D59$y}};if(_IsIntersect(y40N,jl3)){iY89=true;break}y40N={start:{x:A42X4.rect.max.x,y:A42X4.rect.min.y},end:{x:A42X4.rect.min.x,y:A42X4.rect.min.y}};if(_IsIntersect(y40N,jl3)){iY89=true;break}y40N={start:{x:A42X4.rect.min.x,y:A42X4.rect.min.y},end:{x:A42X4.rect.min.x,y:A42X4.rect.max.y}};if(_IsIntersect(y40N,jl3)){iY89=true;break}y40N={start:{x:A42X4.rect.min.x,y:A42X4.rect.max.y},end:{x:A42X4.rect.max.x,y:A42X4.rect.max.y}};if(_IsIntersect(y40N,jl3)){iY89=true;break}}}if(!iY89&&vw[i].brush.fill){var dI22=vw[i].pts;var jA9=[];for(var HB3=0;HB3<dI22.length;HB3++)jA9.push({x:dI22[HB3].mapX,y:dI22[HB3].mapY});var rru5=[{x:A42X4.rect.max.x,y:A42X4.rect.max.y},{x:A42X4.rect.max.x,y:A42X4.rect.min.y},{x:A42X4.rect.min.x,y:A42X4.rect.min.y},{x:A42X4.rect.min.x,y:A42X4.rect.max.y}];for(var HB3=0;HB3<jA9.length;HB3++){if(_isInsidePolygon(jA9[HB3],rru5)){iY89=true}}if(!iY89){for(var HB3=0;HB3<rru5.length;HB3++){if(_isInsidePolygon(rru5[HB3],jA9)){iY89=true}}}}if(iY89){v6.push(vw[i])}}}return v6};var getRoundRect=function(){var v6=[];var t67n=maplet.getRoundRect();if(t67n.length>0){for(var i=0;i<t67n.length;i++){var item=t67n[i];var wE3={min:{x:item._89BB.mapX,y:item._89BB.mapY},max:{x:item.J7Gj5.mapX,y:item.J7Gj5.mapY}};if(_isRectint(A42X4.rect,wE3)){v6.push({xDv6:parseInt(item.width*item.arcsize)*2,Q0e8H:parseInt(item.height*item.arcsize)*2,B37L:item})}}}return v6};var XRa=function(k6NTT){var C_j=null;if(px){C_j=document.createElement("<input name='"+k6NTT+"'>")}else{C_j=document.createElement("input");C_j.name=k6NTT}C_j.type="hidden";return C_j};var j5s=function(pfy){try{wkr=0;if(typeof _snapshot_result=="object"&&_snapshot_result)_snapshot_result=null;if(!iframe){if(px){iframe=document.createElement("<IFRAME name='"+_55e+"'>")}else{iframe=document.createElement("IFRAME");iframe.name=_55e}iframe.id=_55e;iframe.frameBorder="0";iframe.style.width="0px";iframe.style.height="0px";iframe.style.zIndex=-1;maplet.panel.appendChild(iframe);var s91=function(thisObj){return function(){N$00.apply(thisObj)}};if(px)iframe.attachEvent("onreadystatechange",s91(this));else iframe.addEventListener("load",s91(this),false);l079=document.createElement("FORM");l079.id=RKr9;l079.method="POST";l079.target=_55e;l079.action=b2hot;maplet.panel.appendChild(l079);l079.appendChild(XRa("center"));l079.appendChild(XRa("customer"));l079.appendChild(XRa("size"));l079.appendChild(XRa("markers"));l079.appendChild(XRa("polylines"));l079.appendChild(XRa("polygons"));l079.appendChild(XRa("format"));l079.appendChild(XRa("depth"));l079.appendChild(XRa("processMode"));l079.appendChild(XRa("taskId"));l079.appendChild(XRa("codeform"));l079.appendChild(XRa("zoom"));l079.appendChild(XRa("ellipse"));l079.appendChild(XRa("roundrect"));l079.appendChild(XRa("traffic"));l079.appendChild(XRa("tcity"));l079.appendChild(XRa("ttime"))}l079["center"].value=pfy.center;l079["customer"].value=(strLicenseKey=="3409")?0:1;l079["size"].value=pfy.width+"x"+pfy.height;l079["markers"].value=pfy.point;l079["polylines"].value=pfy.TErp;l079["polygons"].value=pfy.area;l079["format"].value=pfy.format;l079["depth"].value=pfy.depth;l079["processMode"].value=pfy.processMode;l079["taskId"].value=new Date().getTime();l079["codeform"].value="1";l079["zoom"].value=pfy.zoom;l079["ellipse"].value=pfy.N688;l079["roundrect"].value=pfy.B37L;l079["traffic"].value=pfy.traffic;l079["tcity"].value=pfy.L3X7;l079["ttime"].value=pfy.O33;if(!px)l079.target=_55e;l079.submit()}catch(nc){iframe=null;l079=null}};var N$00=function(){if(px&&iframe.readyState!="complete")return;M3A.apply(this)};var _bY$H=function(options){if(typeof options=="undefined"){with(A42X4){x=parseInt(f1XG8.div.style.left);y=parseInt(f1XG8.div.style.top);width=f1XG8.div.clientWidth;height=f1XG8.div.clientHeight}}else{if(options.mode=="fullscreen"){options.width=maplet.width;options.height=maplet.height}with(A42X4){x=options.x;y=options.y;width=options.width;height=options.height}}with(A42X4){rect={min:{x:x,y:y},max:{x:x+width,y:y+height}};center=maplet.toMapCoordinate(x+width/2,y+height/2)}};var B68N9=function(){with(A42X4){x=0;y=0;width=0;height=0;rect=null}};this.finalize=function(){for(var i=0;i<ao.length;i++){MEvent.removeBuiltInListener(ao[i]);ao[i]=null}ao=null;NVg.finalize();NVg=null;f1XG8.finalize();f1XG8=null;n8805.finalize();n8805=null;_removeNode(iframe);iframe=null;_removeNode(l079);l079=null;maplet=null};this.toString=function(){return 'com.mapbar.maplet.MSnapshotBox'}};var MIconShadow=function(url,width,height,anchorX,anchorY){this.X6899=0;this.div=document.createElement("div");this.div.unselectable="on";this.div.style.zIndex=this.X6899;this.div.style.position="absolute";if(typeof width=="number")width=parseInt(width);if(typeof height=="number")height=parseInt(height);this.div.style.lineHeight="0px";this.div.style.left=Number.MAX_VALUE+"px";this.div.style.top=Number.MAX_VALUE+"px";maplet.lA.appendChild(this.div);this.img=null;if(typeof url=="string"&&url.indexOf("<")<0){this.img=(i639)?document.createElement("v:Image"):new Image();this.img.unselectable="on";this.img.style.MozUserSelect="none";this.img.style.zIndex=this.X6899;this.img.src=(typeof url=="undefined")?strImgsvrUrl+"images/Shadow.png":url;this.div.appendChild(this.img);if(typeof width=="number")this.img.style.width=width+"px";if(typeof height=="number")this.img.style.height=height+"px"}else{if(typeof url=="string")this.div.innerHTML=url;else this.div.appendChild(url);if(typeof width=="number")this.div.style.width=width+"px";if(typeof height=="number")this.div.style.height=height+"px"}MPanel.enableDragMap(this.div,true);this.width=this.div.offsetWidth;this.height=this.div.offsetHeight;this.anchorX=this.width/2;this.anchorY=this.height/2;this.anchorX=parseInt((typeof anchorX=="undefined")?this.anchorX:this.anchorX+anchorX);this.anchorY=parseInt((typeof anchorY=="undefined")?this.anchorY:this.anchorY+anchorY);this.left=0;this.top=0;this.wz=function(id){this.div.id="mk_shadow_c_"+id;if(this.img)this.img.id="mk_shadow_"+id};this.initialize=function(marker){this.marker=marker;if(this.img){if(px)this.img.ondragstart=function(){return false};this.img.onmousedown=function(){return false}}};this.update=function(maplet,left,top){if(this.marker.autoHide&&!this.marker.icon.isVisible()){if(this.div.parentNode){this.div.parentNode.removeChild(this.div);this.fu=false}}else{var zB=parseInt(left)-parseInt(this.anchorX);var zF=parseInt(top)-parseInt(this.anchorY);if(this.div.parentNode!=maplet.lA.div&&!this.marker.ls){maplet.lA.appendChild(this.div);this.fu=true}this.div.style.top=zF+"px";this.div.style.left=zB+"px";this.top=zF;this.left=zB}};this.isVisible=function(){return(this.fu)};this.zq=function(){return(this.img?this.img.src:"")+","+this.width+","+this.height};this.hilite=function(){if(this.div){if(this.div.style.zIndex<pF){pF++}this.setZIndex(pF)}};this.finalize=function(){this.remove(true)};this.remove=function(finalize){if(typeof finalize!="boolean")finalize=false;if(this.img){if(px)this.img.ondragstart=null;this.img.onmousedown=null}if(this.div){if(!finalize){if(this.div.parentNode)this.div.parentNode.removeChild(this.div)}else{_removeNode(this.div);this.div=null}}if(finalize)this.marker=null};this.setZIndex=function(CV0){if(this.div&&this.div.parentNode&&CV0!=this.div.style.zIndex){this.X6899=this.div.style.zIndex;this.div.style.zIndex=CV0}};this.e4501=function(){if(!this.div)return;if(this.X6899!=this.div.style.zIndex){this.setZIndex(this.X6899)}};this.toString=function(){return 'com.mapbar.maplet.MIconShadow'}};window["MVersion"]={"version":"31.2","build":"20140220140657"};var Maplet=function(gx,gA,AB,w,h,Ak,Al,yv,x6){if(px){try{document.execCommand("BackgroundImageCache",false,true)}catch(nc){}}this.downX=0;this.downY=0;this.moveX=0;this.moveY=0;this.fS=0;this.fT=0;this.offsetX=0;this.offsetY=0;this.H9W5={cursor:strImgsvrUrl+"images/measure.cur",_2GFL:i639?"<div style='position:absolute;width:11px;height:11px;overflow:hidden;'><img src='"+sX+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-65px;top:-100px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);' galleryimg='no' unselectable='on' onmousedown='return false;' /></div>":"<div style='position:absolute;width:11px;height:11px;overflow:hidden;'><img src='"+CTLIMG_RESOURCE[0].url+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-65px;top:-100px;' galleryimg='no' unselectable='on' onmousedown='return false;'></div>",AUO20:"\u5355\u51fb\u786e\u5b9a\u8d77\u70b9",w0l62:"\u603b\u957f: <font color='red'>[DISTANCE]</font></br><font color='gray'>\u5355\u51fb\u786e\u5b9a\u5730\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f</font>",wV9:"\u8d77\u70b9",P9V9n:"[DISTANCE]",q118:"<div style='position:absolute;width:12px;height:12px;overflow:hidden;top:50%;margin-top:-6px;left:2px;'><img src='"+CTLIMG_RESOURCE[0].url+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-86px;top:0px;cursor:pointer' galleryimg='no' unselectable='on' onmousedown='return false;'></div><span style='padding-left:14px;height:18px;line-height:18px;display:block;float:left;'>\u603b\u957f: [DISTANCE]</span>",j6y:"[DISTANCE]",D6313:"[TIP]",tip:"<div style='position:absolute;height:18px;line-height:19px;_line-height:18px;border:1px solid gray;background:white;padding:0 3px;padding:2px 3px 0\a;font-size:12px;color:gray;white-space:nowrap;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px;' unselectable='on'>[TIP]</div>",IKb57:new MBrush("#FF0000",3,0,false,"#FF0000",50),P5D61:new MBrush("#FF0000",3,0,false,"#FF0000",30)};this.a5xg=[];ac=new Date();this.imgWidth=300;this.imgHeight=300;this.clickToCenter=true;this.y1Mnm={};this.NV26={};this.customInfoWindow=false;this.X8f6=-1;this.RSL=-1;this.$83=200;this.ignoreMoveRange=2;this.Su15=false;this.ycE=0;this.jx7h8=0;this._67R=false;this.B076=false;this.O71Wl=null;this.tJW3=null;this.R8G=null;this.h98F=[];w88=[];this.fl5T="";this.iEN7B=-1;this.W97=-1;this.sT2_4="";this.AP2=null;this.No1=null;this.E8_2={container:null,Xb0Kb:[],yN:null,xd:0.12,GE_p6:4,fG6v:1,interval:100,Qh877:{width:85,height:68},m8_0:{width:35,height:27}};this.Fqa={fC:null,width:16,height:16,offsetY:5,Rk4:3,Yb1:4,overlay:null};this.AC_L=-1;this.t40w=false;this.w205=true;this.l4p=false;this.gxr=bpp[0];this.traffic=null;this.sIb=true;this.r9fhe=5;this.markerDragAnimation=true;this.qS={};this.layerData={};this.Xo911=[];this.layerDataPassiveUrl="";this._96o3=null;this.qpgD=null;this.l9r={width:41,height:20};this.IFW={width:0,height:0};this.rlConfig={url:"http://3in1.mapbar.com/s?t=snsn",resultName:"rlm"+new Date().getTime(),Hn7H8:false,_2GFL:i639?"<div style='position:absolute;width:11px;height:11px;overflow:hidden;'><img src='"+sX+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-65px;top:-112px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);' galleryimg='no' unselectable='on' onmousedown='return false;' /></div>":"<div style='position:absolute;width:11px;height:11px;overflow:hidden;'><img src='"+CTLIMG_RESOURCE[0].url+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-65px;top:-112px;' galleryimg='no' unselectable='on' onmousedown='return false;'></div>",tip:{start:"\u70b9\u51fb\u5f00\u59cb\u6cbf\u9053\u8def\u753b\u4e00\u6761\u7ebf",one:"\u70b9\u51fb\u7ee7\u7eed\u753b\u7ebf",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\uff0c\u53ef\u7ed3\u675f\u6b64\u7ebf\u8def",yp3:"<div class='roadlineTip'><div class='roadlineTip_distance' style='display:none'></div><div></div></div>"}};this.IcK4={$923:[],Ife:[],YIX:false,f_jv:null,wmjh:{i7S:0,XCk1:0,g09y4:0,y3X:0},tip:new MPanel({location:{type:"xy"},content:this.rlConfig.tip.yp3,creator:MPanel.SYSTEM}),r18:{W1C1:0,M440:0},XlM:1};this.mapBound=null;this.E108=false;this.wL1B=null;this.allowDrawingDragMap=true;this.Jj1j=true;this.dM6O=false;this.sS=ts.ty;this.id="mapbar";this.yt=((new Date().getTime())%86400000).toString(36)+(parseInt(Math.random()*1000)).toString(36);if(typeof strRemoteIP!="undefined"&&strRemoteIP){this.yt+="*"+strRemoteIP}document["mapbar-maplet"]=this;this.left=(typeof Ak=="undefined")?0:parseInt(Ak);this.top=(typeof Al=="undefined")?0:parseInt(Al);this.width=(typeof w=="undefined")?600.00001:parseInt(w);this.height=(typeof h=="undefined")?400.00001:parseInt(h);if(isNaN(parseFloat(gx))||(typeof gx=="string"&&gx.length>3&&gx.substring(0,3).toLowerCase()=="inf")){this.id=gx;this.panel=(typeof gx=="object")?gx:document.getElementById(gx);if(gA!=null&&gA!="undefined"){var zh=cq.vp(gA);this.gx=Math.min(sy[1],Math.max(sy[0],parseFloat(zh[1])));this.gA=Math.min(sz[1],Math.max(sz[0],parseFloat(zh[0])%360));zh=null}if(typeof this.panel!="undefined"&&this.panel!=null){if(!this.panel.style.zIndex)this.panel.style.zIndex=0;this.left=0;this.top=0;if(this.panel.style.left)this.left=parseInt(this.panel.style.left);if(this.panel.style.top)this.top=parseInt(this.panel.style.top);if(!this.panel.style.height){this.panel.style.height=this.panel.clientHeight+'px'};if(!this.panel.style.width){this.panel.style.width=this.panel.clientWidth+'px'};if(this.panel.style.width)this.width=parseInt(this.panel.style.width);if(this.panel.style.height)this.height=parseInt(this.panel.style.height)}}else{this.gA=gA;this.gx=gx}this.strImgUrl=strImgsvrUrl;this.AG=(typeof AB=="undefined")?0:parseInt(AB);this.nT=0;this.py=0;this.rotation=0;this.gk=Math.cos(this.rotation/180*Math.PI);this.wT=Math.sin(this.rotation/180*Math.PI);this.yv=(yv=="undefined")?"":yv;this.pU=new Array();this.qE=new Array();this.yl=(typeof x6=="undefined"||x6==null)?ds:x6;this.u2=null;this.u3='';this.xK="png"+_0n;this.xw=this.yl;this.yh="";this.x4=this.yl;this.x3=null;this.uu=null;this.xX=this.yl;this.pJ=null;this.b17W=[ ["",1],[2,3] ];this.bp=true;this.ff=false;this.fe=true;this.sf=null;this.fj=(typeof bDefaultControlOn=="undefined")?true:bDefaultControlOn;this.fa=false;this.z4=Math.ceil((this.width)/(this.imgWidth)/2);this.z5=Math.ceil((this.height)/(this.imgHeight)/2);this.aO=new Array();this.aN=new Array();this.yG=new Array();this.t1B_=null;this.pU=new Array();this.aE=new Array();this.aF=null;this.aG=null;this.aH=null;this.zy=null;this.tG=null;this.brush=new MBrush("#FF0000",3);this.sv=0;this.fo=false;this.gJ=null;this.gI=new Image();this.K3g7i=new MBound(0,0,0,0);this.bInitialized=false;this.c0=false;this.w3=new Array();this.cI=true;this.cn=false;this.gc=[];this.u5=[];this.u5['length']=0;this.vA=this.sS;this.fs=false;this.c9=false;this.eJBPr=null;this.tD=0;this.gM=1.0;this.xc=null;this.mapContextMenu=null;this.overview=new WD1x3(this);this.ovw=this.overview;this.wK=new Array();if(typeof this.panel=="undefined"||this.panel==null){document.writeln('<div unselectable="on" id="'+this.id+'" style="position:absolute;overflow:hidden; width:'+this.width+'px; height:'+this.height+'px; left:'+this.left+'px; top:'+this.top+'px;"></div>');this.panel=aa(this.id)}else{this.panel.style.overflow="hidden"}this.map=this.panel;if(this.map){this.map.setAttribute("align","left");if(this.map.style.position!="absolute"){this.map.style.position="relative"}var N52j="http://www.mapbar.com/ApiCopyrightLink.html?referrer="+window.location.host;this.qI8Q4=document.createElement("div");this.qI8Q4.style.width=this.l9r.width+"px";this.qI8Q4.style.height=this.l9r.height+"px";this.qI8Q4.style.overflow="hidden";this.qI8Q4.innerHTML="<img src='"+CTLIMG_RESOURCE[0].url+"' style='position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-25px;top:-158px' />";this.qI8Q4.id="ImgCopyright";this.qI8Q4.style.position="absolute";this.qI8Q4.style.zIndex=3;this.qI8Q4.style.top=(this.height-22)+"px";this.qI8Q4.setAttribute("whohide","");this.qI8Q4.style.cursor="pointer";this.qI8Q4.onclick=function(){window.open(N52j)};this.W534=document.createElement('div');this.W534.style.position='absolute';this.W534.style.zIndex=3;this.W534.style.fontSize='12px';this.W534.style.fontFamily='Arial';this.W534.style.top=(this.height-25)+'px';this.W534.style.left=(this.width-70)+'px';this.W534.style.background='none';this.W534.style.whiteSpace='nowrap';var $464=document.createElement('span');$464.style.color='#000';$464.style.margin='0 10px 0 0';$464.innerHTML='GS(2013)6018\u53F7';var gdkj=document.createElement('a');gdkj.setAttribute('target','_blank');gdkj.setAttribute('href','http://www.navinfo.com.cn');gdkj.innerHTML='Data&nbsp;&copy;&nbsp;NavInfo';gdkj.style.color='blue';gdkj.style.textDecoration='none';this.W534.appendChild($464);this.W534.appendChild(gdkj);this.map.appendChild(this.qI8Q4);this.map.appendChild(this.W534);this.IFW.width=this.W534.offsetWidth;this.IFW.height=this.W534.offsetHeight}this.gn1=false;this.R__7=false;this.uw=0;this.t9=0;this.xe=10;if(bp){this.setOverlay('base')}this.fM=null;this.AY=0.2;this.AS=-1;this.AT=0;this.AZ=null;this.vg=20.0;this.vh=null;this.Ah=null;this.vc=0;this.vd=0;this.vi=0;this.tB={"zoomin":1,"zoomout":2,"pan":3,"erase":13,"edit":23,"lookup":5,"bookmark":6,"drawline":9,"drawarea":10,"measure":11,"measarea":15,"snapshot":24,"roadline":25};this.kbx1=strImgsvrUrl+'mapbank/mapbar/';this.gaSe=strImgsvrUrl+'mapbank/mapbar/';;this.h23='png'+_0n};Maplet.MICON_IMGSRC_FLAG="imgsrc";Maplet.MLABEL_TEXT_FLAG="lbltext";Maplet.LEFT_TOP=1;Maplet.LEFT_BOTTOM=2;Maplet.RIGHT_TOP=3;Maplet.RIGHT_BOTTOM=4;Maplet.UNLOAD=0;Maplet.LOADING=1;Maplet.LOADED=2;Maplet.XN8=3;Maplet.prototype={onresize:function(){if(this.controlCanvas&&this.controlCanvas.options.view.ruler){if(this.height>=270){this.controlCanvas.showCtlRuler(true,true,false)}else{this.controlCanvas.showCtlRuler(false,true,false)}}this.md0();this.F0lQ();this.k1xp()},k1xp:function(){if(this.wL1B&&this.HC358){this.HC358.setAttribute("viewBox","-"+this.width+" -"+this.height+" "+this.width*3+" "+this.height*3);this.HC358.setAttribute("style","position: absolute; left: -"+this.width+"px; top: -"+this.height+"px; z-index: 0;");this.HC358.setAttribute("height",this.height*3+"px");this.HC358.setAttribute("width",this.width*3+"px")}},md0:function(){var Y158$={w:0,h:this.l9r.height};if(this.qI8Q4.style.display!="none")Y158$.w=Y158$.w+this.l9r.width+5;if(this.sIb)Y158$.w=Y158$.w+this.IFW.width+5;var GA59=this.width;if(this.controlCanvas&&this.controlCanvas.options.location.type==Maplet.RIGHT_BOTTOM){GA59=GA59-this.controlCanvas.getRect().width}if(this.overview.location.type==Maplet.RIGHT_BOTTOM){var BMl_=this.overview.getRect();if(GA59>=BMl_.min.x&&BMl_.min.x!=0){GA59=BMl_.min.x;if((this.width-BMl_.max.x>=Y158$.w)||(this.height-BMl_.max.y>=Y158$.h))GA59=this.width}}var e146=this.sIb?this.IFW.width:0;var $r_3=this.sIb?U5402(this.W534.style.left):GA59;if(this.sIb){with(this.W534.style){left=GA59-e146-5+"px";top=(this.height-23)+"px";$r_3=this.sIb?U5402(left):GA59}}with(this.qI8Q4){if(style.display!="none"){style.left=$r_3-offsetWidth-5+"px";style.top=(this.height-26)+"px"}}},nI:function(){if(!this.ff)return null;if(this.AP==null){this.AP=new AO(this,-1,this.width-16,0,16,this.height,this.ff,this.panel)}return this.AP},wP:function(e){QD199(e);if(this.Su15)return false;var pt=new MPoint(this.toMapCoordinate(this.moveX,this.moveY));pt.initialize(this);MEvent.trigger(this,"contextmenu",pt);var target=(px)?event.srcElement:e.target;if(this.xc)this.xc.hide();if(target.id.indexOf('MPolyline_')>-1){if(target.id.indexOf('_midnode_')>-1)return;var wi5Sn=target.xSi;if(!wi5Sn.xKpH){if(wi5Sn.pts.length<=2)return}}var menu=null;var overlay=target.getAttribute("oid");overlay=typeof this.u5[overlay]!="undefined"?this.u5[overlay]:null;if(overlay&&typeof overlay.getContextMenu=="function"){menu=overlay.getContextMenu(target)}else if(typeof target.contextmenu!="undefined"&&target.contextmenu){menu=target.contextmenu}if(menu){this.xc=menu;menu.ffp5(typeof target.id=="string"?target.id:"");menu.C7eTH(overlay);menu.show(this.moveX,this.moveY)}else{if(this.mapContextMenu!=null){this.xc=this.mapContextMenu;this.mapContextMenu.show(this.moveX,this.moveY)}}},getContextMenu:function(){return this.mapContextMenu},setContextMenu:function(uc){if(this.mapContextMenu!=uc){this.removeContextMenu()}this.mapContextMenu=uc;if(this.mapContextMenu!=null){this.mapContextMenu.initialize(this)}},setStandardContextMenu:function(uc){this.xc=uc},removeContextMenu:function(){if(this.mapContextMenu!=null){if(this.xc==this.mapContextMenu)this.xc=null;this.sF.div.removeChild(this.mapContextMenu.tY);this.mapContextMenu.maplet=null;this.mapContextMenu=null}},showMap:function(){if(i639&&this.width>0){this.panel.style.width=(this.width-1)+"px";this.panel.style.height=(this.height-1)+"px";this.panel.style.width=this.width+"px";this.panel.style.height=this.height+"px"}if(Hg6||RoY5)this.panel.onselectstart=function(){return false};if(MapBackgroundColor)this.panel.style.backgroundColor=MapBackgroundColor;MEvent.bindDom(this.panel,"contextmenu",this,this.wP);this.sG=new fD("MapContainerBg",0,0,this.width,this.height,true,0,'',this.panel);this.sF=new fD("MapContainer",0,0,this.width,this.height,true,2,'',this.panel);this.zs=new fD("ToolTip",0,0,0,0,false,24,'',this.sF);this.sE=new fD("LayerMap",0,0,this.width,this.height,true,2,'',this.sF);this.vx=new fD("LayerPoiMap",0,0,this.width,this.height,true,3,'',this.sF);this.nI();if(this.fj){var gV=new MStandardControl();this.addControl(gV);this.controlCanvas=gV.nR}this.wq=new fD("LayerScale",1,this.height-24,70,24,this.fe,3,'',this.panel);var content='<table border="0" width="100%" height="100%" style="border:2px solid #0E347F;"><tr ><td align="center" valign="middle" style="filter:alpha(opacity=30);opacity:0.3;background-color:#FFFFFF;"></td></tr></table>';this.sD=new fD("LayerBorder",1,1,1,1,false,6,content,this.panel);this.sD.style.border="1px solid #FFFFFF";this.snapshotBox=new MSnapshotBox(this);content="<div style=\"position:absolute;border-width:2px 0px 0px 2px;border-style:solid;border-color:red;width:4px;height:4px;left:0px;top:0px;line-height:1px;\"></div><div style=\"position:absolute;border-width:2px 2px 0px 0px;border-style:solid;border-color:red;width:4px;height:4px;left:28px;top:0px;line-height:1px;\"></div><div style=\"position:absolute;border-width:0px 0px 2px 2px;border-style:solid;border-color:red;width:4px;height:4px;left:0px;top:20px;line-height:1px;\"></div><div style=\"position:absolute;border-width:0px 2px 2px 0px;border-style:solid;border-color:red;width:4px;height:4px;left:28px;top:20px;line-height:1px;\"></div>";this.E8_2.container=new fD("_mapbar_mw_indicator",0,0,this.E8_2.m8_0.width,this.E8_2.m8_0.height,true,100,content,this.panel).div;this.E8_2.container.style.display="none";this.E8_2.Xb0Kb=this.E8_2.container.getElementsByTagName("div");this.lA=new fD("LayerDrawMap",0,0,this.width,this.height,true,4,'',this.sF);if(px)this.lA.style.backgroundImage="url("+sX+")";if(!px){this.lA.style.MozUserSelect="none"}this.lA.style.VsCXG="none";this.lA.div.setAttribute(_Fj3O,"true");this.Fqa.fC=new fD("_mapbar_drag_cross",0,0,this.Fqa.width,this.Fqa.height,true,2,'',this.panel);with(this.Fqa.fC.div){style.width=this.Fqa.width+"px";style.height=this.Fqa.height+"px";style.display="none";style.overflow="hidden"}if(i639)this.Fqa.fC.div.innerHTML="<v:image  style=\"position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-49px;top:-108px;\" src='"+CTLIMG_RESOURCE[0].url+"' />";else this.Fqa.fC.div.innerHTML="<img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-49px;top:-108px;\">";this.overview.qa(this.panel);{var rightMargin=15;var ui=0;this.sg=(this.width>360)?150:73;if((this.overview.nF()+this.overview.nz())>(this.height-23)){ui+=Math.max(0,this.overview.nH()-(this.sg-70))}}{var V0d=document;if(px||HxT){V0d=this.map}this.y1Mnm["map_mousemove"]=MEvent.bindDom(V0d,"mousemove",this,this.a3);this.y1Mnm["map_mousedown"]=MEvent.bindDom(this.map,"mousedown",this,this.a2);this.y1Mnm["map_mouseup"]=MEvent.bindDom(V0d,"mouseup",this,this.a6);this.y1Mnm["map_click"]=MEvent.bindDom(this.map,"click",this,this.aZ);this.y1Mnm["map_dblclick"]=MEvent.bindDom(this.map,"dblclick",this,this.a1);this.y1Mnm["map_mouseout"]=MEvent.bindDom(this.map,"mouseout",this,this.a4);this.y1Mnm["map_drag"]=MEvent.bindDom(this.map,"drag",this,this.a3);this.y1Mnm["map_dragstart"]=MEvent.bindDom(this.map,"dragstart",this,this.a3);this.y1Mnm["map_dragend"]=MEvent.bindDom(this.map,"dragend",this,this.a3);this.y1Mnm["map_mouseover"]=MEvent.bindDom(this.map,"mouseover",this,this.a5);this.y1Mnm["map_mousewheel"]=MEvent.bindDom(this.map,"mousewheel",this,this.a7);this.y1Mnm["map_DOMMouseScroll"]=MEvent.bindDom(this.map,"DOMMouseScroll",this,this.a7);if(kp){this.y1Mnm["document_keydown"]=MEvent.bindDom(document,"keydown",this,this.onkeydown)}}this.qd();this.setZoomLevel(this.AG);this.setMode(this.sS);if(this.zP==null){this.zP=setInterval("document['mapbar-maplet'].zL()",100)}},qd:function(){this.sD.hide();this.sD.resize(1,1);this.sD.moveTo(-10,-10);if(document.all){this.sE.moveTo(0,0);this.sE.show();this.vx.moveTo(0,0);this.vx.show();this.lA.moveTo(0,0);this.lA.show()}},setStyle:function(x7,xH){if(this.yl!=x7){this.yl=x7;if("aerial"==this.yl||this.yl.indexOf("aerial")>=0){this.xK="jpg"}else{this.xK="png"}if(typeof xH!="undefined"){this.xK=xH}if(typeof this.sF!="undefined"){for(var i in this.pU){try{if(this.pU[i]!=null&&typeof this.pU[i]=="object"){if(this.pU[i].parentNode!=null){this.pU[i].parentNode.removeChild(this.pU[i])}this.pU[i]=null}}catch(e){}}this.refresh();MEvent.trigger(this,"style",x7)}}},setRotation:function(v0){if(px&&rs){this.rotation=v0;this.gk=Math.cos(this.rotation/180*Math.PI);this.wT=Math.sin(this.rotation/180*Math.PI)}},setHeadMode:function(pz){this.nT=pz},setOverlay:function(xZ,uz){if(typeof uz=="string"){this.u3=uz}if(this.u2!=xZ){this.u2=xZ}if(typeof this.sF!="undefined"){this.refresh()}},q39:function(){var ll=sj[this.AG]*this.width/this.imgWidth;this.K3g7i.tl=(this.gA-ll/2);this.K3g7i.s6=(this.gA+ll/2);var lk=qP[this.AG]*this.height/this.imgHeight;this.K3g7i.tj=(this.gx-lk/2);this.K3g7i.s4=(this.gx+lk/2)},refresh:function($_4){this.u0($_4);this.u8()},fL:function(){if(this.fM!=null){clearTimeout(this.fM);this.fM=null}if(this.c0||this.fs||f1.fx.length>0){this.fM=getTimeout(this,this.fL,100);return}this.no()},no:function(){var pL=0;for(var i in this.pU){try{if(this.pU[i]!=null&&typeof this.pU[i]=="object"){if(this.pU[i].c2==true){}else{if(this.pU[i].parentNode!=null){_removeNode(this.pU[i])}this.pU[i].onerror=null;this.pU[i].onload=null;this.pU[i]=null;delete this.pU[i];pL++}}}catch(e){}}},zL:function(){if(this.t40w||this.fs||this.c0||(typeof this.Ai!="undefined"&&this.Ai!=0))return;var sP=parseInt(this.sF.style.left);var sQ=parseInt(this.sF.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0||(sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){this.fs=true;this.zA()}},zA:function(){if(this.fs==false)return;var sP=parseInt(this.sF.style.left);var sQ=parseInt(this.sF.style.top);if((sP+this.tf1)>=0||(sP+this.sZ-this.width)<=0){if(this.c0==true)return;this.c0=true;try{var qy=0;var p1=0;if((sP+this.tf1)>=0){this.th--;this.tf1-=parseInt(this.imgWidth);qy=this.th;p1=this.tf1}if((sP+this.sZ-this.width)<=0){this.s2++;p1=this.sZ;this.sZ+=parseInt(this.imgWidth);qy=this.s2}var ix=qy;var nL=nM[this.AG];var s8=parseInt(360/sj[this.AG]);qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var yk=this.yl;for(var iy=this.ti;iy<=this.s3;iy++){var qA=iy;var p3=(-(iy-this.ti+1)*this.imgHeight)+this.s1;this.aA(p1,p3,qy,qA,ix,iy,yk)}this.c0=false}catch(e){}}if((sQ+this.tg)>=0||(sQ+this.s1-this.height)<=0){if(this.c0==true)return;this.c0=true;try{var qA=0;var p3=0;if((sQ+this.tg)>=0){this.s3++;this.tg-=parseInt(this.imgHeight);qA=this.s3;p3=this.tg}if((sQ+this.s1-this.height)<=0){this.ti--;p3=this.s1;this.s1+=parseInt(this.imgHeight);qA=this.ti}var iy=qA;var nL=nM[this.AG];var s8=parseInt(360/sj[this.AG]);var yk=this.yl;for(var ix=this.th;ix<=this.s2;ix++){var qy=ix;qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var p1=((ix-this.th)*this.imgWidth)+this.tf1;this.aA(p1,p3,qy,qA,ix,iy,yk)}this.c0=false}catch(e){}}this.fs=false},aA:function(p1,p3,qy,qA,ix,iy,yk){var nL=nM[this.AG];var dirx=parseInt(Math.floor((qy)/nL));var diry=parseInt(Math.floor((qA)/nL));if(dirx<0)dirx+=1;if(diry<0)diry+=1;var Xn1=(qy)-dirx*nL;var yNj39=(qA)-diry*nL;var pM=this.kbx1.replace("img","img"+this.b284(Xn1,yNj39))+this.sR;var xY=((this.AG).toString(16)+ix.toString(16)+'l'+iy.toString(16)).toLowerCase();if(this.AG>=14)pM+=dirx+"/";pM+=dirx+"_"+diry+"/";pM+=Xn1+"_"+yNj39+"."+this.xK;if(pM&&pM.indexOf("NaN")<0){if(this.pU[xY]==null){if(rs==0||!px){this.pU[xY]=new Image();this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute"}else{this.pU[xY]=document.createElement("v:Image");this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute";this.pU[xY].cE="f";this.pU[xY].style.rotation=this.rotation;this.pU[xY].style.width=this.imgWidth+"px";this.pU[xY].style.height=this.imgHeight+"px"}f1.nk(this.pU[xY],pM,this.imgWidth,this.imgHeight);this.sE.div.appendChild(this.pU[xY])}else{if(px&&rs){this.pU[xY].style.rotation=this.rotation}}var p2=(p1+this.imgWidth/2-this.width/2)*this.gk-(p3+this.imgHeight/2-this.height/2)*this.wT+this.width/2;var p5=(p1+this.imgWidth/2-this.width/2)*this.wT+(p3+this.imgHeight/2-this.height/2)*this.gk+this.height/2;this.pU[xY].style.top=parseInt(p5-this.imgHeight/2)+"px";this.pU[xY].style.left=parseInt(p2-this.imgWidth/2)+"px";this.pU[xY].c2=true;this.pU[xY].setAttribute("origy",parseInt(p5-this.imgHeight/2));this.pU[xY].setAttribute("origx",parseInt(p2-this.imgWidth/2));xY=null}pM=null},V0382:function(){this.no();this.sG.div.style.width=this.sE.div.style.width;this.sG.div.style.height=this.sE.div.style.height;this.sG.div.style.left=this.sE.div.style.left;this.sG.div.style.top=this.sE.div.style.top;this.sG.div.style.visibility="visible";for(var i in this.pU){var img=this.pU[i];if(img&&img.parentNode){img.parentNode.removeChild(img);this.sG.div.appendChild(img)}}this.$g5T();this.w205=false},$g5T:function(){for(var i in this.pU){var img=this.pU[i];if(img&&img.parentNode)img.c2=false}},r3KEY:function(){this.$g5T();this.no()},u8:function(nn,zE){if(this.fe){var ws=(this.xg*100*60/parseInt(this.imgWidth))*this.gM;;var ns="#000000";var xC=(en)?"km":tX("%u516E%uE338");var xF=(en)?"mi":tX("%u54EA");ws=(ws<10)?(ws).toPrecision(1):parseInt(ws);if(this.wq.div.innerHTML==""){var x2=["<div id=\"_scaleValue\" style=\"position:absolute;font-family: arial;FONT-SIZE: 12px; color:"+ns+";FONT-WEIGHT: bold;left:4px;top:0px;\">&nbsp;"+ws+" "+xC+"</div>"];x2.push("<div style=\"position:absolute;width:69px;height:11px;overflow:hidden;top:8px;\">");if(i639){x2.push("<img src=\""+sX+"\" style=\"position:absolute;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+CTLIMG_RESOURCE[0].url+",sizingMethod=scale);width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;left:-8px;top:-209px;border:0px;\" onmousedown=\"return false;\" unselectable=\"on\" galleryimg=\"no\" />")}else{x2.push("<img src=\""+CTLIMG_RESOURCE[0].url+"\" style=\"position:absolute;left:-8px;top:-209px;width:"+CTLIMG_RESOURCE[0].w+"px;height:"+CTLIMG_RESOURCE[0].h+"px;border:0px;\" onmousedown=\"return false;\" unselectable=\"on\" galleryimg=\"no\" />")}x2.push("</div>");if(en==1){this.wq.style.top=U5402(this.wq.style.top)-10+"px";this.wq.style.height=U5402(this.wq.style.height)+10+"px";x2.push("<div id=\"_scaleValue2\" style=\"position:absolute;font-family: arial;FONT-SIZE: 12px; color:"+ns+";FONT-WEIGHT: bold;left:4px;top:19px;\">&nbsp;"+ws+' '+xF+"</div>")}this.wq.div.innerHTML=x2.join("")}else{if(en==1){aa("_scaleValue").innerHTML="&nbsp;"+ws+' '+xC;if(aa("_scaleValue2"))aa("_scaleValue2").innerHTML="&nbsp;"+ws+' '+xF}else aa("_scaleValue").innerHTML="&nbsp;"+ws+' '+xC}this.wq.show()}else{this.wq.hide()}},F0lQ:function(){if(!this.wq)return;if(this.fe){var l=4,yw;if(en==1)yw=this.height-34;else yw=this.height-24;var UA8=0,$13We=0;if(this.controlCanvas&&this.controlCanvas.options.location.type==Maplet.LEFT_BOTTOM){UA8=this.controlCanvas.getRect().max.x+10}if(this.overview&&this.overview.location.type==Maplet.LEFT_BOTTOM){$13We=this.overview.getRect().max.x+10}this.wq.moveTo(Math.max(l,Math.max(UA8,$13We)),yw)}},showNavLogo:function(c2){if(!c2){this.W534.style.display="none"}else{this.W534.style.display="block"}this.sIb=c2;this.md0()},waitPan:function(x,y,fy){if(this.Ah)clearTimeout(this.Ah);this.Ah=null;if(x&&y){if(this.vi==0){this.vi=1;this.vc=x;this.vd=y;this.fy=fy;this.Ah=getTimeout(this,this.waitPan,500)}}else{if(this.vi){this.vi=0;this.panTo(this.vc,this.vd,this.fy)}}},doPan:function(){this.fa=true;this.l4p=true;if(!px&&ContentInfo&&ContentInfo.isVisible()){ContentInfo.I72(true)}if(!this.w205){this.no();this.w205=true}if(this.markerDragAnimation){with(this.Fqa){if(overlay!=null&&!overlay.ls)this.T352(false)}}var tN=parseInt(Math.sqrt(this.Aq*this.Aq+this.Aw*this.Aw));if(this.vh)clearTimeout(this.vh);this.vh=null;if((this.va-tN)<=(1.2*this.vg)){this.Aq=this.xoffset;this.Aw=this.yoffset;this.sF.moveTo(this.Aq,this.Aw);this.vh=getTimeout(this,this.finishupPan,10)}else{var lJ=this.xoffset*this.vg/this.va;var lL=this.yoffset*this.vg/this.va;this.Aq+=lJ;this.Aw+=lL;this.sF.moveTo(this.Aq,this.Aw);this.vh=getTimeout(this,this.doPan,10)}},finishupPan:function(){this.fa=false;this._67R=true;this.O71Wl=new Date().getTime();this.tJW3=pD6(this.Aq);this.R8G=pD6(this.Aw);if(this.vh)clearTimeout(this.vh);this.vh=null;this.setCenter(this.ve,this.vf);this._67R=false;if(this.t1B_&&this.t1B_.parentNode!=this.sF.div){this.sF.div.appendChild(this.t1B_)}else{}if(this.fy!=null&&this.fy!="undefined")eval(this.fy);this.l4p=false},AN:function(AL,x,y){this.lA.hide();if(this.Mv24){this.Mv24.setVisible(false);MLayer.setTipVisible(false)}for(var i in this.NV26){var p=this.NV26[i];if(p.options.zoomhide&&p.isVisible()){p.setVisible(false)}}if(!this.w205)this.no();this.t40w=true;if(typeof x!="number")x=0;if(typeof y!="number")y=0;var AK=Math.pow(2,parseFloat(AL))/Math.pow(2,this.AG);for(var i in this.pU){var img=this.pU[i];if(img.c2){with(img.style){if(img.getAttribute("done")!="1"){_removeNode(img);img=null;delete this.pU[i]}else{width=(this.imgWidth*AK<10?0:this.imgWidth*AK+1)+"px";height=(this.imgHeight*AK<10?0:this.imgHeight*AK+1)+"px";left=U5402(img.getAttribute("origx"))*AK+1+"px";top=U5402(img.getAttribute("origy"))*AK+1+"px"}}}}with(this.sE.div.style){width=this.width*AK+"px";height=this.height*AK+"px";left=(this.width/2-U5402(width)/2+x)+"px";top=(this.height/2-U5402(height)/2+y)+"px"}},dDig:function(_Sg){if(U5402(this.sE.div.style.width)!=this.width){with(this.sE.div.style){width=this.width+"px";height=this.height+"px";left="0px";top="0px"}}if(typeof _Sg=="boolean"&&_Sg){for(var i in this.pU){var img=this.pU[i];if(typeof img=="object"&&img.c2){img.style.left=U5402(img.getAttribute("origx"),0)+"px";img.style.top=U5402(img.getAttribute("origy"),0)+"px";img.style.width=this.imgWidth+"px";img.style.height=this.imgHeight+"px"}}}this.t40w=false},removeLineAt:function(){},addHotspot:function(lf,li,xP,tp,s0){var nW="hotspot"+this.aE.length;if(typeof li=="object"&&li.toString()=="com.mapbar.maplet.MPoint"){lf=li.lat;li=li.lon}else{var zh=cq.vp(li);lf=Math.min(sy[1],Math.max(sy[0],parseFloat(zh[1])));li=Math.min(sz[1],Math.max(sz[0],parseFloat(zh[0])%360))}this.aE[this.aE.length]=new a8(nW,parseFloat(lf),parseFloat(li),xP,tp,s0)},zp:function(x,y,AB){var An=(x-this.width/2);if(this.rotation!=0){var At=(y-this.height/2);An=An*this.gk+At*this.wT}AB=U5402(AB,this.AG);var xd=sj[AB];var li=this.gA+An*xd/this.imgWidth;li=Math.min(sz[1],Math.max(sz[0],li%360));return li},zo:function(x,y,AB){var At=(y-this.height/2);if(this.rotation!=0){var An=(x-this.width/2);At=-An*this.wT+At*this.gk}AB=U5402(AB,this.AG);var xd=qP[AB];var lf=this.gx-At*xd/this.imgHeight;lf=Math.min(sy[1],Math.max(sy[0],lf));return lf},zl:function(li,lf){var g2=((parseFloat(li)-this.gA)%360);if(g2>180)g2-=360;if(g2<-180)g2+=360;var p1=Math.round(this.width/2+g2/sj[this.AG]*this.imgWidth);if(this.rotation!=0){var p3=Math.round(this.height/2-((parseFloat(lf)-this.gx)%360)/qP[this.AG]*this.imgHeight);p1=(p1-this.width/2)*this.gk-(p3-this.height/2)*this.wT+this.width/2}return p1},zm:function(lf,li){var p3=Math.round(this.height/2-((parseFloat(lf)-this.gx)%360)/qP[this.AG]*this.imgHeight);if(this.rotation!=0){var g2=((parseFloat(li)-this.gA)%360);if(g2>180)g2-=360;if(g2<-180)g2+=360;var p1=Math.round(this.width/2+g2/sj[this.AG]*this.imgWidth);p3=(p1-this.width/2)*this.wT+(p3-this.height/2)*this.gk+this.height/2}return p3},setMode:function(zr,fy){zr=zr.toString().toLowerCase();zr=(this.tB[zr])?parseInt(this.tB[zr]):parseInt(zr);if((zr!=3&&zr!=23)&&this.sS==zr)return null;if(this.sS==3||this.sS==23)this.vA=this.sS;this.sS=parseInt(zr);this.dl18();var l8=null;if(zr!='measure'&&zr!=11){clearInterval(this.rn1);this.rn1=undefined}switch(zr){case 'zoomin':case '1':case 1:this.cS=true;this.q453('crosshair',this.map);this.sS=1;l8='zoomin';break;case 'zoomout':case '2':case 2:this.cS=true;this.sS=2;this.q453('crosshair',this.map);l8='zoomout';break;case ts.ty:case "pan":case 3:this.sS=3;l8='pan';zr=null;this.setCursorStyle("default","");case ts.l3:case 13:case 'erase':if(zr){this.sS=13;l8='erase';zr=null}case ts.tu:case 'edit':case 23:if(zr){this.sS=23;l8='edit';zr=null}this.cO=true;this.q453('default',this.map);break;case ts.tv:case "lookup":case 5:this.cS=true;this.q453('crosshair',this.map);this.sS=5;l8='lookup';break;case '6':case 6:case 'bookmark':this.q453('default',this.map);l8='bookmark';this.sS=6;break;case '7':case 7:this.q453('default',this.map);break;case '8':case 8:this.q453('default',this.map);break;case '9':case 9:case 'drawline':this.q453('default',this.map);this.po=-1;this.sS=9;l8='drawline';if(this.allowDrawingDragMap)this.cO=true;break;case '10':case 10:case 'drawarea':this.q453('default',this.map);this.po=-1;this.sS=10;l8='drawarea';if(this.allowDrawingDragMap)this.cO=true;break;case '11':case 11:case 'measure':this.setCursorStyle("default",this.H9W5.cursor);this.q453('default',this.map);l8='measure';this.sS=11;if(this.allowDrawingDragMap)this.cO=true;break;case '15':case 15:case 'measarea':this.q453('default',this.map);l8='measarea';this.sS=15;if(this.allowDrawingDragMap)this.cO=true;break;case '24':case 24:case 'snapshot':this.cS=true;this.q453('crosshair',this.map);l8='snapshot';this.sS=24;break;case '25':case 25:case 'roadline':this.q453('pointer',this.map);l8='roadline';this.sS=ts.sy9;if(this.allowDrawingDragMap)this.cO=true;break;default:break};var IJ6=null;if(l8!=null&&typeof fy=="function")IJ6=MEvent.addListener(this,l8,fy);if(l8!=null){MEvent.trigger(this,"setmode",l8)}return IJ6},b6656:function(pt,n){var YTW=new MMarker(pt,new MIcon(this.rlConfig._2GFL,11,11));YTW.creator=MLayer.SYSTEM;this.addOverlay(YTW);this.IcK4.$923.push(YTW)},D8M73:function(Sj3S,_d06D,Kfm$,uH0){if(this.sS==ts.sy9||(this.sS!=ts.sy9&&Sj3S)){var r=eval("typeof "+this.rlConfig.resultName+"=='undefined'?null:"+this.rlConfig.resultName);if(r){if(this.IcK4.f_jv){this.removeOverlay(this.IcK4.f_jv,true);this.IcK4.f_jv=null}var pts=[];var WtA=0;if(r.a.length){var data=r.a[0];var pts=this.decodeLine(data.a,data.b);WtA=U5402(data.e,0)}else{pts.push(_d06D);pts.push(Kfm$)}var TErp=new MPolyline(pts);if(this.sS==ts.sy9)TErp.creator=MLayer.SYSTEM;if(Sj3S){this.IcK4.Ife.push(TErp);this.IcK4.r18.W1C1+=WtA;this.IcK4.r18.M440=0}else{this.IcK4.f_jv=TErp;this.IcK4.r18.M440=WtA}this.addOverlay(TErp);r=undefined;eval(this.rlConfig.resultName+"=undefined");this.d0I()}with(this.IcK4.wmjh){if(i7S!=g09y4||XCk1!=y3X){g09y4=i7S;y3X=XCk1;this.D9J$4(new MPoint(i7S,XCk1,false),false)}else{this.IcK4.YIX=false}}}_removeNode(aa(uH0))},D9J$4:function(Kfm$,Sj3S){if(typeof Sj3S!="boolean")Sj3S=false;this.IcK4.YIX=true;var tw0=this.IcK4.$923;var t52="%252C";var _d06D=tw0[tw0.length-1].pt;var url=this.rlConfig.url+"&_="+new Date().getTime()+"&nh="+_d06D.getPid()+"_"+t52+Kfm$.getPid()+"_&ri="+this.rlConfig.resultName;new SwF6(url,this.D8M73,false,true,this,this.D8M73,[Sj3S,_d06D,Kfm$]).e0b()},d0I:function(){with(this.IcK4){if(!tip.maplet)this.addPanel(tip);if(!tip.isVisible())tip.show();var d=tip.dom.firstChild.childNodes[0];var yw="start";if($923.length==0){d.style.display="none"}else{if($923.length==1)yw="one";else yw="end";var WtA=r18.W1C1+r18.M440;d.innerHTML=WtA<1000?WtA+" \u7c73":(WtA/1000).toFixed(1)+" \u516c\u91cc";d.style.display=""}if(this.rlConfig.tip[yw])tip.dom.firstChild.childNodes[1].innerHTML=this.rlConfig.tip[yw];tip.setLocation({x:this.moveX+20,y:this.moveY})}},setCursorStyle:function(mode,icon){if(typeof mode=="string"&&typeof icon=="string"&&mode){if("default,pointer,move,crosshair".indexOf(mode)!=-1){w88[mode]=icon}}},q453:function(mode,tX88){var icon=w88[mode];var cursor="";if(typeof icon=="string"&&icon){cursor="url('"+icon+"'),auto"}else{cursor=mode}if(tX88.style.cursor!=cursor){tX88.style.cursor=cursor}},wN:function(x,y,ya,xu,ct){if(typeof ya=="undefined"||ya==null)return;if(iToolTipStyle=="undefined"||iToolTipStyle==1){var p0=(typeof ya=="object")?ya:null;if(p0){avBubble.gl(p0.title,p0.content);ct=xu}else{avBubble.gl(ya,xu)}if(p0){this.t1B_=p0.gv(x,y,true)}else{this.t1B_=gp(ya,x,y,xu,true)}}else{var p0=(typeof ya=="object")?ya:null;if(p0){setToolTipMenu(x,y,p0.title,p0.content)}else{setToolTipMenu(x,y,ya,xu)}}},hideBubble:function(){hideBubble(this);if(this.t1B_){if(this.t1B_.parentNode)this.t1B_.parentNode.removeChild(this.t1B_);this.t1B_=null}},aY:function(){if((this.moveX>0)&&(this.moveX<this.width)&&(this.moveY>0)&&(this.moveY<this.height)&&(this.downX>0)&&(this.downX<this.width)&&(this.downY>0)&&(this.downY<this.height)){return true}else{return false}},lu:function(){var w=0,h=0,x=0,y=0;if(this.moveX<this.downX&&this.moveY<this.downY){w=this.downX-this.moveX;h=this.downY-this.moveY;x=this.moveX;y=this.moveY}else if(this.moveX>this.downX&&this.moveY<this.downY){w=this.moveX-this.downX;h=this.downY-this.moveY;x=this.downX;y=this.moveY}else if(this.moveX<this.downX&&this.moveY>this.downY){w=this.downX-this.moveX;h=this.moveY-this.downY;x=this.moveX;y=this.downY}else if(this.moveX>this.downX&&this.moveY>this.downY){w=parseInt(this.moveX)-this.downX;h=parseInt(this.moveY)-this.downY;x=this.downX;y=this.downY}else{w=this.moveX-this.downX;h=this.moveY-this.downY;x=this.downX;y=this.downY}if(this.sS==ts.D57MH){this.snapshotBox.resize(w,h);this.snapshotBox.moveTo(x,y)}else{this.sD.resize(w,h);this.sD.moveTo(x,y)}},dl18:function(){this.cL=false;this.cS=false;this.cO=false;this.cN=false;this.cR=false;this.closeMeasureCurrPath();this.setCursorStyle("default","");if(this.zy){this.zy.remove(true);this.zy=null}if(this.tG){this.tG.remove(true);this.tG=null}if(this.sD.style.visibility=="visible"){this.sD.hide();this.sD.resize(1,1);this.sD.moveTo(-10,-10)}if(this.snapshotBox.isVisible()&&!this.snapshotBox.e3r1y){this.snapshotBox.hide()}nX();with(this.IcK4){r18.W1C1=0;r18.M440=0;if(tip.maplet&&tip.isVisible())tip.hide();wmjh.g09y4=wmjh.i7S=0;wmjh.y3X=wmjh.XCk1=0;if(f_jv){this.removeOverlay(f_jv,true);f_jv=null}if($923.length){for(var i=0;i<$923.length;i++){$923[i].creator=MLayer.USER;if(XlM){this.removeOverlay($923[i],true);$923[i]=null}}}if(Ife.length){for(var i=0;i<Ife.length;i++){Ife[i].creator=MLayer.USER;if(XlM){this.removeOverlay(Ife[i],true);Ife[i]=null}}}$923=[];Ife=[];YIX=false;XlM=1}},clean:function(){this.hideBubble();this.refresh()},showBasePois:function(c2){this.bp=c2;this.refresh()},addControl:function(gB,fi,q6,zw){if(typeof gB=="string"||(typeof gB=="object"&&gB.toString().indexOf("MStandardControl")>0)){if(this.controlCanvas){this.controlCanvas.g1();this.controlCanvas=null}var t0=null;if(typeof gB=="string"){if(q6==null||q6=="undefined"){q6=0}if(zw==null||zw=="undefined"){zw=0}t0=new MStandardControl(gB,q6,zw,fi)}else if(typeof gB=="object"){t0=gB}if(t0){t0.initialize(this)}}else if(typeof gB=="object"){if(this.gc[gB.id]){return}gB.initialize(this);this.gc[gB.id]=gB;this.overview.addListener(this.gc[gB.id])}},removeControl:function(gw){if(typeof gw=="object"&&this.gc[gw.id]){this.gc[gw.id].remove();this.gc[gw.id]=null}},getCurrentMap:function(){var sT=this.width*sj[this.AG]/this.imgWidth;cq.lf=this.gx;cq.li=this.gA;var gz=cq.zn();var vy=(this.aO.length>0)?"&pois="+this.aO.length+",":"";for(var i=0;i<this.aO.length;i++){vy+=this.aO[i].zn()+","+this.aO[i].xP+","}var vw=(this.aN.length>0)?"&plines="+this.aN.length+",":"";for(var i=0;i<this.aN.length;i++){vw+=this.aN[i].zn()+";"}var u1="";for(var i in this.u5){if(typeof this.u5[i]=="object"&&this.u5[i]!=null&&this.u5[i].zq){if(u1.length==0){u1="&overlays="}u1+=this.u5[i].zq()+";"}}return "&map="+this.AG+","+gz+","+this.width+","+this.height+"&zm="+(Math.round(parseFloat(sT)*1000)/10.0)+"&width="+this.width+"&height="+this.height+"&ctr="+gz+vy+vw+"&client="+strLicenseKey+u1},setCursorIcon:function(xI){this.gJ=xI;this.gI.src=xI;nX()},v1:function(){this.gJ=null;this.gI.src=null},setBgColor:function(xt){this.panel.style.backgroundColor=xt},setTransparency:function(uo){this.sE.div.style.filter="alpha(opacity="+uo+");";this.sE.div.style.MozOpacity=(uo/100.0);this.sE.div.style.opacity=(uo/100.0);this.sE.div.style.qK=(uo/100)},ql:function(){return this.cI},setActive:function(cT){this.cI=cT},onkeydown:function(e){var l8=(e)?e:(window.event)?window.event:null;if(l8){var qJ=(l8.fG)?l8.fG:((l8.keyCode)?l8.keyCode:((l8.which)?l8.which:0));if(qJ=="37"||qJ=="38"||qJ=="39"||qJ=="40"){if(this.ql()){if(l8.target&&((l8.target.nodeName=="INPUT"&&l8.target.getAttribute("type").toLowerCase()=="text")||l8.target.nodeName=="TEXTAREA")){return}if(l8.srcElement&&((l8.srcElement.tagName=="INPUT"&&l8.srcElement.type=="text")||l8.srcElement.tagName=="TEXTAREA")){return}if(l8.shiftKey||l8.ctrlKey){if(qJ=="37"){this.setRotation(this.rotation-15);this.refresh()}if(qJ=="39"){this.setRotation(this.rotation+15);this.refresh()}}else{if(qJ=="37")this.panTo(this.width/2,0);if(qJ=="38")this.panTo(0,this.height/2);if(qJ=="39")this.panTo(-this.width/2,0);if(qJ=="40")this.panTo(0,-this.height/2)}}}}},getMaxBubbleSize:function(){var ix=0;var iy=0;var ax=this.width;var ay=this.height;var T1u=this.getOverviewRect();var kQmr={tn:T1u.min.x,K0xXM:T1u.max.x,width:T1u.max.x-T1u.min.x};var _Au8=this.getControlRect();var H$_55={tn:_Au8.min.x,K0xXM:_Au8.max.x};if(this.controlCanvas){with(this.controlCanvas){if(isVisible()){if(options.location.type==Maplet.LEFT_TOP||options.location.type==Maplet.LEFT_BOTTOM){ix=Math.max(ix,_Au8.max.x)}else{ax=Math.min(ax,_Au8.min.x)}}}}if(this.overview){with(this.overview){if(fg){if(location.type==Maplet.LEFT_TOP||location.type==Maplet.LEFT_BOTTOM){ix=Math.max(ix,T1u.max.x+location.marginx)}else{ax=Math.min(ax,T1u.min.x)}}}}var w=ax-ix;var h=ay-iy;if(!isNaN(parseInt(avBubble._Q8ia))&&parseInt(avBubble._Q8ia)<w)w=parseInt(avBubble._Q8ia);if(!isNaN(parseInt(avBubble.v6yO))&&parseInt(avBubble.v6yO)<h)h=parseInt(avBubble.v6yO);return{min:{x:ix,y:iy},max:{x:ax,y:ay},width:w,height:h,f0:H$_55,overview:kQmr}},Ct$5A:function(random){this.R__7=true;var d=new Date();new SwF6(bpp[0]+"/poireport.txt"+(GOLDPOI_TXTRQT_RANDOM?"?"+(d.getYear()>1900?d.getYear()-1900:d.getYear())+d.getMonth()+d.getDay():""),this.W8x9,null,null,this,this.W8x9).e0b()},W8x9:function(){if(typeof basepoilist=="object"&&basepoilist)this.refresh();this.R__7=false},setTrajectory:function(marker,Q2d$3,uv,lX){this.ux=(uv==null||uv=="undefined")?5:parseInt(uv);this.pid=marker;this.lX=lX;var aU=Q2d$3.pts;if(aU!=null&&aU.length>0){var qI=0;this.zf=new Array();this.zg=new Array();this.p9=0;for(var i=0;i<aU.length;i++){{var pt=cq.vp(aU[i].getPid());this.zg[qI]=parseFloat(pt[0]);this.zf[qI]=parseFloat(pt[1]);qI++;pt=null}}aU=null}},rotate:function(fy){if(this.uw<=this.t9){this.uw=Math.min(this.t9,this.uw+this.xe)}else if(this.uw>=this.t9){this.uw=Math.max(this.t9,this.uw-this.xe)}this.setRotation(this.uw);this.refresh();if(this.uw==this.t9){setTimeout(fy,100)}else{setTimeout("maplet.rotate(\""+fy+"\")",100)}},doEmulation:function(){try{if(this.p9==0){this.wY=this.zf[0];this.wZ=this.zg[0];this.py=this.p9;this.p9++}if(this.p9<this.zf.length){this.vh=null;if(this.pid.icon.div.parentNode!=this.lA){this.lA.appendChild(this.pid.icon.div.parentNode);this.pid.icon.div.style.zIndex=200}if(this.nT==1&&rs&&this.py!=this.p9){this.py=this.p9;if(typeof this.lY=="undefined"||this.lY==null){this.lY=document.createElement("div");this.lY.style.position="absolute";this.lY.style.zIndex=1000;this.lY.style.width=parseFloat(this.pid.icon.div.style.width)+"px";this.lY.style.height=parseFloat(this.pid.icon.div.style.height)+"px";this.lY.style.left=(this.width/2-parseFloat(this.pid.icon.div.style.width)/2)+"px";this.lY.style.top=(this.height/2-parseFloat(this.pid.icon.div.style.height)/2)+"px";this.lY.innerHTML="<img src='"+this.pid.icon.imgUrl+"' width='"+parseFloat(this.pid.icon.div.style.width)+"px' height='"+this.pid.icon.div.style.height+"px'>";this.map.appendChild(this.lY)}var v0=-90+parseFloat(180*Math.atan2(this.zf[this.p9]-this.zf[this.p9-1],0.8*(this.zg[this.p9]-this.zg[this.p9-1]))/Math.PI);if(v0<0){v0+=360}v0=v0%360;if((Math.abs(v0-this.rotation)%360)>180){this.rotation+=360}if(this.rotation-180-360>0){this.rotation=(this.rotation-720)}this.uw=this.rotation;this.t9=v0;if(this.p9==1){this.setRotation(v0);this.setCenter(this.wY,this.wZ)}else{this.setCenter(this.wY,this.wZ);setTimeout("maplet.rotate(\"maplet.doEmulation()\")",500);return}}var yi=this.zl(this.zg[this.p9-1],this.zf[this.p9-1]);var yj=this.zm(this.zf[this.p9-1],this.zg[this.p9-1]);var l4=this.zl(this.zg[this.p9],this.zf[this.p9]);var l5=this.zm(this.zf[this.p9],this.zg[this.p9]);var w1=this.zl(this.wZ,this.wY);var w2=this.zm(this.wY,this.wZ);var zx=parseFloat(Math.sqrt((l4-yi)*(l4-yi)+(l5-yj)*(l5-yj)));var tN=parseFloat(Math.sqrt((w1-yi)*(w1-yi)+(w2-yj)*(w2-yj)))+this.ux;if(tN<=(zx-this.ux)){w1=yi+tN*(l4-yi)/zx;w2=yj+tN*(l5-yj)/zx;this.wZ=this.zg[this.p9-1]+tN*(this.zg[this.p9]-this.zg[this.p9-1])/zx;this.wY=this.zf[this.p9-1]+tN*(this.zf[this.p9]-this.zf[this.p9-1])/zx}else{w1=l4;w2=l5;this.wZ=this.zg[this.p9];this.wY=this.zf[this.p9];this.p9++}if(this.nT==0){this.pid.icon.div.style.top=(w2-parseFloat(this.pid.icon.div.style.height))+"px";this.pid.icon.div.style.left=(w1-parseFloat(this.pid.icon.div.style.width)/2)+"px"}if(this.nT==1&&rs){this.sF.div.style.top=parseFloat(this.sF.div.style.top)+this.ux;this.vh=getTimeout(this,this.doEmulation,100)}else{if(w1<0){this.panTo(this.width/2,this.height/2-w2,"maplet.doEmulation()")}else if(w1>this.width){this.panTo(-this.width/2,this.height/2-w2,"maplet.doEmulation()")}else if(w2<0){this.panTo(this.width/2-w1,this.height/2,"maplet.doEmulation()")}else if(w2>this.height){this.panTo(this.width/2-w1,-this.height/2,"maplet.doEmulation()")}else{this.vh=getTimeout(this,this.doEmulation,10)}}}else{this.vh=null;this.zf=null;this.zg=null;this.pid.icon.div.style.zIndex=1;if(this.lY){if(this.lY.parentNode){this.lY.parentNode.removeChild(this.lY);this.lY=null}}this.setRotation(0);this.refresh();if(this.lX!=null||this.lX!="undefined"){this.lX()}}}catch(nf){}},stopEmulation:function(){if(this.p9&&this.zf)this.p9=this.zf.length},getMarkersInPolygon:function(f052){var N7k=[];var pts=[];for(var i=0;i<f052.pts.length;i++){pts.push({x:f052.pts[i].mapX,y:f052.pts[i].mapY})}var D50_8=this.getMarkers();for(var i=0;i<D50_8.length;i++){var pt={x:D50_8[i].pt.mapX,y:D50_8[i].pt.mapY};if(_isInsidePolygon(pt,pts))N7k.push(D50_8[i])}return N7k},getMarkerPolygons:function(r90){var dNJD4=this.getPolylines(2);var N7k=[];if(dNJD4.length>0){var pt={x:r90.pt.mapX,y:r90.pt.mapY};for(var i=0;i<dNJD4.length;i++){var pts=[];var f052=dNJD4[i];for(var HB3=0;HB3<f052.pts.length;HB3++)pts.push({x:f052.pts[HB3].mapX,y:f052.pts[HB3].mapY});if(_isInsidePolygon(pt,pts))N7k.push(f052)}}return N7k},b284:function(x,y){return this.b17W[(x%2)<0?0:x%2][(y%2)<0?0:y%2]},w38T0:function(detail){var w=parseInt(this.E8_2.Xb0Kb[0].style.borderTopWidth);if(this.E8_2.yN!=null&&((detail<0&&w==0)||(detail>0&&w==2))){return}var _jo9L={left:this.moveX,top:this.moveY};var size=null;var fun=null;if(detail<0){fun=this.w5N;size=this.E8_2.Qh877;this.THYM2(true)}else{fun=this.I7W;size=this.E8_2.m8_0;this.THYM2(false)}_jo9L.left-=size.width/2;_jo9L.top-=size.height/2;this.H4H0X(true,size,_jo9L);this.E8_2.yN=getTimeout(this,fun,this.E8_2.interval)},THYM2:function(zoomout){var Xb0Kb=this.E8_2.Xb0Kb;if(zoomout){Xb0Kb[0].style.borderWidth="0px 2px 2px 0px";Xb0Kb[1].style.borderWidth="0px 0px 2px 2px";Xb0Kb[2].style.borderWidth="2px 2px 0px 0px";Xb0Kb[3].style.borderWidth="2px 0px 0px 2px"}else{Xb0Kb[0].style.borderWidth="2px 0px 0px 2px";Xb0Kb[1].style.borderWidth="2px 2px 0px 0px";Xb0Kb[2].style.borderWidth="0px 0px 2px 2px";Xb0Kb[3].style.borderWidth="0px 2px 2px 0px"}},I7W:function(){this.s02(false)},w5N:function(){this.s02(true)},s02:function(zoomout){if(this.E8_2.fG6v<=this.E8_2.GE_p6){var c=this.E8_2.container;var xd=this.E8_2.xd*this.E8_2.fG6v;var s8oL=c.offsetWidth*xd;c.style.left=(zoomout?c.offsetLeft+s8oL/2:c.offsetLeft-s8oL/2)+"px";c.style.width=(zoomout?c.offsetWidth-s8oL:c.offsetWidth+s8oL)+"px";s8oL=c.offsetHeight*xd;c.style.top=(zoomout?c.offsetTop+s8oL/2:c.offsetTop-s8oL/2)+"px";c.style.height=(zoomout?c.offsetHeight-s8oL:c.offsetHeight+s8oL)+"px";this.L$8h();this.E8_2.fG6v++;this.E8_2.yN=getTimeout(this,(zoomout?this.w5N:this.I7W),this.E8_2.interval-this.E8_2.interval*this.E8_2.xd)}else{this.H4H0X(false)}},L$8h:function(){var c=this.E8_2.container;var i=4;var w=c.offsetWidth;var h=c.offsetHeight;this.E8_2.Xb0Kb[1].style.left=w-i+"px";this.E8_2.Xb0Kb[2].style.top=h-i+"px";this.E8_2.Xb0Kb[3].style.left=w-i+"px";this.E8_2.Xb0Kb[3].style.top=h-i+"px"},H4H0X:function(visible,size,_jo9L){var c=this.E8_2.container;c.style.left="100px";c.style.top="100px";if(this.E8_2.yN){window.clearTimeout(this.E8_2.yN);this.E8_2.yN=null}this.E8_2.fG6v=1;this.E8_2.container.style.display=visible?"":"none";var c=this.E8_2.container;if(typeof _jo9L=="object"&&_jo9L){c.style.left=_jo9L.left+"px";c.style.top=_jo9L.top+"px"}if(typeof size=="object"&&size){c.style.width=size.width+"px";c.style.height=size.height+"px";this.L$8h()}},getControlRect:function(){var r={min:{x:0,y:0},max:{x:0,y:0}};if(this.controlCanvas){with(this.controlCanvas){var _Au8=getRect();if(isVisible()){r.min=_Au8.oUj3;r.max=_Au8.T6G}}}return r},getOverviewRect:function(){var r={min:{x:0,y:0},max:{x:0,y:0}};if(this.overview)r=this.overview.getRect();if(r.min.x==0&&r.max.x==0)r={min:{x:this.width,y:this.height},max:{x:this.width,y:this.height}};return r},hO0dL:function(rect,$YtXd,R79){if(typeof $YtXd!="boolean")$YtXd=true;if(typeof R79!="boolean")R79=true;var ix=rect.t051X;var iy=rect.ga98U;var ax=rect.cY1;var ay=rect.alLn;var vj=0;var vk=0;var Q57c=0;var eVlN=0;var ww25=this.width;var iPCI=this.height;if($YtXd||R79){var r={min:{x:rect.t051X,y:rect.ga98U},max:{x:rect.cY1,y:rect.alLn},width:rect.cY1-rect.t051X,height:rect.alLn-rect.ga98U};var Ld$9,l,yw;if(R79&&this.controlCanvas){var J9uc7=this.getControlRect();Ld$9=this.controlCanvas.options.location;l=(Ld$9.type==Maplet.LEFT_TOP||Ld$9.type==Maplet.LEFT_BOTTOM);yw=(Ld$9.type==Maplet.LEFT_TOP||Ld$9.type==Maplet.RIGHT_TOP);if(_isRectint(r,J9uc7)){if(l){Q57c=J9uc7.max.x}else ww25=J9uc7.min.x}else{if(l){if(yw&&r.min.x<J9uc7.max.x&&(r.min.y<J9uc7.max.y||(r.height>this.height-J9uc7.max.y))){Q57c=J9uc7.max.x}else if(!yw&&r.min.x<J9uc7.max.x&&(r.max.y>J9uc7.min.y||(r.height>J9uc7.min.y))){Q57c=J9uc7.max.x}}else{if(yw&&r.max.x>J9uc7.min.x&&(r.min.y<J9uc7.max.y||(r.height>this.height-J9uc7.max.y))){ww25=J9uc7.min.x}else if(!yw&&r.max.x>J9uc7.min.x&&(r.max.y>J9uc7.min.y||(r.height>J9uc7.min.y))){ww25=J9uc7.min.x}}}}if($YtXd&&this.overview){var NWOb2=this.getOverviewRect();Ld$9=this.overview.location;l=(Ld$9.type==Maplet.LEFT_TOP||Ld$9.type==Maplet.LEFT_BOTTOM);yw=(Ld$9.type==Maplet.LEFT_TOP||Ld$9.type==Maplet.RIGHT_TOP);if(_isRectint(r,NWOb2)){if(l)Q57c=Math.max(Q57c,NWOb2.max.x);else ww25=Math.min(ww25,NWOb2.min.x)}else{if(l){if(yw&&r.min.x<NWOb2.max.x&&(r.min.y<NWOb2.max.y||(r.height>this.height-NWOb2.max.y))){Q57c=Math.max(Q57c,NWOb2.max.x)}else if(!yw&&r.min.x<NWOb2.max.x&&(r.max.y>NWOb2.min.y||(r.height>NWOb2.min.y))){Q57c=Math.max(Q57c,NWOb2.max.x)}}else{if(yw&&r.max.x>NWOb2.min.x&&(r.min.y<NWOb2.max.y||(r.height>this.height-NWOb2.max.y))){ww25=Math.min(ww25,NWOb2.min.x)}else if(!yw&&r.max.x>NWOb2.min.x&&(r.max.y>NWOb2.min.y||(r.height>NWOb2.min.y))){ww25=Math.min(ww25,NWOb2.min.x)}}}}}if(ix<Q57c)vj=ix-Q57c;if(iy<eVlN)vk=iy-eVlN;if(ax>ww25){if(vj==0)vj=ax-ww25;else vj=0}if(ay>iPCI){if(vk==0)vk=ay-iPCI;else vk=0}return{$0xy:vj,p40Hg:vk}},TyUI:function(rect,E4V){if(typeof E4V!="object"||!E4V)E4V={$YtXd:true,R79:true,S_2:true};var lW7=this.hO0dL(rect,E4V.$YtXd,E4V.R79,E4V.S_2);var wJ8h9=lW7.$0xy;var A0U02=lW7.p40Hg;if(wJ8h9!=0||A0U02!=0){if(typeof rect.bS48!="number")rect.bS48=0;if(typeof rect.bDF9J!="number")rect.bDF9J=0;if(wJ8h9!=0)wJ8h9=(wJ8h9<0?wJ8h9-rect.bS48:wJ8h9+rect.bS48);if(A0U02!=0)A0U02=(A0U02<0?A0U02-rect.bDF9J:A0U02+rect.bDF9J);maplet.panTo(-wJ8h9,-A0U02)}return lW7},viewOverlay:function(overlay,AJvP,IE78){var s=overlay.toString();var TwQ=s.indexOf("MMarker")!=-1;var t9O=s.indexOf("MPolyline")!=-1;var $ym=s.indexOf("MEllipse")!=-1;var NP3j=s.indexOf("MRoundRect")!=-1;var ix=0,iy=0,ax=0,ay=0;if(TwQ&&overlay.icon){var YTW=overlay;ix=YTW.pt.mapX-YTW.icon.anchorX;iy=YTW.pt.mapY-YTW.icon.anchorY;ax=ix+parseInt(YTW.icon.div.style.width);ay=iy+parseInt(YTW.icon.div.style.height)}else if(t9O){var y62a8=overlay.getCenterXY();ix=y62a8.x-16;iy=y62a8.y-16;ax=ix+32;ay=iy+32}else if($ym){ix=overlay.gC.mapX-16;iy=overlay.gC.mapY-16;ax=ix+32;ay=iy+32}else if(NP3j){var Axm=overlay.getCenterXY();ix=Axm.x-16;iy=Axm.y-16;ax=ix+32;ay=iy+32}return this.TyUI({t051X:ix,ga98U:iy,cY1:ax,alLn:ay,bS48:AJvP,bDF9J:IE78})},D4oF:function(){this.Mv24=new fD("LayerContainer",0,0,this.width,this.height,true,2,'',this.sF)},Q4cd:function(){for(var i in this.layerData){this.layerData[i]=null;delete this.layerData[i]}},getImgByXY:function(x,y,w47i6){if(typeof w47i6!="boolean")w47i6=false;var img=this.pU[((this.AG).toString(16)+(this.gD).toString(16)+'l'+(this.gE).toString(16)).toLowerCase()];if(typeof img=="object"&&img){var ix=Math.floor((x-parseInt(img.style.left))/this.imgWidth);var iy=-Math.floor((y-parseInt(img.style.top)+(w47i6?w8[this.AG]:0))/this.imgHeight);return((this.AG).toString(16)+(this.gD+ix).toString(16)+'l'+(this.gE+iy).toString(16)).toLowerCase()}return null},T352:function(visible,left,top){with(this.Fqa){if(typeof left!="undefined")fC.div.style.left=left+"px";if(typeof top!="undefined")fC.div.style.top=top+"px";if(fC.div.parentNode!=this.panel){this.panel.appendChild(fC.div);fC.div.style.zIndex=2}if(fC.div.style.display!=(visible?"":"none")){fC.div.style.display=(visible?"":"none")}if(overlay){overlay.o1a();overlay=null}}},e61p4:function(){if(!this.wL1B){this.wL1B=document.createElement("div");this.wL1B.id=Uby5j?'vCanvasSVG':'vCanvasVML';this.wL1B.style.position="absolute";this.wL1B.unselectable="on";this.wL1B.style.zIndex=0;this.wL1B.style.MozUserSelect="none";this.lA.appendChild(this.wL1B);if(Uby5j){var HC358=this.HC358=document.createElementNS("http://www.w3.org/2000/svg","svg");HC358.setAttribute("id","LayerDrawSVG");HC358.setAttribute("version","1.1");HC358.setAttribute("overflow","visible");HC358.setAttribute("viewBox","-"+this.width+" -"+this.height+" "+this.width*3+" "+this.height*3);HC358.setAttribute("style","position: absolute; left: -"+this.width+"px; top: -"+this.height+"px; z-index: 0;");HC358.setAttribute("height",this.height*3+"px");HC358.setAttribute("width",this.width*3+"px");HC358.setAttribute(_Fj3O,"true");var arrow=document.createElementNS("http://www.w3.org/2000/svg","path");arrow.setAttribute("d",px?"M 0 0 L 40 20 L 0 40 L 16 20 Z":"M 0 0 L 10 5 L 0 10 L 4 5 z");arrow.setAttribute("fill",this.brush.color);arrow.setAttribute("fill-opacity",this.brush.bgtransparency/100+0.3);var zY=document.createElementNS("http://www.w3.org/2000/svg","marker");zY.setAttribute("id","svgArrow");zY.setAttribute("viewBox",px?"0 0 40 40":"0 0 10 10");zY.setAttribute("refX",px?"24":"6");zY.setAttribute("refY",px?"20":"5");zY.setAttribute("markerUnits","strokeWidth");zY.setAttribute("orient","auto");zY.appendChild(arrow);HC358.appendChild(zY);this.wL1B.appendChild(HC358)}}return this.wL1B},_BWk:function(x,y){if(this.ycE>this.ignoreMoveRange||this.ycE<-this.ignoreMoveRange){x=Math.abs(x);if(this.ycE<0)this.ycE=Math.abs(this.ycE)}this.ycE+=x;if(this.jx7h8>this.ignoreMoveRange||this.jx7h8<-this.ignoreMoveRange){y=Math.abs(y);if(this.jx7h8<0)this.jx7h8=Math.abs(this.jx7h8)}this.jx7h8+=y},autoZoomLogo:function(){},clearMeasurePaths:function(){if(this.a5xg.length>0){for(var i=0;i<this.a5xg.length;i++)this.removeMeasurePath(i,false)}this.a5xg=[]},removeMeasurePath:function(pn,removeItem){if(this.a5xg.length>pn){if(typeof removeItem!="boolean")removeItem=true;var path=this.a5xg[pn];if(path.Q$Fq8){MEvent.removeBuiltInListener(path.Q$Fq8,"click",path.q9);path.Q$Fq8=null}for(var i=0;i<path.$923.length;i++){var T05=path.$923[i];T05.marker.finalize();T05.marker=null;T05.point=null}if(path.TErp){path.TErp.finalize();path.TErp=null}if(removeItem)_removeArrayItem(this.a5xg,pn,pn)}},q8g:function(pt,start){if(typeof start!="boolean")start=false;var t52Py=this.H9W5;var $w7F=null;if(start){$w7F={$923:[],TErp:null};if(this.a5xg.length==0)this.a5xg[0]=$w7F;else this.a5xg.push($w7F)}else{$w7F=this.a5xg[this.a5xg.length-1]}var WtA=0;var tip="";if($w7F.$923.length>0){var hEEr=$w7F.$923[$w7F.$923.length-1];if(hEEr.point._galt()==pt._galt()&&hEEr.point._galn()==pt._galn())return;WtA=this.measDistance([hEEr.point,pt]);WtA=hEEr.r18+WtA;tip=t52Py.P9V9n.replace(t52Py.j6y,(WtA<1000)?WtA+"\u7c73":parseInt(WtA/100)/10+"\u516c\u91cc")}else{tip=t52Py.wV9}tip=t52Py.tip.replace(t52Py.D6313,tip);var YTW=new MMarker(pt,new MIcon(t52Py._2GFL,11,11),null,new MLabel(tip,15,undefined,undefined,{enableStyle:false}));YTW.autoHide=false;YTW.creator=MLayer.SYSTEM;this.addOverlay(YTW);$w7F.$923.push({point:pt,r18:WtA,marker:YTW})},closeMeasureCurrPath:function(){if(this.a5xg.length==0)return;var WtA=0;var pts=[];var $w7F=this.a5xg[this.a5xg.length-1];var t52Py=this.H9W5;if($w7F.TErp)return;if($w7F.$923.length==1){this.removeMeasurePath(this.a5xg.length-1);return}for(var i=0;i<$w7F.$923.length;i++){pts.push($w7F.$923[i].point);if(i==$w7F.$923.length-1)WtA=$w7F.$923[i].r18}var TErp=new MPolyline(pts,t52Py.IKb57);TErp.creator=MLayer.SYSTEM;this.addOverlay(TErp);var tip=t52Py.q118.replace(t52Py.j6y,(WtA<1000)?WtA+"\u7c73":parseInt(WtA/100)/10+"\u516c\u91cc");tip=t52Py.tip.replace(t52Py.D6313,tip);var marker=$w7F.$923[$w7F.$923.length-1].marker;marker.label.resetLabel({content:tip});$w7F.Q$Fq8=marker.label.div.firstChild.firstChild.firstChild;$w7F.q9=MEvent.bindDom($w7F.Q$Fq8,"click",this,this.wu2);$w7F.TErp=TErp},wu2:function(e){QD199(e);for(var i=0;i<this.a5xg.length;i++){if(e.target==this.a5xg[i].Q$Fq8){this.removeMeasurePath(i)}}}};Maplet.prototype.toString=function(){return "com.mapbar.maplet.Maplet"};Maplet.prototype.setIwStdSize=function(w,h){if(typeof w!="number")w=260;if(typeof h!="number")h=240;if(w<avBubble.minWidth)w=avBubble.minWidth;if(h<avBubble.minHeight)h=avBubble.minHeight;avBubble.width=w;avBubble.height=h};Maplet.prototype.setIwZoomInSize=function(w,h){if(typeof w!="number")w="";if(typeof h!="number")h="";if(w<avBubble.width)w="";if(h<avBubble.height)h="";avBubble._Q8ia=w;avBubble.v6yO=h};Maplet.prototype.addLayer=function(layer){if(layer&&layer instanceof MLayer){if(!this.qS[layer.id]){layer.initialize(this);this.qS[layer.id]=layer;var i=layer.options.zindex+10;if(typeof this.Xo911[i]!="undefined"){this.Xo911[i].push(layer)}else{this.Xo911[i]=[layer]}this.refresh()}}else{return false}return true};Maplet.prototype.removeLayer=function(layer,finalize){if(typeof finalize!="boolean")finalize=false;if(layer&&layer instanceof MLayer&&this.qS[layer.id]&&typeof layer.remove=="function"){if(this._96o3&&this.qpgD==layer){if(MEvent.contains(this,"layer_mouseout")>0){MEvent.trigger(this,"layer_mouseout",{layer:this.qpgD,pid:this._96o3.p,area:this._96o3.l,data:this._96o3.d,name:this._96o3.n,rect:this._96o3.rect})}this._96o3=null;this.qpgD=null}this.qS[layer.id].remove(finalize);this.qS[layer.id]=null;delete this.qS[layer.id];var pn=layer.options.zindex+10;if(typeof this.Xo911[pn]!="undefined"){var a=this.Xo911[pn];if(a.length==1){this.Xo911[pn]=undefined}else{for(var i=0;i<a.length;i++){if(a[i]==layer){a.splice(i,1)}}}}}};Maplet.prototype.clearLayers=function(finalize){if(!this.Mv24)return;for(var i in this.qS){if(this.qS[i].options.creator==MLayer.USER)this.removeLayer(this.qS[i],finalize)}if(!this.traffic&&!this.F2M){this.Mv24.clear();_removeNode(this.Mv24.div);this.Mv24=null;this.Xo911=[]}};Maplet.prototype.getLayers=function(){var qS=[];for(var i in this.qS){if(this.qS[i].options.creator==MLayer.USER)qS.push(this.qS[i])}return qS};Maplet.prototype.V$R=function(layer){if(typeof layer=="object"&&layer&&layer instanceof MLayer){for(var i=this.Xo911.length-1;i>=0;i--){if(typeof this.Xo911[i]!="undefined"){var c=this.Xo911[i];for(var HB3=c.length-1;HB3>=0;HB3--){if(c[HB3]==layer){if(c.length==1)this.Xo911[i]=undefined;else c.splice(HB3,1)}}}}var i=layer.options.zindex+10;if(typeof this.Xo911[i]!="undefined"){this.Xo911[i].push(layer)}else{this.Xo911[i]=[layer]}}};Maplet.prototype.setLayerDataPassiveUrl=function(url){if(typeof url!="string"||!url)return;this.layerDataPassiveUrl=url};Maplet.prototype.loadLayerDataOfPassiveMode=function(grid){if(this.layerData[grid]&&this.layerData[grid].passiveLoadStatus==Maplet.UNLOAD){if(!this.layerDataPassiveUrl){this.layerData[grid].passiveLoadStatus=Maplet.XN8;return}else{this.layerData[grid].passiveLoadStatus=Maplet.LOADING}var qjr=this.layerData[grid];var h_X=[];for(var i in this.qS){var layer=this.qS[i];if(layer.options.needData&&layer.inZoomRange(this.AG)&&layer.options.dataLoadMode==MLayer.DL_PASSIVE&&!layer.data[grid]&&layer.syT[grid]){if(layer.options.serverPathType==MLayer.PT_COMBINER)h_X.push("["+layer.options.combinerParas+"|"+layer.d666()+"]");else h_X.push(layer.d666())}}if(h_X.length>0){new SwF6(this.layerDataPassiveUrl+"?n="+h_X.join(";")+"&p="+sI[this.AG]+"/"+qjr.dirname+"/"+qjr.xyname+".js&g="+grid,this.ss8,false,true,this,undefined,[grid]).e0b()}else{this.layerData[grid].passiveLoadStatus=Maplet.LOADED}}};Maplet.prototype.ss8=function(grid,uH0){if(this.layerData[grid]){var g=this.layerData[grid];g.passiveLoadStatus=Maplet.LOADED;var C5$="__lgd"+grid;var uy=eval("typeof "+C5$+"==\"undefined\"?null:"+C5$);if(uy){for(var i in this.qS){var l=this.qS[i];C5$=l.d666()+g.dirname+"_"+g.xyname;if(typeof uy[C5$]=="object"&&uy)l.o7AS(grid,uy[C5$])}uy=null}}_removeNode(aa(uH0))};Maplet.prototype.addPanel=function(panel){if(panel&&panel instanceof MPanel){if(this.NV26[panel.id])return true;panel.initialize(this);this.NV26[panel.id]=panel}else{return false}};Maplet.prototype.removePanel=function(panel,finalize){if(typeof finalize!="boolean")finalize=false;if(typeof panel=="object"){if(this.NV26[panel.id]){panel.remove(finalize);this.NV26[panel.id]=null;delete this.NV26[panel.id]}else if(typeof panel.remove=="function"){panel.remove(finalize)}}else if(typeof panel=="string"){if(this.NV26[panel]){this.NV26[panel].remove(finalize);this.NV26[panel]=null;delete this.NV26[panel]}}};Maplet.prototype.getPanels=function(){var NV26=[];for(var i in this.NV26){if(this.NV26[i].options.creator==MPanel.USER)NV26.push(this.NV26[i])}return NV26};Maplet.prototype.clearPanels=function(finalize){for(var i in this.NV26){if(this.NV26[i].options.creator==MPanel.USER)this.removePanel(this.NV26[i],finalize)}};Maplet.prototype.addOverlay=function(overlay){if(typeof overlay=="object"){if(this.u5[overlay.id]){return}overlay.initialize(this);this.u5[overlay.id]=overlay;this.u5.length++}};Maplet.prototype.getZoomLevel=function(){return this.AG};Maplet.prototype.clearOverlays=function(finalize){if(typeof finalize!="boolean")finalize=false;this.hideBubble(this);for(var id in this.u5){var _UV=this.u5[id];if(_UV&&_UV.remove&&_UV.creator==MLayer.USER){_UV.remove(finalize);this.u5[id]=null;_UV=null;delete this.u5[id]}}};Maplet.prototype.removeOverlay=function(overlay,finalize){if(typeof finalize!="boolean")finalize=false;if(typeof overlay=="object"){if(this.u5[overlay.id]){this.u5[overlay.id].remove(finalize);this.u5[overlay.id]=null;delete this.u5[overlay.id];this.u5.length--}else if(typeof overlay.remove=="function"){overlay.remove(finalize)}}else if(typeof overlay=="string"&&overlay!='length'){if(this.u5[overlay]){this.u5[overlay].remove(finalize);this.u5[overlay]=null;delete this.u5[overlay];this.u5.length--}}};Maplet.prototype.clearCache=function(){cq.pu=null;cq.pu={}};Maplet.prototype.setAutoZoom=function(min,max){if(!min&&!max&&this.u5.length==0)return;if(!this.bInitialized)return;if(I41(min)){var c7=this.getOverlaysBound(min);min=c7.min;max=c7.max}var rt=this.getFitZoomLevel(min,max);if(rt.center&&rt.level){this.centerAndZoom(rt.center,rt.level)}else{if(rt.center)this.setCenter(rt.center);if(rt.level)this.setZoomLevel(rt.level)}};Maplet.prototype.getFitZoomLevel=function(min,max){var rt={center:null,level:null};if((min instanceof MPoint&&!min.T$3())||(max instanceof MPoint&&!max.T$3()))return rt;else if((typeof min=="string"&&!min)&&(typeof max=="string"&&!max))return rt;if(typeof min=="string"&&min){min=new MPoint(min);if(!min.T$3())return rt}if(typeof max=="string"&&max){max=new MPoint(max);if(!max.T$3())return rt}var n2CI,VIre,qv1s,x2P;var pts=[];if(!min||!max){for(var i in this.u5){var _UV=this.u5[i];if(_UV instanceof MMarker){pts.push(_UV.pt)}else if(_UV instanceof MPolyline){for(var qC=0;qC<_UV.pts.length;qC++){pts.push(_UV.pts[qC])}}}}else{pts.push(min);pts.push(max)}for(var i=0;i<pts.length;i++){var pt=pts[i];if(!i){qv1s=n2CI=pt._galn();x2P=VIre=pt._galt()}else{n2CI=Math.min(n2CI,pt._galn());VIre=Math.min(VIre,pt._galt());qv1s=Math.max(qv1s,pt._galn());x2P=Math.max(x2P,pt._galt())}}if(!n2CI){n2CI=qv1s=this.gA;VIre=x2P=this.gx}var size=this.getMaxBubbleSize();var ix=size.min.x,iy=size.max.y,ax=size.max.x,ay=size.min.y;var Qum2r=this.zp(ix,iy);var va1=this.zo(ix,iy);var Uj1=this.zp(ax,ay);var $Bv=this.zo(ax,ay);var x322=n2CI>Qum2r&&VIre>va1&&qv1s<Uj1&&x2P<$Bv;var b=(qv1s-n2CI<Uj1-Qum2r)&&(x2P-VIre<$Bv-va1);if(!x322&&!b){for(var i=this.AG-1;i>=MIN_ZOOM_LEVEL;i--){Qum2r=this.zp(ix,iy,i);va1=this.zo(ix,iy,i);Uj1=this.zp(ax,ay,i);$Bv=this.zo(ax,ay,i);if((qv1s-n2CI<Uj1-Qum2r)&&(x2P-VIre<$Bv-va1)){rt.level=i;break}}}else if(this.AG<MAX_ZOOM_LEVEL&&!(n2CI==qv1s&&VIre==x2P)){var w8RR2=false;for(var i=this.AG+1;i<=MAX_ZOOM_LEVEL;i++){Qum2r=this.zp(ix,iy,i);va1=this.zo(ix,iy,i);Uj1=this.zp(ax,ay,i);$Bv=this.zo(ax,ay,i);if((qv1s-n2CI>Uj1-Qum2r)||(x2P-VIre>$Bv-va1)){if(i-1!=this.AG)rt.level=i-1;w8RR2=true;break}}if(!w8RR2&&!rt.level)rt.level=MAX_ZOOM_LEVEL}if(!x322||rt.level)rt.center=new MPoint((n2CI+qv1s)/2,(VIre+x2P)/2,false);return rt};Maplet.prototype.getOverlaysBound=function(u5){var pts=[];var c7={min:null,max:null};u5=I41(u5)?u5:this.u5;for(var i in u5){var _UV=u5[i];if(typeof _UV!=='undefined'&&_UV){if(typeof _UV==='string'){pts.push(new MPoint(_UV))}else if(_UV instanceof MPoint){pts.push(_UV)}else if(_UV instanceof MMarker){pts.push(_UV.pt)}else if(_UV instanceof MPolyline){for(var qC=0;qC<_UV.pts.length;qC++){pts.push(_UV.pts[qC])}}}}if(pts.length){var n2CI,VIre,qv1s,x2P;for(var i=0;i<pts.length;i++){var pt=pts[i];if(!i){qv1s=n2CI=pt._galn();x2P=VIre=pt._galt()}else{n2CI=Math.min(n2CI,pt._galn());VIre=Math.min(VIre,pt._galt());qv1s=Math.max(qv1s,pt._galn());x2P=Math.max(x2P,pt._galt())}}c7.min=new MPoint(n2CI,VIre,false);c7.min.initialize(this);c7.max=new MPoint(qv1s,x2P,false);c7.max.initialize(this)}return c7};Maplet.prototype.setZoomLevel=function(AB,fb,xt145){AB=parseInt(AB);if(AB<MIN_ZOOM_LEVEL){AB=MIN_ZOOM_LEVEL}if(AB>MAX_ZOOM_LEVEL){AB=MAX_ZOOM_LEVEL}if(fb!=undefined&&!fb){return AB}var _h920=false;if(this.markerDragAnimation){with(this.Fqa){if(overlay!=null&&!overlay.ls)this.T352(false)}}if(AB!=this.AG){if(typeof xt145!="boolean"||xt145)this.V0382();_h920=true;for(var i in this.NV26){var p=this.NV26[i];if(p.options.zoomhide&&p.isVisible())p.setVisible(false)}this.lA.hide()}else{this.$g5T()}if(this.Mv24)MLayer.setTipVisible(false);if(iToolTipStyle==0)hideToolTipMenu();if(this.controlCanvas!=null){this.controlCanvas.update(AB)}if(this.gc!=null){for(var n8 in this.gc){if(this.gc[n8].nR)this.gc[n8].nR.controlCanvas.div.update(AB)}}if(this.ff)this.nI().setZoomLevel(AB);if(ContentInfo&&ContentInfo.isVisible()){var MfS=this.toScreenCoordinate(avBubble.c9p8);if(_isInsideRect({x:MfS[0],y:MfS[1]},{min:{x:0,y:0},max:{x:this.width,y:this.height}})){this.fl5T="infowindow";this.sT2_4=avBubble.c9p8;this.iEN7B=MfS[0];this.W97=MfS[1]}}this.AC_L=this.AG;this.AG=AB;this.xg=sj[this.AG];this.xf=qP[this.AG];this.sR=sI[this.AG]+"/";if(this.sT2_4!=""){var g4=this.iEN7B-this.width/2;var g5=this.W97-this.height/2;var MfS=this.toScreenCoordinate(this.sT2_4);var cU38=MfS[0]-g4;var K83=MfS[1]-g5;this.gA=this.zp(cU38,K83);this.gx=this.zo(cU38,K83);this.iEN7B=-1;this.W97=-1;this.sT2_4="";this.fl5T=""}this.gD=Math.floor((this.gA)/this.xg);this.gE=Math.floor((this.gx)/this.xf);if(this.gD<0)this.gD+=1;this.mapX=this.width/2-Math.round(((this.gA*wp)%(this.xg*wp))*this.imgWidth/(this.xg*wp));if(this.gx>=0){this.mapY=this.height/2-this.imgHeight+Math.round(((this.gx*wp)%(this.xf*wp))*this.imgHeight/(this.xf*wp))}else{this.mapY=this.height/2+Math.round(((this.gx*wp)%(this.xf*wp))*this.imgHeight/(this.xf*wp))}this.q39();this.refresh();if(_h920){if(apiType==1)MEvent.trigger(this,"zoom",AB);else MEvent.trigger(this,"zoom","&act=zoom&zm="+AB);var aaf=this.AC_L>this.AG?'zoomout':'zoomin';MEvent.trigger(this,aaf,this.AG)}this.lA.show();if(this.Mv24)this.Mv24.setVisible(true);for(var i in this.NV26){var p=this.NV26[i];if(p.options.zoomhide&&!p.isVisible()&&!p.LN$4.t93)p.setVisible(true)}};Maplet.prototype.setCenter=function(lf,li,fb,oi6r1){if(!this.w205){this.no();this.w205=true}var xR=lf;if(typeof lf=="object"){if(!lf.encrypt&&!lf.pid){if(!lf.maplet)lf.initialize(this);if(!lf.pid)lf.getPid()}xR=lf.pid}if(isNaN(parseFloat(xR))||(typeof xR=="string"&&xR.indexOf(',')>0)){var lh=cq.vp(xR);lf=lh[1];li=lh[0]}this.gx=Math.min(sy[1],Math.max(sy[0],parseFloat(lf)));this.gA=Math.min(sz[1],Math.max(sz[0],parseFloat(li)%360));if(typeof basepoilist!="object"&&!this.R__7&&this.gn1)this.gn1=false;if(fb==undefined||fb){this.setZoomLevel(this.AG)}if(oi6r1==undefined||oi6r1){if(apiType==1){MEvent.trigger(this,"pan",new MPoint(this.toMapCoordinate(this.width/2,this.height/2)))}else{MEvent.trigger(this,"pan","&act=pan&ctr="+this.toMapCoordinate(this.width/2,this.height/2))}}};Maplet.prototype.moveTo=function(left,top){this.top=parseInt(top);this.left=parseInt(left);this.panel.style.top=parseInt(top)+"px";this.panel.style.left=parseInt(left)+"px"};Maplet.prototype.getCenter=function(){if(apiType==1){return new MPoint(this.getCurrentMap().split(",").slice(1,3).join(","))}else{return this.getCurrentMap().split(",")[1]}};Maplet.prototype.enableTraffic=function(options){if(typeof options!="object"||!options)options={};if(!this.traffic){this.traffic=new MTraffic(options);this.traffic.initialize(this)}return this.traffic};Maplet.prototype.disableTraffic=function(){if(this.traffic){this.traffic.remove(true);this.traffic=null}};Maplet.prototype.enablePOILayer=function(options){if(typeof options!="object"||!options)options={};if(!this.F2M){this.F2M=new MPOILayer(options);this.F2M.initialize(this)}return this.F2M};Maplet.prototype.disablePOILayer=function(){if(this.F2M){this.F2M.remove(true);this.F2M=null}};Maplet.prototype.resize=function(w,h){w=parseInt(w);h=parseInt(h);if(w<0||h<0)return;if(w==this.width&&h==this.height)return;aa("myalert").style.display="none";if(this.snapshotBox.isVisible())this.snapshotBox.hide();if(this.xc)this.xc.hide();this.hideBubble();this.width=w;this.height=h;this.z4=Math.ceil((this.width)/(this.imgWidth)/2);this.z5=Math.ceil((this.height)/(this.imgHeight)/2);this.panel.style.width=w+"px";this.panel.style.height=h+"px";this.panel.style.clip='rect(0px,'+this.width+'px,'+this.height+'px, 0px)';this.sF.resize(w,h);this.sE.resize(w,h);this.vx.resize(w,h);if(this.Mv24){this.Mv24.resize(w,h);for(var i in this.qS){this.qS[i].resize(w,h)}}if(this.ff){this.nI().resize(h);this.nI().moveTo(this.width-16,0)}this.F0lQ();this.onresize();var An=(navigator.appVersion.match(new RegExp("6.","i"))=='6.')?0:2;this.lA.resize(w,h);this.setZoomLevel(this.AG);if(this.Mv24){for(var i in this.qS)this.qS[i].refreshDataXY()}for(var pf in this.gc){if(this.gc[pf]&&this.gc[pf].onresize){this.gc[pf].onresize(this)}}this.overview.onresize()};Maplet.prototype.zoomIn=function(){if(this.AG>=MAX_ZOOM_LEVEL)return;if(ContentInfo&&ContentInfo.isVisible())this.setZoomLevel(this.AG+1);else this.zoomTo(Math.min(MAX_ZOOM_LEVEL,this.AG+1))};Maplet.prototype.zoomOut=function(){if(this.AG<=MIN_ZOOM_LEVEL)return;if(ContentInfo&&ContentInfo.isVisible())this.setZoomLevel(this.AG-1);else this.zoomTo(Math.max(0,this.AG-1))};Maplet.prototype.centerAndZoom=function(pt,AB){this.setCenter(pt,"",false);if(typeof this.sF=="undefined"){this.AG=this.setZoomLevel(AB,false);this.showMap()}else{this.setZoomLevel(AB)}};Maplet.prototype.zoomTo=function(qB,fy,x,y){if(fy){this.fy=fy};if(ZOOM_TRANSITION&&(!ContentInfo||!ContentInfo.isVisible())){if(this.AZ!=null){clearTimeout(this.AZ)};this.AZ=null;if(typeof qB!="undefined"){this.AT=parseInt(qB);if(typeof x=="undefined"){this.vc=0}else{this.vc=parseInt(x)}if(typeof y=="undefined"){this.vd=0}else{this.vd=parseInt(y)}this.AZ=getTimeout(this,this.zoomTo,200)}else{var vG=new Number();if(this.AT>this.getZoomLevel()){if(this.AS<=(this.AT-this.AY)){if(this.AS==-1){this.AS=this.getZoomLevel()+this.AY}else{this.AS+=this.AY}vG=(this.AS-this.getZoomLevel());this.AN(this.AS,2*this.vc*vG,2*this.vd*vG);this.AZ=getTimeout(this,this.zoomTo,20)}else{this.AS=-1;this.ve=this.zo(-this.vc+this.width/2,-this.vd+this.height/2);this.vf=this.zp(-this.vc+this.width/2,-this.vd+this.height/2);this.setCenter(this.ve,this.vf,false,false);this.setZoomLevel(this.AT);if(this.fy){if(ContentInfo&&ContentInfo.isVisible())ContentInfo.setVisible(avBubble.e79());eval(this.fy)}}}else if(this.AT<this.getZoomLevel()){if(this.AS==-1||this.AS>=(this.AT+this.AY)){if(this.AS==-1){this.AS=this.getZoomLevel()-this.AY}else{this.AS-=this.AY}vG=Math.abs(this.AS-this.getZoomLevel());this.AN(this.AS,2*this.vc*vG,2*this.vd*vG);this.AZ=getTimeout(this,this.zoomTo,20)}else{this.AS=-1;this.ve=this.zo(-this.vc+this.width/2,-this.vd+this.height/2);this.vf=this.zp(-this.vc+this.width/2,-this.vd+this.height/2);this.setCenter(this.ve,this.vf,false,false);this.setZoomLevel(this.AT);if(this.fy){if(ContentInfo&&ContentInfo.isVisible())ContentInfo.setVisible(avBubble.e79());eval(this.fy)}}}}}else{this.setZoomLevel(qB)}};Maplet.prototype.panTo=function(x,y,fy){if(this.fa)return;this.xoffset=parseFloat(x);this.yoffset=parseFloat(y);this.Aq=0;this.Aw=0;this.fy=fy;this.ve=this.zo(-this.xoffset+this.width/2,-this.yoffset+this.height/2);this.vf=this.zp(-this.xoffset+this.width/2,-this.yoffset+this.height/2);this.va=parseInt(Math.sqrt(this.xoffset*this.xoffset+this.yoffset*this.yoffset));if(!this.fa){this.doPan()}};Maplet.prototype.toMapCoordinate=function(x,y){cq.li=this.zp(x,y);cq.lf=this.zo(x,y);return cq.zn()};Maplet.prototype.toScreenCoordinate=function(xQ){var MfS=[null,null];try{var ceA08=cq.vp(xQ);MfS[0]=this.zl(ceA08[0],ceA08[1]);MfS[1]=this.zm(ceA08[1],ceA08[0])}catch(e){throw e}return MfS};Maplet.prototype.showLogo=function(c2){if(c2){this.qI8Q4.style.display="block"}else{this.qI8Q4.style.display="none"}this.md0()};Maplet.prototype.showScale=function(c2,x4,xG,yb){this.fe=c2;if(this.fe){this.u8()}else{if(this.wq!=null)this.wq.hide()}};Maplet.prototype.showOverview=function(c2,c3){if(c2){this.overview.show();if(c3){this.overview.open()}else{this.overview.close()}}else{this.overview.hide();this.overview.close()}};Maplet.prototype.setOverviewLocation=function(location){this.overview.setLocation(location);this.md0();this.F0lQ()};Maplet.prototype.resizeOverview=function(w,h){this.overview.resizeTo(w,h);this.md0();this.F0lQ()};Maplet.prototype.showControl=function(c2){this.fj=c2;if(this.fj){if(this.controlCanvas)this.controlCanvas.show()}else{if(this.controlCanvas)this.controlCanvas.hide()}this.md0();this.F0lQ()};Maplet.prototype.getViewBound=function(){return{"LeftUp":this.toMapCoordinate(0,0),"LeftDown":this.toMapCoordinate(0,this.height),"RightUp":this.toMapCoordinate(this.width,0),"RightDown":this.toMapCoordinate(this.width,this.height)}};Maplet.prototype.calcPointsCt=function(pts){var s0cmg=Number.MAX_VALUE,M33dY=s0cmg,ax=-Number.MAX_VALUE,ay=ax;for(var qC=0;qC<pts.length;qC++){if(!pts[qC].maplet)pts[qC].initialize(this);s0cmg=Math.min(s0cmg,pts[qC].mapX);M33dY=Math.min(M33dY,pts[qC].mapY);ax=Math.max(ax,pts[qC].mapX);ay=Math.max(ay,pts[qC].mapY)}if(s0cmg!=Number.MAX_VALUE)return new MPoint(this.toMapCoordinate(s0cmg+(ax-s0cmg)/2,M33dY+(ay-M33dY)/2));else return null};Maplet.prototype.u0=function($_4){if($_4){this.r3KEY();return}if(!this.E108&&this.D34())return;if(this.c0){return}if(this.fs){return}this.c0=true;this.fs=true;if(this.h98F.length>0){if(((this.u2!=null&&this.u2=="traffic")||this.AG!=this.AC_L)||bpp[0]!=this.gxr){for(var p=0;p<this.h98F.length;p++){this.h98F[p].onmousedown=null;_removeNode(this.h98F[p])}this.h98F=[]}this.gxr=bpp[0]}this.dDig();var pT='';if(this.Mv24)this.Q4cd();var pw=0;var yk=this.yl;var uY=(this.u2=="undefined"||this.u2==null)?"poi":this.u2;var nL=nM[this.AG];this.sZ=0;this.s1=0;this.tf1=this.width;this.tg=this.height;this.s2=parseInt(this.gD);this.s3=parseInt(this.gE);this.th=parseInt(this.gD);this.ti=parseInt(this.gE);var uZ=new Array();var u4=new Array();var t1=parseInt(new Date().getTime()/60000);var s8=(360/sj[this.AG]);var ner6=this.getZoomLevel()-1;if(this.AG==this.AC_L)this.sE.clean();else if(typeof basepoilist!="object"&&!this.R__7&&this.gn1)this.gn1=false;for(var ix=-this.z4-1;ix<=this.z4;ix++){for(var iy=-this.z5-1;iy<=this.z5;iy++){try{var qy=parseInt(this.gD+ix);var qA=parseInt(this.gE+iy);qy=(qy)%s8;if(qy>=(s8/2))qy-=s8;if(qy<(-s8/2))qy+=s8;var dirx=parseInt(Math.floor((qy)/nL));var diry=parseInt(Math.floor((qA)/nL));{if(dirx<0)dirx+=1;if(diry<0)diry+=1}var Xn1=(qy)-dirx*nL;var yNj39=(qA)-diry*nL;var pM=this.kbx1.replace("img","img"+this.b284(Xn1,yNj39))+this.sR;var pQ=this.strImgUrl+"mapbank/"+uY+"/"+this.sR;var pG=this.strImgUrl+"mapbank/base/"+this.sR;if(this.AG>=14)pM+=dirx+"/";pQ+=dirx+"_"+diry+"/";pG+=dirx+"_"+diry+"/";pM+=dirx+"_"+diry+"/";pQ+=Xn1+"_"+yNj39+".png";pG+=Xn1+"_"+yNj39+".js";pM+=Xn1+"_"+yNj39+"."+this.xK;var p1=(ix*this.imgWidth)+parseInt(this.mapX);var p3=(-(iy*this.imgHeight)+parseInt(this.mapY));var p4=p3;if(this.yl!="aerial"&&this.yl.indexOf("aerial")<0){p3=p3+w8[this.AG]}var Cu5T3=false;var YGR=true;var U19=true;if((p1<-this.imgWidth||p1>this.width||p3>this.height||p3<-this.imgHeight))Cu5T3=true;if(this.u2!=null&&this.u2=="traffic"&&w8[this.AG]!=0&&((p4<this.height||p4<=0))){YGR=false;if(Cu5T3)pM=null}if(this.Mv24&&w8[this.AG]!=0&&((p4<this.height||p4<=0))){U19=false;if(Cu5T3)pM=null}if(Cu5T3&&YGR&&U19)continue;if(pM){if(this.sZ<(p1+this.imgWidth)){this.sZ=(p1+this.imgWidth);this.s2=parseInt(this.gD)+parseInt(ix)}if(this.s1<(p3+this.imgHeight)){this.s1=(p3+this.imgHeight);this.ti=parseInt(this.gE)+parseInt(iy)}if(this.tf1>p1){this.tf1=p1;this.th=parseInt(this.gD)+parseInt(ix)}if(this.tg>p3){this.tg=p3;this.s3=parseInt(this.gE)+parseInt(iy)}}var xY=((this.AG).toString(16)+(this.gD+ix).toString(16)+'l'+(this.gE+iy).toString(16)).toLowerCase();if(pw==0){pw=1}if(pM&&pM.indexOf("NaN")<0){if(this.pU[xY]==null){if(!rs||!px){this.pU[xY]=new Image();this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute";this.pU[xY].style.MozUserSelect="none"}else{this.pU[xY]=document.createElement("v:Image");this.pU[xY].id=xY;this.pU[xY].name=xY;this.pU[xY].ntry="0";this.pU[xY].unselectable="on";this.pU[xY].style.position="absolute";this.pU[xY].cE="f";this.pU[xY].style.rotation=this.rotation;this.pU[xY].style.width=this.imgWidth;this.pU[xY].style.height=this.imgHeight}if(px)this.pU[xY].style.filter="alpha(opacity=0);";else this.pU[xY].style.opacity="0";f1.nk(this.pU[xY],pM,this.imgWidth,this.imgHeight)}else{if(px&&rs){this.pU[xY].style.rotation=this.rotation}}var p2=(p1+this.imgWidth/2-this.width/2)*this.gk-(p3+this.imgHeight/2-this.height/2)*this.wT+this.width/2;var p5=(p1+this.imgWidth/2-this.width/2)*this.wT+(p3+this.imgHeight/2-this.height/2)*this.gk+this.height/2;this.pU[xY].style.top=parseInt(p5-this.imgHeight/2)+"px";this.pU[xY].style.left=parseInt(p2-this.imgWidth/2)+"px";this.pU[xY].c2=true;this.pU[xY].setAttribute("origy",parseInt(p5-this.imgHeight/2));this.pU[xY].setAttribute("origx",parseInt(p2-this.imgWidth/2))}if(this.u2!=null&&this.u2=="traffic"){if(!__mapbar_magic_id)__mapbar_magic_id="";var pV=bpp[0]+__mapbar_magic_id+"/"+ner6+"/o"+xY+".png";if(i639){var kA8x2=document.createElement("v:image");kA8x2.setAttribute("unselectable","on");kA8x2.id="o"+xY;kA8x2.setAttribute("name",xY);kA8x2.setAttribute("traffic","yes");kA8x2.style.cssText="position:absolute;top:"+p4+"px;left:"+p1+"px;width:300px;height:300px";kA8x2.src=pV;this.h98F.push(kA8x2)}else{var img=document.createElement("IMG");img.id="o"+xY;img.setAttribute("name",xY);img.src=pV;img.ntry="0";img.unselectable="on";img.onerror=function(){imageTileError(this)};img.onload=function(){imageTileOk(this)};img.onmousedown=function(){return false};img.style.cssText="position:absolute;top:"+p4+"px;left:"+p1+"px;-moz-user-select: none;";img.setAttribute("traffic","yes");this.h98F.push(img)}uZ[uZ.length]='o'+xY;u4[u4.length]=dirx+"_"+diry+"/";}else if(this.u2!=null&&this.u2!="undefined"&&pQ&&pQ.indexOf("NaN")<0){if(this.pU[xY]){var id="o"+xY;var path=dirx+"_"+diry+"/";if(((typeof basepoilist=="object"&&basepoilist[sI[this.AG]+"/"+path+id+".png"]))||in9o0){var div=aa(id);if(!div){div=document.createElement("DIV");div.setAttribute("unselectable","on");div.id=id;div.setAttribute("name",xY);div.style.cssText="position:absolute;width:0px;height:0px;";this.h98F.push(div)}div.style.left=p1+"px";div.style.top=p4+"px";uZ[uZ.length]=id;u4[u4.length]=path}}}if(this.Mv24){var C2xT=maplet.toMapCoordinate(p1,p4).split(',');this.layerData[xY]={passiveLoadStatus:Maplet.UNLOAD,filename:this.sR+dirx+"_"+diry+"/"+Xn1+"_"+yNj39,dirx:dirx,diry:diry,grid:xY,Xn1:Xn1,yNj39:yNj39,dirname:dirx+"_"+diry,xyname:Xn1+"_"+yNj39,x:p1,y:p4,qy:qy,qA:qA,gridx:qy,gridy:qA}}pM=null;pQ=null}catch(e){throw(e)}}}for(var qI in this.pU){var img=this.pU[qI];if(img!=null&&typeof img=="object"){if((typeof img.c2=="boolean"&&img.c2)||img.c2=="true"){if(img.parentNode!=this.sE.div){if(img.parentNode!=null)img.parentNode.removeChild(img);this.sE.div.appendChild(img)}}else if(img.parentNode!=this.sG.div){if(img.parentNode!=null)_removeNode(img);img.onerror=null;img.onload=null;img=null;delete this.pU[qI]}}}if(!(this.u2!=null&&this.u2=="traffic")&&this.h98F.length>0){var s=uZ.join(",");for(var HB3=this.h98F.length-1;HB3>=0;HB3--){if(s.indexOf(this.h98F[HB3].id)==-1){if(this.h98F[HB3].parentNode){_removeNode(this.h98F[HB3])}this.h98F.splice(HB3,1)}}for(var HB3=uZ.length-1;HB3>=0;HB3--){if(aa(uZ[HB3]))uZ.splice(HB3,1)}}if(this.h98F.length>0){for(var q=0;q<this.h98F.length;q++){this.lA.div.appendChild(this.h98F[q])}}pT=null;for(var pid in this.NV26){var p=this.NV26[pid];if(p.paint)p.paint()}if(this.Mv24){for(var i in this.qS){if(this.qS[i].inZoomRange(this.AG))this.qS[i].update();else this.qS[i].clear()}}if(this.sE.div.parentNode!=this.sF.div){this.sF.div.appendChild(this.sE.div)}if(this.vx.div.parentNode!=this.sF.div){this.sF.div.appendChild(this.vx.div)}if((typeof this.fo=="boolean"&&this.fo)&&document.getElementById("LayerMap")&&document.getElementById("LayerMap").filters&&document.getElementById("LayerMap").filters.length>0){document.getElementById("LayerMap").filters[0].apply();document.getElementById("LayerMap").filters[0].vu()}if(this.aN.length>0){for(var qk=0;qk<this.aN.length;qk++){this.aN[qk].paint()}}if(this.zy!=null){this.zy.paint();if(this.tG!=null){this.tG.paint()}}if(this.aO.length>0){for(qk=0;qk<this.aO.length;qk++){this.aO[qk].u9(this.vx.div);this.aO[qk].paint(this.lA.div)}}if(this.yG.length>0){if(!px)this.yG[this.yG.length-1].label(this.lA.graphics)}else{if(iToolTipStyle==0)hideToolTipMenu()}if(this.lA.div.parentNode!=this.sF.div){this.sF.div.appendChild(this.lA.div)}if(this.aE.length>0){this.aG=null;this.aH=null;this.aF=null;for(qk=0;qk<this.aE.length;qk++){if(this.AG>=this.aE[qk].AJ&&this.AG<=this.aE[qk].AI){var w4=this.zl(this.aE[qk].li,this.aE[qk].lf);var w5=this.zm(this.aE[qk].lf,this.aE[qk].li);if(w4>=0&&w4<=this.width&&w5>=0&&w5<=this.height){if(this.aG==null){this.aG=new Array();this.aH=new Array();this.aF=new Array()}this.aG[this.aG.length]=w4;this.aH[this.aH.length]=w5;this.aF[this.aF.length]=qk}}}}if(!this.bInitialized){this.bInitialized=true}if(this.u2!=null&&this.u2!="undefined"){if(this.u2=="base"){if(this.AG>=parseInt(bpp[1])&&this.AG<=parseInt(bpp[2])){if(!this.gn1&&!in9o0){this.Ct$5A();this.gn1=true}var i=0;for(var l in uZ){try{if(typeof uZ[l]=="string"){if(typeof basepoilist=="object"&&basepoilist[sI[this.AG]+"/"+u4[l]+uZ[l]+".png"]){if(!in9o0)new SwF6(bpp[0]+sI[this.AG]+"/"+u4[l]+uZ[l]+".png",parseInt,false,true).e0b()}i++}}catch(lN){throw(lN)}uZ[l]=null;u4[l]=null}}else{for(var su in uZ){try{if(typeof uZ[su]=="string"&&document.getElementById(uZ[su])&&document.getElementById(uZ[su]).parentNode){if(!in9o0)_removeNode(aa(uZ[su]))}}catch(e){throw(e)}uZ[su]=null;u4[su]=null}}}else{t1=parseInt(new Date().getTime()/60000);for(var uD in uZ){try{if((this.u2!="traffic")&&typeof uZ[uD]=="string"){XMLHttp.sendReq('GET','maplite/'+this.u2+'.jsp?'+this.u3+'&oid='+uZ[uD]+'&epoch='+t1,'',vB,uZ[uD])}}catch(e){throw(e)}uZ[uD]=null;u4[uD]=null}}uZ.length=0;uZ=null;u4.length=0;u4=null}this.c0=false;this.fs=false;for(var i=0;i<2;i++){for(var qi in this.u5){if(this.u5[qi]&&this.u5[qi].paint){if(i==0&&this.u5[qi] instanceof MMarker&&!this.u5[qi].ls)this.u5[qi].paint();else if(i==1&&this.u5[qi].N1g10)this.u5[qi].paint()}}}avBubble.mFc();if(this.overview)this.overview.paint();cq.lf=this.gx;cq.li=this.gA;var gz=cq.zn();this.yu=gz+"@"+this.AG;if(ALLOW_MV){try{var ww="@mapbar"+(new Date().getTime()%86400).toString(36);sB.src="http://mv.mapbar.com/?"+this.yu+"@"+this.yt+"@"+this.width.toString(36).toUpperCase()+"@"+this.height.toString(36).toUpperCase()+"@"+this.sS.toString(36).toUpperCase()+"@"+c75+"@"+strLicenseKey.toString(36).toUpperCase()+"@"+this.yl+"@"+((bp)?1:0)+"@"+((this.u2)?this.u2:"")+ww}catch(e){throw(e)}}this.sF.moveTo(0,0);this.vx.moveTo(0,0);this.lA.moveTo(0,0);MEvent.trigger(this,"update",this.yu);this.tJW3=0;this.R8G=0};Maplet.prototype.getEllipse=function(){var r=[];for(var i in this.u5){if(this.u5[i] instanceof MEllipse)r.push(this.u5[i])}return r};Maplet.prototype.getRoundRect=function(){var r=[];for(var i in this.u5){if(this.u5[i] instanceof MRoundRect)r.push(this.u5[i])}return r};Maplet.prototype.getMarkers=function(){var r=[];for(var i in this.u5){var _UV=this.u5[i];if(_UV instanceof MMarker&&_UV.creator==MLayer.USER)r.push(_UV)}return r};Maplet.prototype.getPolylines=function(mi5_4){if(typeof mi5_4!="number")mi5_4=1;var r=[];for(var i in this.u5){var _UV=this.u5[i];if(_UV instanceof MPolyline&&_UV.creator==MLayer.USER){if(mi5_4==2&&!_UV.c15S())continue;else if(mi5_4==3&&_UV.c15S())continue;r.push(_UV)}}return r};Maplet.prototype.equalsLLCoords=function(Ek3p,s2_y5,n3hl){if(typeof Ek3p=="string"&&Ek3p&&typeof s2_y5=="string"&&s2_y5){try{if(Ek3p==s2_y5)return true;if(typeof n3hl!="number")n3hl=0;var nmC=maplet.toScreenCoordinate(Ek3p);var Vp2j=maplet.toScreenCoordinate(s2_y5);if((nmC[0]==Vp2j[0]||Math.abs(nmC[0]-Vp2j[0])<=n3hl)&&(nmC[1]==Vp2j[1]||Math.abs(nmC[1]-Vp2j[1])<=n3hl))return true}catch(nc){}}return false};Maplet.prototype.measDistance=function(pts){try{var g0=0;var ur=pts.length;var zh=[],lf=0,li=0;for(var su=1;su<ur;su++){zh.push(cq.vp(pts[su-1].getPid()));zh.push(cq.vp(pts[su].getPid()));lf=zh[1][1]-zh[0][1];li=zh[1][0]-zh[0][0];g0+=Math.sqrt(lf*lf+li*li*0.64);zh.length=0}return parseInt(g0*this.gM*111111.0)}catch(nc){return 0}};Maplet.prototype.measArea=function(pts){try{var area=0;var ur=pts.length;var qC=2;var qI=0;for(var i=1;i<=ur;i++){var qj=(qC%ur);var pC=(qI%ur);var lon=parseFloat(cq.vp(pts[(i%ur)].getPid())[0]);var lat=parseFloat(cq.vp(pts[qj].getPid())[1]);var r30_Y=parseFloat(cq.vp(pts[pC].getPid())[1]);area+=lon*(lat-r30_Y);qC++;qI++}return parseInt(Math.abs(area/2)*this.gM*this.gM*100000*100000)}catch(nc){return 0}};Maplet.prototype.decodeLine=function(pts,M9rC0){var rt=[];if(typeof pts!="string"||!pts||typeof M9rC0!="string"||!M9rC0||M9rC0.indexOf(",")==-1)return rt;var Wya5=this.R42pE(pts);var D75C=this._4bv(M9rC0);for(var i=0;i<Wya5.length;i++){rt.push(new MPoint(Wya5[i][1]*0.00001,Wya5[i][0]*0.00001,false,typeof D75C[i]=="undefined"?0:D75C[i]));rt[i].initialize(this)}return rt};Maplet.prototype.R42pE=function(dTK9f){var N7k=[];if(typeof dTK9f=="string"&&dTK9f){var qt=x149(dTK9f);var x=qt[0];var y=qt[1];N7k.push([x,y]);for(var i=2;i<qt.length;i+=2){x+=qt[i];y+=qt[i+1];N7k.push([x,y])}}return N7k};Maplet.prototype._4bv=function(dTK9f){var N7k={};if(typeof dTK9f=="string"&&dTK9f&&dTK9f.indexOf(",")!=-1){var qt=dTK9f.split(",");for(var i=0;i<qt.length;i++){var r=x149(qt[i]);var m49=0;for(var qC=0;qC<r.length;qC++){m49+=r[qC];N7k[m49]=i+1}}}return N7k};Maplet.prototype.getLevelGroup=function(){var level=this.AG;if(level>=0&&level<=3)return 3;else if(level>=4&&level<=7)return 2;else if(level>=8&&level<=11)return 1;else if(level>=12&&level<=18)return 0;else return 3};Maplet.prototype.setMapBound=function(c7){if(!c7.min||!(c7.min instanceof MPoint)||!c7.max||!(c7.max instanceof MPoint))return;if(!c7.min.maplet)c7.min.initialize(this);if(!c7.max.maplet)c7.max.initialize(this);c7.b_x=c7.min.clone();c7.j36=c7.max.clone();c7.n2CI=c7.min._galn();c7.VIre=c7.min._galt();c7.qv1s=c7.max._galn();c7.x2P=c7.max._galt();c7.i7S=c7.n2CI+(c7.qv1s-c7.n2CI)/2;c7.XCk1=c7.VIre-(c7.VIre-c7.x2P)/2;c7.T7M5=new MPoint(c7.i7S,c7.XCk1,false);c7.T7M5.initialize(this);this.mapBound=c7;this.D34()};Maplet.prototype.getMapBound=function(){return this.mapBound};Maplet.prototype.D34=function(){this.E108=true;var S99g=false;if(!this.fa&&this.mapBound){var FF5H=this.mapBound;FF5H.b_x.recalcScreenCoords();FF5H.j36.recalcScreenCoords();FF5H.T7M5.recalcScreenCoords();var ix=FF5H.n2CI;var iy=FF5H.VIre;var ax=FF5H.qv1s;var ay=FF5H.x2P;var w=FF5H.j36.mapX-FF5H.b_x.mapX;var h=FF5H.j36.mapY-FF5H.b_x.mapY;var lon=this.gA;var lat=this.gx;var gC=new MPoint(this.gA,this.gx,false);gC.initialize(this);if(w>this.width&&h>this.height){var AK71=this.K3g7i.tl;var U9nSU=this.K3g7i.s4;var IJ2=this.K3g7i.s6;var Aob=this.K3g7i.tj;if(ix>AK71)lon=this.gA+(ix-AK71);else if(ax<IJ2)lon=this.gA-(IJ2-ax);if(iy<U9nSU)lat=this.gx-(U9nSU-iy);else if(ay>Aob)lat=this.gx+(ay-Aob)}else{if(gC.mapX!=FF5H.T7M5.mapX||gC.mapY!=FF5H.T7M5.mapY){lon=FF5H.i7S;lat=FF5H.XCk1}}var Kfm$=new MPoint(lon,lat,false);Kfm$.initialize(this);if(gC.mapX!=Kfm$.mapX||gC.mapY!=Kfm$.mapY){this._67R=false;this.setCenter(new MPoint(lon,lat,false));S99g=true}}this.E108=false;return S99g};Maplet.prototype.finalize=function(){this.clearOverlays(true);this.clearPanels(true);if(ContentInfo)ContentInfo.finalize();ContentInfo=null;this.disablePOILayer();this.disableTraffic();this.clearLayers(true);this.Q4cd();for(var i in this.pU){try{if(this.pU[i]!=null&&typeof this.pU[i]=="object"){this.pU[i].c2=false}}catch(e){}}this.fL();if(this.zP)clearTimeout(this.zP);if(this.controlCanvas)this.controlCanvas.g1();if(this.overview)this.overview.g1();if(this.snapshotBox)this.snapshotBox.finalize();MEvent.removeBuiltInListener(this.map,"mousemove",this.y1Mnm["map_mousemove"]);MEvent.removeBuiltInListener(this.map,"mousedown",this.y1Mnm["map_mousedown"]);MEvent.removeBuiltInListener(this.map,"mouseup",this.y1Mnm["map_mouseup"]);MEvent.removeBuiltInListener(this.map,"click",this.y1Mnm["map_click"]);MEvent.removeBuiltInListener(this.map,"dblclick",this.y1Mnm["map_dblclick"]);MEvent.removeBuiltInListener(this.map,"mouseout",this.y1Mnm["map_mouseout"]);MEvent.removeBuiltInListener(this.map,"drag",this.y1Mnm["map_drag"]);MEvent.removeBuiltInListener(this.map,"dragstart",this.y1Mnm["map_dragstart"]);MEvent.removeBuiltInListener(this.map,"dragend",this.y1Mnm["map_dragend"]);MEvent.removeBuiltInListener(this.map,"mouseover",this.y1Mnm["map_mouseover"]);MEvent.removeBuiltInListener(this.map,"mousewheel",this.y1Mnm["map_mousewheel"]);MEvent.removeBuiltInListener(this.map,"DOMMouseScroll",this.y1Mnm["map_DOMMouseScroll"]);if(kp)MEvent.removeBuiltInListener(document,"keydown",this.y1Mnm["document_keydown"]);M7e5S(this.y1Mnm);this.sG.finalize();this.sF.finalize();this.zs.finalize();this.sE.finalize();this.vx.finalize();this.wq.finalize();this.sD.finalize();_removeNode(this.E8_2.container);this.Fqa.fC.finalize();this.lA.finalize();this.qI8Q4.onclick=null;_removeNode(this.qI8Q4);_removeNode(this.W534);this.clearCache();M7e5S(this);document['mapbar-maplet']=null};Maplet.prototype.setBasemapImgUrl=function(url,format){url=url||strImgsvrUrl+'mapbank/mapbar/';format=format||'png';if(url===this.kbx1&&format===this.xK){return}this.kbx1=url;this.xK=format;if(this.bInitialized){this.refresh(true)}};Maplet.prototype.setOverviewImgUrl=function(url,format){url=url||strImgsvrUrl+'mapbank/mapbar/';format=format||'png';if(url===this.gaSe&&format===this.h23){return}this.gaSe=url;this.h23=format;if(this.overview.fg){this.overview.paint(true)}};function a8(id,lf,li,label,minLevel,maxLevel){this.id=id;this.li=li;this.lf=lf;this.AJ=minLevel;this.AI=maxLevel;this.xP=label};Maplet.prototype.aZ=function(e){if(maplet.snapshotBox.e3r1y){maplet.snapshotBox.e3r1y=false;return}if(this.xc){this.xc.hide()}var l6=(px)?event.srcElement.id:e.target.id;var target=(px)?event.srcElement:e.target;var Ap=parseInt((px)?event.clientX:e.clientX)-this.offsetX;var Av=parseInt((px)?event.clientY:e.clientY)-this.offsetY;this.l6=l6;this.fS=Ap-this.left;this.fT=Av-this.top;if(this.l6!=null&&this.l6.indexOf("ctrl")>=0){return false}if(this.ff&&this.nI().qn(this.fS,this.fT)){this.AP.tC(this.fS,this.fT);return}if(this.aY()){var fR=this.zp(this.fS,this.fT);var fO=this.zo(this.fS,this.fT);if(this.sS==ts.ty&&(this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG")&&this.downX==this.zQ&&this.downY==this.zR&&MEvent.contains(maplet,"click")>0){var l137=cq.zn(this.zp(this.fS,this.fT),this.zo(this.fS,this.fT));if(apiType==1){var pt=new MPoint(l137);pt.initialize(this);MEvent.trigger(this,'click',e,pt)}else MEvent.trigger(this,'click',e,l137)}var cV=false;if((this.sS==7)){this.addOrigin(fO,fR)}else if((this.sS==8)){this.addDestination(fO,fR)}else if((this.sS==6)){cq.lf=fO;cq.li=fR;var fQ=cq.zn();nX();if(apiType==1)MEvent.trigger(this,"bookmark",{action:"add",point:new MPoint(fQ),zoom:this.AG});else MEvent.trigger(this,"bookmark","&act=add&latlon="+fQ+"&zm="+this.AG)}else if(this.sS==ts.ty||this.sS==ts.tu||this.sS==ts.l3){if((new Date().getTime()-this.tD)>=500){this.tD=new Date().getTime();if(this.cQ){this.cQ=false}else{var b=false;var yw=(this.l6=="LayerMask"||this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG"||(target.parentNode&&target.parentNode.id=="LayerMap")||(target.id&&target.id.indexOf("OverlayBg")>=0)||(target.getAttribute&&target.getAttribute(_X6IT)));if(!this.cn&&yw){if(this.l4p)return;if(iToolTipStyle==0)hideToolTipMenu();b=true}if(yw&&!this.Su15&&this.Mv24){var img=null;if(img=this.getImgByXY(this.moveX,this.moveY,true)){var fB8=false;for(var i=this.Xo911.length-1;i>=0;i--){if(typeof this.Xo911[i]!="undefined"){for(var HB3=this.Xo911[i].length-1;HB3>=0;HB3--){if(!this.Xo911[i][HB3].inZoomRange(this.AG))continue;var r=this.Xo911[i][HB3].click(img,this.moveX,this.moveY);b=r.center2map;if(r.data){if(r.firevent&&MEvent.contains(this,"layer_click")>0){MEvent.trigger(this,"layer_click",{layer:this.Xo911[i][HB3],pid:r.data.p,area:r.data.l,data:r.data.d,name:r.data.n,rect:r.data.rect});b=false}fB8=true;break}}}if(fB8)break}}}if(this.clickToCenter&&b){if(this.t1B_!=null)this.hideBubble();this.waitPan(this.width/2-this.fS,-this.fT+this.height/2)}}this.cn=false}else{this.tD=new Date().getTime()}}else if(this.sS==ts.tb||this.sS==ts.ta||this.sS==ts.lz||this.sS==ts.ly||this.sS==ts.sy9){if(this.allowDrawingDragMap&&!this.Jj1j){this.Jj1j=true;return false}if(this.l6!=null&&this.l6.indexOf("ctrl")>=0)return false;if(this.sS==ts.sy9){with(this.IcK4){if($923.length&&target&&target.getAttribute(N152)=="marker"&&target.getAttribute("oid")==$923[$923.length-1].id){if($923.length>1){var n=$923;var l=Ife;XlM=0;if(this.vA!="undefined")this.setMode(this.vA);if(MEvent.contains(this,"roadline")>0){MEvent.trigger(this,"roadline",n,l)}}}else{var pt=new MPoint(fR,fO,false);if($923.length)this.D9J$4(pt,true);this.b6656(pt);this.d0I()}}}else{if(!this.zy){var cr=this.sS==ts.ly||this.sS==ts.ta;var P56=new MBrush(this.brush.color,this.brush.stroke,this.brush.style,cr,this.brush.bgcolor,this.brush.transparency,this.brush.bgtransparency,this.brush.arrow);if(this.sS==ts.tb)P56=this.H9W5.IKb57;var hMi=new MPoint(cq.zn(fR,fO));this.zy=new MPolyline([hMi],P56,null,null);this.zy.initialize(this,false);this.sv++;if(this.sS==ts.tb)P56=this.H9W5.P5D61;this.tG=new MPolyline([hMi,hMi],P56,null,null);this.tG.initialize(this,false);this.sv++;if(this.sS==ts.tb){this.q8g(hMi,true);nX()}}else{var v9s16=new MPoint(cq.zn(fR,fO));this.zy.pts.push(v9s16);this.zy.update();this.tG.pts[0]=v9s16;this.tG.pts[1]=new MPoint(cq.zn(fR,fO));this.tG.update();if(this.sS==ts.tb)this.q8g(v9s16)}}cV=true}if(l6=="LayerDrawMap"&&!cV){if(this.aG!=null&&this.aH!=null){for(var qk=0;qk<this.aG.length;qk++){if(Math.abs(this.aG[qk]-this.fS)<HOTSPOT_SIZE&&Math.abs(this.aH[qk]-this.fT)<HOTSPOT_SIZE){var yg="";if(apiType==1)yg=this.aE[this.aF[qk]].xP;else yg="&hotspot="+this.aE[this.aF[qk]].xP;this.vi=0;MEvent.trigger(this,"hotspot",yg);if(hs){this.setCenter(this.aE[this.aF[qk]].lf,this.aE[this.aF[qk]].li);this.setZoomLevel(8)}break}}}}}};Maplet.prototype.a1=function(e){var l6=(px)?event.srcElement.id:e.target.id;var target=(px)?event.srcElement:e.target;this.l6=l6;nX();if(this.l6!=null&&this.l6.toString().indexOf("ctrl")>=0)return false;if(this.aY()){if(this.sS!=ts.tz&&this.sS!=ts.tA&&this.sS!=ts.D57MH)this.q453("default",this.map);var l137=cq.zn(this.zp(this.fS,this.fT),this.zo(this.fS,this.fT));if(apiType==1){var pt=new MPoint(l137);pt.initialize(this);MEvent.trigger(this,'dbclick',e,pt)}else{MEvent.trigger(this,'dbclick',e,l137)}if(this.sS==ts.tb||this.sS==ts.ta){var g0=0;var area=0;var $w7F=this.a5xg[this.a5xg.length-1];if(this.zy){var ur=this.zy.pts.length;if(!px)ur=ur-1;if(this.sS==ts.tb){g0=$w7F.$923[$w7F.$923.length-1].r18;this.closeMeasureCurrPath()}else{this.zy.pts[ur]=this.zy.pts[0];area=this.measArea(this.zy.pts)}if(this.zy.zX.parentNode==this.lA.div)this.zy.remove(true)}if(this.tG&&this.tG.zX.parentNode==this.lA.div)this.tG.remove(true);this.zy=null;this.tG=null;if(!px)this.refresh();if(g0.toString()==eval("Number.NaN.toString()"))g0=0;if(area.toString()==eval("Number.NaN.toString()"))area=0;if(this.sS==ts.ta){var xk="";if(area>1000000){area=Math.round((area/10000/10/10)*100)/100;xk=(en==0)?tX("%u603E%uF79D%u1151")+":"+area+tX("%u5E77%uC42C%uB725%uE338"):"Total area:"+area+"km2"}else{area=Math.round(area*100)/100;xk=(en==0)?tX("%u603E%uF79D%u1151")+":"+area+tX("%u5E76%uC42C%uE22C"):"Total area:"+area+"m2"}if(this.vA!="undefined")this.setMode(this.vA);sC(this.width/2+this.left+this.offsetX,this.height/2+this.top+this.offsetY,xk);if(apiType==1)MEvent.trigger(this,"measarea",area);else MEvent.trigger(this,"measarea","&act=measarea&area="+area+tX("%u5E77%uC42C%uB725%uE338"))}else{if(apiType==1)MEvent.trigger(this,"measure",g0);else MEvent.trigger(this,"measure","&act=measure&dist="+g0+tX("%u516E%uE338"))}this.setMode('pan')}else if(this.sS==ts.lz||this.sS==ts.ly){var yg=null;if(this.zy){var c1w0N=this.zy.pts.length;if(!px)c1w0N=c1w0N-1;this.zy.pts.length=c1w0N;if(this.zy.zX.parentNode==this.lA.div)this.zy.remove(true);if(apiType==1){yg=this.zy.zn();yg.zoom=this.AG}else yg=("&act=add&pline="+this.zy.zn()+"&zm="+this.AG)}if(this.tG&&this.tG.zX.parentNode==this.lA.div){this.tG.remove(true)}this.zy=null;this.tG=null;if(!px)this.refresh();var nb=(this.sS==ts.lz)?"drawline":"drawarea";if(this.vA!="undefined")this.setMode(this.vA);MEvent.trigger(this,nb,yg)}else if(this.sS==ts.ty||this.sS==ts.tu||this.sS==ts.l3){if(!DISABLE_DBCLICK_ZOOM&&this.l6&&(this.l6=="LayerMask"||this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG"||target.parentNode.id=="LayerMap"||target.id.indexOf("OverlayBg")>=0||this.l6.substring(0,"mk_shadow_".length)=="mk_shadow_"||target.getAttribute("traffic")=="yes")||(target.getAttribute(_X6IT))){this.vi=0;if(this.getZoomLevel()<MAX_ZOOM_LEVEL)this.zoomTo(this.getZoomLevel()+1,void(0),this.width/2-this.fS,-this.fT+this.height/2);else if(this.getZoomLevel()==MAX_ZOOM_LEVEL)this.panTo(this.width/2-this.fS,-this.fT+this.height/2)}}}};Maplet.prototype.a2=function(e){if(this.sS!=ts.ty)this.hideBubble();if(this.markerDragAnimation)this.T352(false);var Ap=parseInt((px)?event.clientX:e.clientX)-this.offsetX;var Av=parseInt((px)?event.clientY:e.clientY)-this.offsetY;this.l6=(px)?event.srcElement.id:e.target.id;if(!px&&this.panel.style.position!="absolute"){};this.downX=Ap-this.left;this.downY=Av-this.top;this.X8f6=new Date().getTime();this.ycE=this.jx7h8=0;this.Su15=false;if(this.l6!=null&&this.l6.indexOf("ctrl")>=0&&this.controlCanvas!=null){this.controlCanvas.onmousedown(e);return}if(e.type=="mousedown"&&this.sS==ts.ty&&(this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG")&&MEvent.contains(maplet,"mousedown")>0){MEvent.trigger(this,'mousedown',e)}this.tQ='';if(this.ff&&this.nI().qn(this.downX,this.downY)){this.AP.tE(this.downX,this.downY);return false}else{var _UV=px?event.srcElement:e.target;this.cL=(_UV.getAttribute(_Fj3O)||_UV.getAttribute("traffic"))?true:false;if(this.aY()&&this.cS){if(this.sS==ts.D57MH&&!this.snapshotBox.l3r){this.snapshotBox.show();this.snapshotBox.l3r=true}else{this.sD.resize(1,1);this.sD.show()}}else if(this.sS==ts.ty||this.sS==ts.tu||this.sS==ts.l3){if(px&&(this.l6.indexOf("MPolyline")==this.l6.length-9)){this.q453("move",event.srcElement)}else{eval(document.body.scrollTop);this.q453("move",this.map)}}}if(this.cO&&this.cL){if(px||HxT){this.map.setCapture&&this.map.setCapture()}else{e.yK9&&e.yK9();e.$10w&&e.$10w()}}};Maplet.prototype.a5=function(e){if(!this.map)return;var dODV0;if(this.map.getBoundingClientRect){var r=this.map.getBoundingClientRect();dODV0=[r.left,r.top]}else{dODV0=Hn0$e(this.map);dODV0[0]=dODV0[0]-J0j();dODV0[1]=dODV0[1]-yOu8()}this.offsetX=dODV0[0]-this.left;this.offsetY=dODV0[1]-this.top};Maplet.prototype.a4=function(e){MEvent.trigger(this,'mouseout',e);this.l6=(px)?event.srcElement.id:e.target.id;if(!px||(px&&event.clientX!=-1)){var Ap=parseInt((px)?event.clientX:e.clientX)-this.offsetX;var Av=parseInt((px)?event.clientY:e.clientY)-this.offsetY;if(this.cL){this._BWk(Ap-this.left-(px?1:0)-this.moveX,Av-this.top-(px?1:0)-this.moveY)}this.moveX=Ap-this.left-(px?1:0);this.moveY=Av-this.top-(px?1:0);this.tJW3=pD6(this.moveX-this.downX);this.R8G=pD6(this.moveY-this.downY)}if(this._96o3&&MEvent.contains(this,"layer_mouseout")>0){MEvent.trigger(this,"layer_mouseout",{layer:this.qpgD,pid:this._96o3.p,area:this._96o3.l,data:this._96o3.d,name:this._96o3.n,rect:this._96o3.rect});this._96o3=null;this.qpgD=null}this.cI=false;if(px)document.onmousewheel=new Function("return true");clearInterval(this.rn1);this.rn1=undefined};Maplet.prototype.a3=function(e){if(this.cL&&this.xc)this.xc.hide();this.cI=true;if(!this.cL)this.a5(e);this.l6=(px)?event.srcElement.id:e.target.id;var Ap=parseInt((px)?event.clientX:e.clientX)-this.offsetX;var Av=parseInt((px)?event.clientY:e.clientY)-this.offsetY;if(this.cL){this._BWk((Ap)-this.left-this.moveX,(Av)-this.top-this.moveY)}this.moveX=(Ap)-this.left;this.moveY=(Av)-this.top;if(this.controlCanvas!=null){if(this.controlCanvas.onmousemove(e)){return}}if(this.gc!=null){for(var n8 in this.gc){if(this.gc[n8].toString().indexOf("MStandardControl")>0&&this.gc[n8].nR&&this.gc[n8].nR.onmousemove(e)){return}}}if(this.sS==ts.tb||this.sS==ts.ta||this.sS==ts.lz||this.sS==ts.ly){var x0="";if(this.sS==ts.tb){if(!this.zy){x0=(en)?"Double click to finish":this.H9W5.AUO20}showMouseTipBox(this.moveX+6,this.moveY-3,x0,this.map)}else{x0=(en)?"Double click to finish":tX("%u8BFC%uDFC3%uA5C7%uD0CE%uE632");showMouseTipBox(this.moveX,this.moveY,x0,this.map)}}else if(this.sS==ts.tw){if(this.gJ!=null&&this.gJ!="undefined"&&this.gJ!="null"&&this.gJ!=""){showMouseTipBox(this.moveX-this.gI.width/2-10-1,this.moveY-this.gI.height-2-18,"<img src='"+this.gI.src+"'>",this.map)}else{nX()}}else{nX()}if(this.ff&&this.nI().tF(this.l6,this.moveX,this.moveY))return;if(this.sS==ts.ty&&!this.cN){var cF=false;if(this.aG!=null&&this.aH!=null){for(var qk=0;qk<this.aG.length;qk++){if(Math.abs(this.aG[qk]-this.moveX)<HOTSPOT_SIZE&&Math.abs(this.aH[qk]-this.moveY)<HOTSPOT_SIZE){cF=true;break}}}if(cF){this.q453("pointer",this.map)}else if(!this.cL){this.q453("default",this.map)}if(this.Mv24&&(this.l6=="LayerMask"||this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG"||(e.target.parentNode&&e.target.parentNode.id=="LayerMap")||e.target.id.indexOf("OverlayBg")>=0||e.target.getAttribute(_X6IT))){var img=null;if(img=this.getImgByXY(this.moveX,this.moveY,true)){this.loadLayerDataOfPassiveMode(img);var b=false;for(var i=this.Xo911.length-1;i>=0;i--){if(typeof this.Xo911[i]!="undefined"){for(var HB3=this.Xo911[i].length-1;HB3>=0;HB3--){var $1nIY=this.Xo911[i][HB3];if(!$1nIY.inZoomRange(this.AG))continue;var d=$1nIY.i70Y(img,this.moveX,this.moveY);if(d){if(this._96o3&&this._96o3!=d&&MEvent.contains(this,"layer_mouseout")>0){MEvent.trigger(this,"layer_mouseout",{layer:$1nIY,pid:this._96o3.p,area:this._96o3.l,data:this._96o3.d,name:this._96o3.n,rect:this._96o3.rect})}if(this._96o3!=d&&MEvent.contains(this,"layer_mouseover")>0){this._96o3=d;this.qpgD=$1nIY;MEvent.trigger(this,"layer_mouseover",{layer:$1nIY,pid:d.p,area:d.l,data:d.d,name:d.n,rect:d.rect})}if(MEvent.contains(this,"layer_mousemove")>0)MEvent.trigger(this,"layer_mousemove",{layer:$1nIY,pid:d.p,area:d.l,data:d.d,name:d.n,rect:d.rect});b=true;break}else if(this._96o3&&this.qpgD==$1nIY&&MEvent.contains(this,"layer_mouseout")>0){MEvent.trigger(this,"layer_mouseout",{layer:$1nIY,pid:this._96o3.p,area:this._96o3.l,data:this._96o3.d,name:this._96o3.n,rect:this._96o3.rect});this._96o3=null;this.qpgD=null}}}if(b)break}}}if(MEvent.contains(maplet,"mousemove")>0){var pt=new MPoint(this.toMapCoordinate(this.moveX,this.moveY));MEvent.trigger(this,"mousemove",e,pt)}}if(this.cO&&this.cL){if(this.l4p)return;if(!this.w205){this.no();this.w205=true}if(px){if(!document.getElementById("_map_marker_speeder")){var Ta2v0=document.createElement("DIV");Ta2v0.id="_map_marker_speeder";Ta2v0.style.display="none";document.body.appendChild(Ta2v0)}document.getElementById("_map_marker_speeder").innerHTML=""}if(iToolTipStyle==0)hideToolTipMenu();if(iToolTipStyle==0){hideToolTipMenu()}this.tJW3=pD6(this.moveX-this.downX);this.R8G=pD6(this.moveY-this.downY);if(!px&&ContentInfo&&ContentInfo.isVisible()){ContentInfo.I72(true)}this.sF.moveTo(this.tJW3,this.R8G);this.cN=true;this.cn=true;e.yK9&&e.yK9();e.$10w&&e.$10w()}else if(this.cS&&this.cL){if(this.aY()){this.cR=true;this.lu()}}else if(this.sS==ts.tb||this.sS==ts.ta||this.sS==ts.lz||this.sS==ts.ly||this.sS==ts.sy9){var tP=this.zp(this.moveX,this.moveY);var tO=this.zo(this.moveX,this.moveY);if(this.sS==ts.sy9){if(this.IcK4.$923.length){with(this.IcK4){if(wmjh.i7S!=tP||wmjh.XCk1!=tO){wmjh.i7S=tP;wmjh.XCk1=tO;if(!this.IcK4.YIX){wmjh.g09y4=tP;wmjh.y3X=tO;this.D9J$4(new MPoint(tP,tO,false))}}}}if(!this.IcK4.$923.length)this.d0I()}else if(this.zy!=null){if(this.sS==ts.tb){var scrollX=0,scrollY=0,$Q8=this.moveX,myp2=this.moveY,$2S=this.r9fhe*2,EA4=this;if($Q8<$2S)scrollX=50;if($Q8>(this.width-$2S))scrollX=-50;if(myp2<$2S)scrollY=50;if(myp2>(this.height-$2S))scrollY=-50;if(scrollX!=0||scrollY!=0){if(!this.rn1){this.rn1=setInterval(function(){EA4.panTo(scrollX,scrollY)},100)}}else{if(this.rn1){clearInterval(this.rn1);this.rn1=undefined;this.tG.pts[1]=new MPoint(cq.zn(tP,tO));this.tG.update()}}var x0="";var $w7F=this.a5xg[this.a5xg.length-1];var hEEr=$w7F.$923[$w7F.$923.length-1];var _9722=hEEr.r18;var r18=hEEr.r18+this.measDistance([hEEr.point,new MPoint(tP,tO,false)]);var tip=this.H9W5.w0l62.replace(this.H9W5.j6y,(r18<1000)?r18+"\u7c73":parseInt(r18/100)/10+"\u516c\u91cc");x0=(en)?"Double click to finish":tip;nX();showMouseTipBox(this.moveX+6,this.moveY-3,x0,this.map)}if(!this.rn1){this.tG.pts[1]=new MPoint(cq.zn(tP,tO));if(this.zy.brush.fill){this.tG.pts[2]=this.zy.pts[0]}this.tG.update()}}}else{if(this.l6=="LayerDrawMap"&&iToolTipStyle==0){hideToolTipMenu()}}};Maplet.prototype.a6=function(e,l6,Ap,Av){if(!this.cL)return;var wL=0;var wM=0;var li=0;var lf=0;this.l6=(px)?event.srcElement.id:e.target.id;this.zQ=this.moveX;this.zR=this.moveY;this.RSL=new Date().getTime();this.cL=false;if(this.l6.indexOf("MPolyline")!=-1){this.cn=false}if(e.type=="mouseup"){if(this.ycE<-this.ignoreMoveRange||this.ycE>this.ignoreMoveRange||this.jx7h8<-this.ignoreMoveRange||this.jx7h8>this.ignoreMoveRange)this.Su15=true}else{this.Su15=true}if(this.l6!=null){if(this.l6.indexOf("ctrl")>=0)this.sD.hide();else if(e.type=="mouseup"&&this.sS==ts.ty&&(this.l6=="LayerDrawMap"||this.l6=="LayerDrawSVG")&&MEvent.contains(maplet,"mouseup")>0){MEvent.trigger(this,'mouseup',e)}}if(this.sS==ts.ty||this.sS==ts.tu||this.sS==ts.l3){this.q453("default",this.map)}if(this.ff&&this.nI().tJ(this.zQ,this.zR)){this.setZoomLevel(parseInt(this.AP.getZoomLevel()));return}if((this.cN||this.cR)&&(this.cS||this.cO)){this.cN=false;this.cR=false;if(this.cO){if(true||this.AG>0){wL=-(this.zQ-this.downX);wM=(this.zR-this.downY);li=this.zp(wL+this.width/2,-wM+this.height/2);lf=this.zo(wL+this.width/2,-wM+this.height/2);this.gA=li;this.gx=lf}var _UV=(px)?event.srcElement:e.target;if(_UV.getAttribute(_Fj3O)){if(_UV.getAttribute(N152)=="polyline")this.B076=true;if(_UV.getAttribute(N152)=="marker")this.dM6O=true}if(typeof basepoilist!="object"&&!this.R__7&&this.gn1)this.gn1=false;this._67R=true;this.O71Wl=new Date().getTime();maplet.setZoomLevel(maplet.AG);this._67R=false;if(apiType==1)MEvent.trigger(this,"pan",new MPoint(this.toMapCoordinate(this.width/2,this.height/2)));else MEvent.trigger(this,"pan","&act=pan&ctr="+this.toMapCoordinate(this.width/2,this.height/2));if(this.allowDrawingDragMap&&this.Su15&&((this.sS==ts.tb||this.sS==ts.ta||this.sS==ts.lz||this.sS==ts.ly||this.sS==ts.sy9)))this.Jj1j=false}else{var gX=1;var gW=Math.max(1,Math.abs(this.zQ-this.downX));if(this.sS==1){{wL=(this.zQ+this.downX)/2;wM=(this.zR+this.downY)/2;li=this.zp(wL,wM);lf=this.zo(wL,wM);this.gA=li;this.gx=lf}if(gW<this.imgWidth){gX=Math.min(MAX_ZOOM_LEVEL-this.AG,Math.max(1,parseInt(Math.log(this.imgWidth/gW)/Math.log(2))))}this.setZoomLevel(this.AG+gX);if(apiType==1)MEvent.trigger(this,"zoomin",this.AG);else MEvent.trigger(this,"zoomin","&act=zoomin&zm="+this.AG)}else if(this.sS==2){wL=(this.zQ+this.downX)/2;wM=(this.zR+this.downY)/2;li=this.zp(wL,wM);lf=this.zo(wL,wM);this.gA=li;this.gx=lf;if(gW<this.imgWidth){gX=Math.min(this.AG,Math.max(1,parseInt(Math.log(this.imgWidth/gW)/Math.log(2))))}this.setZoomLevel(this.AG-gX);if(apiType==1)MEvent.trigger(this,"zoomout",this.AG);else MEvent.trigger(this,"zoomout","&act=zoomout&zm="+this.AG)}else if(this.sS==ts.tv){var s6=this.gA+(Math.max(this.zQ,this.downX)-this.width/2)*this.xg/this.imgWidth;var s4=this.gx-(Math.min(this.zR,this.downY)-this.height/2)*this.xf/this.imgHeight;cq.li=s6;cq.lf=s4;var s5=cq.zn();var tl=this.gA+(Math.min(this.zQ,this.downX)-this.width/2)*this.xg/this.imgWidth;var tj=this.gx-(Math.max(this.zR,this.downY)-this.height/2)*this.xf/this.imgHeight;cq.li=tl;cq.lf=tj;var tk=cq.zn();cq.li=tl;cq.lf=s4;var tm=cq.zn();cq.li=s6;cq.lf=tj;var s7=cq.zn();var yg="&act=lookup&max="+s5+"&min="+tk+"&mmx="+tm+"&mxm="+s7;if(this.vA!="undefined")this.setMode(this.vA);this.cQ=true;if(apiType==1){MEvent.trigger(this,"lookup",{action:"lookup",max:new MPoint(s5),min:new MPoint(tk),mmx:new MPoint(tm),mxm:new MPoint(s7)})}else{MEvent.trigger(this,"lookup",yg)}}else if(this.sS==ts.D57MH){this.snapshotBox.p026W();this.snapshotBox.l3r=false}this.sD.hide();this.sD.resize(1,1);this.sD.moveTo(-10,-10)}}if(this.cO){if(px||HxT){this.map.releaseCapture&&this.map.releaseCapture()}else{e.yK9&&e.yK9();e.$10w&&e.$10w()}}};Maplet.prototype.a7=function(e){if(!MOUSEWHEEL)return;function _85d2(){if(this.AP2==null){this.AP2=this.AG;_85d2.apply(this)}else if(this.AP2!=this.Ai){var xd=Math.abs(this.Ai-this.AG)/10;var pagT=0.25;xd=xd<pagT?pagT:xd;if(this.tK<0){this.AP2-=xd;if(this.AP2<=this.Ai+0.05){this.AP2=this.Ai}}else{this.AP2+=xd;if(this.AP2>=this.Ai-0.1){this.AP2=this.Ai}}if(this.AP2!=this.Ai){var AK=Math.pow(2,this.AP2)/Math.pow(2,this.AG);var W9Xy=(this.width/2-this.iEN7B)*(AK-1);var w89u=(this.height/2-this.W97)*(AK-1);this.AN(this.AP2,W9Xy,w89u)}if(this.AP2==this.Ai)_85d2.apply(this);else getTimeout(this,_85d2,0)}else{this.AP2=null;this.tK=0;this.setZoomLevel(this.Ai);this.Ai=0}};var l8=e||window.event;if(typeof l8=="object"&&l8){if(typeof l8.wheelDelta=="undefined")l8.wheelDelta=-l8.detail;if(typeof l8.srcElement=="undefined")l8.srcElement=l8.target;if(l8.wheelDelta==0||(this.AG==MIN_ZOOM_LEVEL&&l8.wheelDelta<0)||(this.AG==MAX_ZOOM_LEVEL&&l8.wheelDelta>0))return;if(this.fa)return;if(typeof this.tK=="undefined")this.tK=0;if(typeof this.Ai=="undefined")this.Ai=0;var r=Kjdp(l8.srcElement,_56);if(!r||r=="false"){QD199(l8);var i=l8.wheelDelta<0?-1:1;this.tK+=i<0?Math.floor(i):Math.ceil(i);if(this.tK==0)return;var Yg5w=true;if(ContentInfo&&ContentInfo.isVisible()){var MfS=this.toScreenCoordinate(avBubble.c9p8);if(_isInsideRect({x:MfS[0],y:MfS[1]},{min:{x:0,y:0},max:{x:this.width,y:this.height}})){Yg5w=false}}if(Yg5w){this.fl5T="wheel";if(typeof this.l6=="undefined")this.a3(l8);this.iEN7B=this.moveX;this.W97=this.moveY;this.sT2_4=this.toMapCoordinate(this.iEN7B,this.W97);this.w38T0(l8.wheelDelta)}this.Ai=parseInt(this.AG+this.tK);if(this.Ai<MIN_ZOOM_LEVEL)this.Ai=MIN_ZOOM_LEVEL;if(this.Ai>MAX_ZOOM_LEVEL)this.Ai=MAX_ZOOM_LEVEL;if(ZOOM_TRANSITION&&this.AP2==null){if(ContentInfo&&ContentInfo.isVisible()){this.AP2=this.Ai}_85d2.apply(this)}}}};Maplet.prototype.rn1=undefined;var px=false;var i639=false;var l4_lc=false;var ui_=false;var HxT=false;var Hg6=false;var RoY5=false;var bN9I=false;var s;var POy=navigator.userAgent.toLowerCase();if(s=POy.match(new RegExp("msie ([\\d.]+)"))){px=true;if(U5402(s[1],0)==6)i639=true;else if(U5402(s[1],0)==7)l4_lc=true;else if(U5402(s[1],0)==8)ui_=true}else if(s=POy.match(new RegExp("firefox\/([\\d.]+)"))){HxT=true}else if(s=POy.match(new RegExp("chrome\/([\\d.]+)"))){Hg6=true}else if(s=POy.match(new RegExp("opera.([\\d.]+)"))){bN9I=true}else if(s=POy.match(new RegExp("version\/([\\d.]+).*safari"))){RoY5=true}var Uby5j=true;if(px)Uby5j=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0")||document.implementation.hasFeature("org.w3c.svg","1.0");var x00Vr=document.compatMode=="CSS1Compat";var ut=document.qS?1:0;var lm=(px)?"document.all.":"document.";var yj=(px)?".style":"";if(px&&!Uby5j){document.namespaces.add('v','urn:schemas-microsoft-com:vml');document.write("<style>v\\:shape,v\\:stroke,v\\:fill,v\\:roundrect,v\\:oval,v\\:image {behavior:url(#default#VML)}</style>")}document.write("<style type='text/css'> ");document.write(".ptlabel {  ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 8pt; ");document.write("}  ");document.write("");document.write(".tooltiptitle {");document.write("  color: #CC5522; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-weight: bold; ");document.write("  font-size: 10pt;");document.write("}  ");document.write("");document.write(".tooltipcontent { ");document.write("  color: #000000; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 8pt; ");document.write("}  ");document.write("");document.write(".hotspotlabel {");document.write("  position: absolute;");document.write("  color: #000; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 10pt;");document.write("}  ");document.write("");document.write(".editableimg { ");document.write("  position: absolute;");document.write("  overflow: hidden;  ");document.write("  cursor: pointer;");document.write("  border: 1px solid #fff;  ");document.write("  z-index: 1000;  ");if(px){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 0px; ");document.write("  display: block; ");document.write("}  ");document.write("");document.write(".buffering {");document.write("  position: absolute;");document.write("  height: 16px;");document.write("  z-index: 24; ");if(px){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 12px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 0px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 0px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write(".tiplabel { ");document.write("  position: absolute;");document.write("  height: 12px;");document.write("  z-index: 0; white-space: nowrap; ");document.write("  display: block; ");document.write("  background-color: #FFFFCC;  ");document.write("  border: 1px solid #f00;  ");document.write("  color: #f00; ");document.write("  font-size: 12px;");document.write("  font-weight: bold; ");document.write("}  ");document.write("");document.write("#ToolTip {  ");document.write("  position: absolute;");if(px){document.write("  filter: alpha( opacity = 80 );")}else{document.write("  opacity: 0.8;  ")}document.write("  width: 100px;");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  z-index: 24; ");document.write("  visibility: hidden;");document.write("}  ");document.write("");document.write("#loading {  ");document.write("  position: absolute;");document.write("  z-index: 24; ");if(px){document.write("  filter: alpha( opacity = 60 );")}else{document.write("  opacity: 0.6;  ")}document.write("  font-size: 13px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 0px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 4px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write("#mbglabel { ");document.write("  position: absolute;");document.write("  z-index: 0;  ");document.write("  white-space: nowrap;  ");document.write("  display: block; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mfglabel { ");document.write("  position: absolute;");document.write("  z-index: 0;  ");document.write("  white-space: nowrap;  ");document.write("  display: block; ");document.write("  visibility: visible;  ");document.write("  background-color: #FFFFCC;  ");document.write("}  ");document.write("");document.write("#stylelabel {  ");document.write("  position: absolute;");document.write("  z-index: 24; ");if(px){document.write("  filter: alpha( opacity = 80 );")}else{document.write("  opacity: 0.8;  ")}document.write("  font-size: 13px;");document.write("  font-weight: bold; ");document.write("  background-color: #fff;  ");document.write("  color: #000; ");document.write("  border: 1px solid #000;  ");document.write("  text-align: center;");document.write("  padding-top: 4px;  ");document.write("  display: block; ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewport {");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 10; ");document.write("  font-size: 0px; ");if(i639||l4_lc||ui_){document.write("  filter: alpha( opacity = 50 );")}else{document.write("  opacity: 0.5;  ")}document.write("  background-color: white;  ");document.write("  border: 2px solid white;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewframe {  ");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 11; ");document.write("  font-size: 0px; ");document.write("  border: 2px solid #D50F1E;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-overview-viewpad_ctrl { ");document.write("  position: absolute;");document.write("  width: 0px;  ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  height: 0px; ");document.write("  z-index: 12; ");document.write("  font-size: 0px; ");document.write("  border: 2px solid #D50F1E;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-bordertop {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-top: 1px solid #949694; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderbtm {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-bottom: 1px solid #949694; ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderlft {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-left: 1px solid #949694;");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write("#mapbar-borderrgt {  ");document.write("  position: absolute;");document.write("  z-index: 2;  ");document.write("  font-size: 0px; ");document.write("  border-right: 1px solid #949694;  ");document.write("  visibility: visible;  ");document.write("}  ");document.write("");document.write(".contextmenuitem {");document.write("  color: #0E347F; ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("  font-family: Arial, Helvetica, sans-serif; ");document.write("  font-size: 9pt; ");document.write("  padding-right: 6px; ");document.write("  width: 100%; ");document.write("}  ");document.write("");document.write(".contextmenutable {  ");document.write("  text-decoration: none;");document.write("  cursor: pointer;");document.write("}  ");document.write("");document.write(".mapcontextmenu { ");document.write("  position: absolute;");document.write("  background-color: #FFFFFF; ");document.write("  padding: 1px; ");document.write("  border: 1px outset #cccccc; ");document.write("  top: 0px; ");document.write("  left: 0px;");document.write("  z-index: 24; ");document.write("  visibility: hidden;");document.write("}  ");document.write("");document.write(".mapCirEdging .borT, ");document.write("  .mapCirEdging .borB { ");document.write("  height: 1px; ");document.write("  margin: 0 1px;  ");document.write("  border-bottom: 1px solid #8F8F8F; ");document.write("  line-height: 1px;  ");document.write("  font-size: 1px; ");document.write("}  ");document.write("");document.write(".mapCirEdging .borB {");document.write("  border: 0;");document.write("  border-top: 1px solid #8F8F8F; ");document.write("}  ");document.write("");document.write(".mapCirEdging .borT2, .mapCirEdging .borB2 { ");document.write("  height: 1px; ");document.write("  border: 1px solid #BCBCBC;  ");document.write("  border-top: 0;  ");document.write("  border-bottom: 0;  ");document.write("  line-height: 1px;  ");document.write("  font-size: 1px; ");document.write("}  ");document.write("");document.write(".mapCirEdging .MPBox2 { ");document.write("  height: auto;");document.write("  border: 1px solid #8F8F8F;  ");document.write("  border-top: 0;  ");document.write("  border-bottom: 0;  ");document.write("  background: #fff;  ");document.write("}  ");document.write("");document.write(".mapCirEdging .MPbox {  ");document.write("  margin: 3px; ");document.write("  font-size: 12px;");document.write("  text-align: left;  ");document.write("}  ");document.write(".snapshotTextBtn {  ");document.write("  padding-top: 3px; ");document.write("  padding-bottom: 3px; ");document.write("  padding-left: 4px; ");document.write("  padding-right: 4px; ");document.write("  margin-left: 2px; ");document.write("  font-family: \u5b8b\u4f53; ");document.write("  font-size: 13px;");document.write("  text-align: center;  ");document.write("  font-weight: normal;  ");document.write("  letter-spacing: 1px;  ");document.write("  background: #0E347F;  ");document.write("  color: white;  ");document.write("}  ");document.write(".roadlineTip {  ");document.write("  padding: 2px; ");document.write("  font-family: \u5b8b\u4f53; ");document.write("  font-size: 13px;");document.write("  color: #666666;");document.write("  border: 1px solid #666666;  ");document.write("  background: none repeat scroll 0 0 #FFFFFF;  ");document.write("  white-space: nowrap;  ");document.write("}  ");document.write(".roadlineTip_distance {  ");document.write("  color: black;");document.write("  white-space: nowrap;  ");document.write("}  ");document.write(".pointBox{position:absolute;z-index:100}");document.write(".pointBox .PMain{padding:0 10px;border: 2px solid rgb(14, 52, 127); background:#fff }");document.write(".pointBox .pointer{overflow:hidden;width:15px;height:14px;margin:-4px 0 0;background:url(images/pointBg.png) no-repeat;_background:none}");document.write(".pointBox .pointer img{display:none;_display:block;width:15px;height:14px;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=images/pointBg.png,sizingMethod=image,sizingMethod=scale)}");document.write(".pointBox .BoxBg{position:absolute;z-index:-1;width:100%;margin:auto 0 0 8px;padding-top:5px;background:#666;filter:alpha(opacity=60);opacity:0.6}");document.write(".rightThis .pointer{width:auto;margin:-4px 0 0;background-position:100% -16px!important;_background:none}");document.write(".rightThis .pointer img{_position:absolute;_right:0;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=images/pointBgR.png,sizingMethod=image,sizingMethod=scale)}");document.write(".rightThis .BoxBg{margin:auto 15px 0 0;left:-5px}");document.write("</style>");if(typeof xl=="undefined")var xl=strImgsvrUrl;if(typeof ds=="undefined")var ds="mapbar";if(typeof en=="undefined")var en=0;if(typeof rs=="undefined")var rs=0;if(typeof apiType=="undefined")var apiType=0;if(typeof hs=="undefined")var hs=false;if(typeof MOUSEWHEEL=="undefined")var MOUSEWHEEL=true;if(typeof kp=="undefined")var kp=true;if(typeof bDefaultControlOn=="undefined")var bDefaultControlOn=false;if(typeof hbo=="undefined")var hbo=false;if(typeof otp=="undefined")var otp=false;if(typeof ZOOM_TRANSITION=="undefined")var ZOOM_TRANSITION=true;if(typeof bsc=="undefined")var bsc=true;if(typeof __mapbar_magic_id=="undefined")var __mapbar_magic_id="";if(typeof REFRESH_MK_INDEX!="boolean")var REFRESH_MK_INDEX=true;if(typeof SNAPSHOT_SERVER!="string")var SNAPSHOT_SERVER="http://staticmap.mapbar.com/staticmap/";if(typeof SNAPSHOT_MAPIMG_URI_PREFIX!="string")var SNAPSHOT_MAPIMG_URI_PREFIX="http://img[1-9]?.mapbar.com/maplite/";if(typeof SNAPSHOT_MARKER_URI_PREFIX!="string")var SNAPSHOT_MARKER_URI_PREFIX="http://img[1-9]?.mapbar.com/maplite/mapbank/ditu/";var SNAPSHOT_OPTIONS={mode:"fullscreen",format:"png",depth:0,processMode:"event"};if(typeof ALLOW_MV!="boolean")var ALLOW_MV=true;if(typeof _Fj3O!="string")var _Fj3O="_dragmap";if(typeof N152!="string")var N152="_overlay";if(typeof _56!="string")var _56="_disable_mw";if(typeof _X6IT!="string")var _X6IT="_mlayer";var c75=2;var ac=null;var ad=true;if(typeof bp=="undefined")var bp=true;if(typeof oo=="undefined")var oo=true;if(typeof bmc=="undefined")var bmc=false;if(typeof OVER_LOCATION!="object"||OVER_LOCATION)var OVER_LOCATION=null;if(typeof STD_BUBBLE_WIDTH=="undefined")var STD_BUBBLE_WIDTH=217;if(typeof MIN_BUBBLE_HEIGHT=="undefined")var MIN_BUBBLE_HEIGHT=120;if(typeof OVER_WIN_WIDTH!="number"){OVER_WIN_WIDTH=150}else{if(OVER_WIN_WIDTH<100)OVER_WIN_WIDTH=100;else if(OVER_WIN_WIDTH>210)OVER_WIN_WIDTH=210}if(typeof OVER_WIN_HEIGHT!="number"){OVER_WIN_HEIGHT=120}else{if(OVER_WIN_HEIGHT<100)OVER_WIN_HEIGHT=100;else if(OVER_WIN_HEIGHT>210)OVER_WIN_HEIGHT=210}if(typeof MAX_BUBBLE_HEIGHT=="undefined")var MAX_BUBBLE_HEIGHT=380;var sX=strImgsvrUrl+"images/mask.gif";var ul=strImgsvrUrl+"images/node.gif";var lV=strImgsvrUrl+"images/wmk.gif";if(typeof LPN_HOVERING_TIME=="undefined")var LPN_HOVERING_TIME=100;if(typeof HOTSPOT_SIZE=="undefined")var HOTSPOT_SIZE=8;if(typeof DISABLE_DBCLICK_ZOOM=="undefined")var DISABLE_DBCLICK_ZOOM=false;var bx06f=null;if(typeof gQ=="undefined")gQ=0;var xz='';var AB="";document.write('<img id="sendmapload" style="display:none;visibility:hidden;" />');document.writeln('<div id="myalert" style="position:absolute;z-index:100000;filter:alpha(opacity=85);opacity:0.85;display:none;background-color:white;padding:1px;"></div>');if(typeof bArrow=="undefined"){var bArrow=0}var sB=new Image();var initialize=0;var xN=(en==0)?new Array(tX('%u5415%uDD90%uE7F2%uD86E'),tX('%u5415%uA728%uB18A%uD86E'),tX('%u5415%uA22D%uAC8F%uD86E'),tX('%u5415%uA768%uB1CA%uD86E'),tX('%u6D4F%uFF1A%u1FAC%u0798'),tX('%u70BF%uC2B4%uE1D6%u1827%u0775%uE467'),tX('%u6540%uBE65'),tX('%u7F2B%uDB38'),tX('%u62D1%uB571%uC179%uC628%uE732%u1827%u0775%uE467')):new Array('Go left','Go up','Go right','Go down','Measure distance','Click to zoom','Zoom In','Zoom Out','Drag to zoom');var lt=(en==0)?"\u62D6\u62FD\u6B64\u70B9":"drag to move this point";var pe=new Array();var pa=new Array();var pF=2;var sI=new Array('W','0','1','2','3','4','5','6','7','8','9','10','11','12','13','14');var sj=new Array(90,40,20,10,5,2,1,0.5,0.2,0.1,0.05,0.02,0.01,0.005,0.002,0.001);var qP=new Array(90*0.8,40*0.8,20*0.8,10*0.8,5*0.8,2*0.8,0.8,0.5*0.8,0.2*0.8,0.1*0.8,0.05*0.8,0.02*0.8,0.01*0.8,0.005*0.8,0.002*0.8,0.001*0.8);var nM=new Array(10,10,10,10,10,10,10,10,10,10,50,50,50,50,50,50);var w8=new Array(0,0,0,0,0,0,0,0,75,0,0,-150,0,0,0,0);if(typeof DEFAULT_MAX_ZOOM_LEVEL!="number")var DEFAULT_MAX_ZOOM_LEVEL=14;if(typeof DEFAULT_MIN_ZOOM_LEVEL!="number")var DEFAULT_MIN_ZOOM_LEVEL=0;var MAX_ZOOM_LEVEL=DEFAULT_MAX_ZOOM_LEVEL;var MIN_ZOOM_LEVEL=DEFAULT_MIN_ZOOM_LEVEL;var wp=100000;var sw=105;var sx=35;var sz=new Array(-360,360);var sy=new Array(-90,90);var A083=null;var uU=8;var uS=15;var uT=strImgsvrUrl+'images/overclose.gif';var uV=strImgsvrUrl+'images/overopen.gif';if(!otp){uT=strImgsvrUrl+'images/overclose2.gif';uV=strImgsvrUrl+'images/overopen2.gif'}var uW=[0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11];var bpp=[xl+"mapbank/base/",13,14];var vs=strMapsvrUrl+"images/done.gif";var vt=strMapsvrUrl+"images/edit.gif";var v3=strMapsvrUrl+"images/stretch.gif";var at=0;var as=1;var au=2;var av=0;var ar=2;var s9=1001;if(typeof TRAFFIC_REFRESH_INTERVAL!="number")var TRAFFIC_REFRESH_INTERVAL=5*60;if(typeof TRAFFIC_MIN_LEVEL!="number")var TRAFFIC_MIN_LEVEL=8;if(typeof TRAFFIC_MAX_LEVEL!="number")var TRAFFIC_MAX_LEVEL=MAX_ZOOM_LEVEL;if(typeof a1h7!="number")var a1h7=9;if(typeof J02o!="number")var J02o=MAX_ZOOM_LEVEL;if(typeof in9o0!="boolean")var in9o0=false;if(typeof GOLDPOI_TXTRQT_RANDOM!="boolean")var GOLDPOI_TXTRQT_RANDOM=true;
